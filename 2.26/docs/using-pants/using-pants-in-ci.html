<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-2.26 docs-doc-page docs-doc-id-docs/using-pants/using-pants-in-ci" data-has-hydrated=false><head><meta charset=UTF-8><meta name=generator content="Docusaurus v3.9.2"><title data-rh=true>Using Pants in CI | Pantsbuild</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"/><meta data-rh=true name=twitter:card content=summary_large_image /><meta data-rh=true property=og:image content=https://www.pantsbuild.org/img/social-card.png /><meta data-rh=true name=twitter:image content=https://www.pantsbuild.org/img/social-card.png /><meta data-rh=true property=og:url content=https://www.pantsbuild.org/2.26/docs/using-pants/using-pants-in-ci /><meta data-rh=true property=og:locale content=en /><meta data-rh=true name=docusaurus_locale content=en /><meta data-rh=true name=docsearch:language content=en /><meta data-rh=true name=docusaurus_version content=2.26 /><meta data-rh=true name=docusaurus_tag content=docs-default-2.26 /><meta data-rh=true name=docsearch:version content=2.26 /><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-2.26 /><meta data-rh=true name=robots content="noindex, nofollow"/><meta data-rh=true property=og:title content="Using Pants in CI | Pantsbuild"/><meta data-rh=true name=description content="Suggestions for how to use Pants to speed up your CI (continuous integration)."/><meta data-rh=true property=og:description content="Suggestions for how to use Pants to speed up your CI (continuous integration)."/><link data-rh=true rel=icon href=/img/favicon.ico /><link data-rh=true rel=canonical href=https://www.pantsbuild.org/2.26/docs/using-pants/using-pants-in-ci /><link data-rh=true rel=alternate href=https://www.pantsbuild.org/2.26/docs/using-pants/using-pants-in-ci hreflang=en /><link data-rh=true rel=alternate href=https://www.pantsbuild.org/2.26/docs/using-pants/using-pants-in-ci hreflang=x-default /><link data-rh=true rel=preconnect href=https://QD9KY1TRVK-dsn.algolia.net crossorigin=anonymous /><script data-rh=true type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://www.pantsbuild.org/2.26/docs/using-pants/using-pants-in-ci","name":"Using Pants in CI","position":1}]}</script><link rel=alternate type=application/rss+xml href=/blog/rss.xml title="Pantsbuild RSS Feed"><link rel=alternate type=application/atom+xml href=/blog/atom.xml title="Pantsbuild Atom Feed"><link rel=preconnect href=https://www.google-analytics.com><link rel=preconnect href=https://www.googletagmanager.com><script async src="https://www.googletagmanager.com/gtag/js?id=G-SEHBXJRF42"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-SEHBXJRF42",{anonymize_ip:!0})</script><link rel=search type=application/opensearchdescription+xml title=Pantsbuild href=/opensearch.xml><link rel=stylesheet href=/assets/css/styles.b71b45ed.css /><script src=/assets/js/runtime~main.43acf77f.js defer></script><script src=/assets/js/main.636c7439.js defer></script></head><body class=navigation-with-keyboard><svg style="display: none;"><defs>
<symbol id=theme-svg-external-link viewBox="0 0 24 24"><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><div role=region aria-label="Skip to main content"><a class=skipToContent_lucK href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="theme-layout-navbar navbar navbar--fixed-top"><div class=navbar__inner><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/><div class=navbar__logo><img src=/img/logo.svg alt="My Site Logo" class="themedComponent_x_jL themedComponent--light_WGb9"/><img src=/img/logo.svg alt="My Site Logo" class="themedComponent_x_jL themedComponent--dark_oBxQ"/></div><b class="navbar__title text--truncate">Pantsbuild</b></a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/2.26/docs/introduction/welcome-to-pants>Docs</a><a class="navbar__item navbar__link" href=/2.26/reference/global-options>Reference</a><a class="navbar__item navbar__link" href=/blog>Blog</a><a class="navbar__item navbar__link" href=/sponsors>Sponsors</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class=navbar__link aria-haspopup=true aria-expanded=false role=button href=/2.26/docs/introduction/welcome-to-pants>2.26 (deprecated)</a><ul class=dropdown__menu><li><a class=dropdown__link href=/prerelease/docs/using-pants/using-pants-in-ci>2.31 (prerelease)</a><li><a class=dropdown__link href=/stable/docs/using-pants/using-pants-in-ci>2.30</a><li><a class=dropdown__link href=/2.29/docs/using-pants/using-pants-in-ci>2.29</a><li><a class=dropdown__link href=/2.28/docs/using-pants/using-pants-in-ci>2.28 (deprecated)</a><li class=""><hr class=dropdown-separator><li><a class=dropdown__link href=/versions>All Versions</a></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link>Slack</a><ul class=dropdown__menu><li><a href=https://pantsbuild.slack.com target=_blank rel="noopener noreferrer" class=dropdown__link>Workspace<svg width=12 height=12 aria-label="(opens in new tab)" class=iconExternalLink_QvT7><use href=#theme-svg-external-link /></svg></a><li><a href="https://docs.google.com/forms/d/e/1FAIpQLSf9zgf-MXRnVDJbrVEST3urqneq7LCcy0zw8qU-GH4hPMn52A/viewform?usp=sf_link" target=_blank rel="noopener noreferrer" class=dropdown__link>Workspace Invite<svg width=12 height=12 aria-label="(opens in new tab)" class=iconExternalLink_QvT7><use href=#theme-svg-external-link /></svg></a><li><a href=https://chat.pantsbuild.org target=_blank rel="noopener noreferrer" class=dropdown__link>Linen Mirror<svg width=12 height=12 aria-label="(opens in new tab)" class=iconExternalLink_QvT7><use href=#theme-svg-external-link /></svg></a></ul></div><a href=https://github.com/pantsbuild/pants target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_QvT7><use href=#theme-svg-external-link /></svg></a><div class=navbarSearchContainer_Mydu><button type=button class="DocSearch DocSearch-Button" aria-label="Search (Meta+k)" aria-keyshortcuts=Meta+k><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 24 24" aria-hidden=true><circle cx=11 cy=11 r=8 stroke=currentColor fill=none stroke-width=1.4 /><path d="m21 21-4.3-4.3" stroke=currentColor fill=none stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>Search</span></span><span class=DocSearch-Button-Keys></span></button></div><div class="toggle_AwgP colorModeToggle_rXRM"><button class="clean-btn toggleButton_kTC9 toggleButtonDisabled_N4X8" type=button disabled title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_X8HE lightToggleIcon_cay9"><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_X8HE darkToggleIcon_B6hH"><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_X8HE systemToggleIcon_k4zv"><path fill=currentColor d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"/></svg></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="theme-layout-main main-wrapper mainWrapper_GzA5"><div class=docsWrapper_LbKj><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_bDNn" type=button></button><div class=docRoot_PpgM><aside class="theme-doc-sidebar-container docSidebarContainer_aj0D"><div class=sidebarViewport_pg77><div class=sidebar_Us5f><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_FPuF"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_cnt8 menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/2.26/docs/introduction/welcome-to-pants><span title=Introduction class=categoryLinkLabel_JmoG>Introduction</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_cnt8 menu__link menu__link--sublist" href=/2.26/docs/getting-started><span title="Getting Started" class=categoryLinkLabel_JmoG>Getting Started</span></a><button aria-label="Expand sidebar category 'Getting Started'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_cnt8 menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role=button aria-expanded=true href=/2.26/docs/using-pants/command-line-help><span title="Using Pants" class=categoryLinkLabel_JmoG>Using Pants</span></a></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/2.26/docs/using-pants/command-line-help><span title="Command line help" class=linkLabel_BwCR>Command line help</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_cnt8 menu__link menu__link--sublist" tabindex=0 href=/2.26/docs/using-pants/key-concepts><span title="Key concepts" class=categoryLinkLabel_JmoG>Key concepts</span></a><button aria-label="Expand sidebar category 'Key concepts'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/2.26/docs/using-pants/troubleshooting-common-issues><span title="Troubleshooting / common issues" class=linkLabel_BwCR>Troubleshooting / common issues</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/2.26/docs/using-pants/advanced-target-selection><span title="Advanced target selection" class=linkLabel_BwCR>Advanced target selection</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/2.26/docs/using-pants/project-introspection><span title="Project introspection" class=linkLabel_BwCR>Project introspection</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/2.26/docs/using-pants/assets-and-archives><span title="Assets and archives" class=linkLabel_BwCR>Assets and archives</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/2.26/docs/using-pants/using-pants-in-ci><span title="Using Pants in CI" class=linkLabel_BwCR>Using Pants in CI</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/2.26/docs/using-pants/setting-up-an-ide><span title="Setting up an IDE" class=linkLabel_BwCR>Setting up an IDE</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/2.26/docs/using-pants/environments><span title="Environments: Cross-Platform or Remote Builds" class=linkLabel_BwCR>Environments: Cross-Platform or Remote Builds</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_cnt8 menu__link menu__link--sublist" tabindex=0 href=/2.26/docs/using-pants/remote-caching-and-execution><span title="Remote caching & execution" class=categoryLinkLabel_JmoG>Remote caching & execution</span></a><button aria-label="Expand sidebar category 'Remote caching & execution'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/2.26/docs/using-pants/generating-version-tags-from-git><span title="Generating version tags from Git" class=linkLabel_BwCR>Generating version tags from Git</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/2.26/docs/using-pants/anonymous-telemetry><span title="Anonymous telemetry" class=linkLabel_BwCR>Anonymous telemetry</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/2.26/docs/using-pants/restricted-internet-access><span title="Restricted Internet access" class=linkLabel_BwCR>Restricted Internet access</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/2.26/docs/using-pants/validating-dependencies><span title="Validating dependencies" class=linkLabel_BwCR>Validating dependencies</span></a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_cnt8 menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/2.26/docs/python/overview><span title=Python class=categoryLinkLabel_JmoG>Python</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_cnt8 menu__link menu__link--sublist" href=/2.26/docs/go><span title=Go class=categoryLinkLabel_JmoG>Go</span></a><button aria-label="Expand sidebar category 'Go'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_cnt8 menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/2.26/docs/jvm/java-and-scala><span title=JVM class=categoryLinkLabel_JmoG>JVM</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_cnt8 menu__link menu__link--sublist" href=/2.26/docs/shell><span title=Shell class=categoryLinkLabel_JmoG>Shell</span></a><button aria-label="Expand sidebar category 'Shell'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_cnt8 menu__link menu__link--sublist" href=/2.26/docs/docker><span title=Docker class=categoryLinkLabel_JmoG>Docker</span></a><button aria-label="Expand sidebar category 'Docker'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/2.26/docs/kubernetes><span title=Kubernetes class=linkLabel_BwCR>Kubernetes</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_cnt8 menu__link menu__link--sublist" href=/2.26/docs/helm><span title=Helm class=categoryLinkLabel_JmoG>Helm</span></a><button aria-label="Expand sidebar category 'Helm'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/2.26/docs/terraform><span title=Terraform class=linkLabel_BwCR>Terraform</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/2.26/docs/sql><span title=SQL class=linkLabel_BwCR>SQL</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_cnt8 menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/2.26/docs/ad-hoc-tools/integrating-new-tools-without-plugins><span title="Ad-Hoc Tools" class=categoryLinkLabel_JmoG>Ad-Hoc Tools</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_cnt8 menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/2.26/docs/javascript/overview><span title=Javascript class=categoryLinkLabel_JmoG>Javascript</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_cnt8 menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/2.26/docs/writing-plugins/overview><span title="Writing Plugins" class=categoryLinkLabel_JmoG>Writing Plugins</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_cnt8 menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/2.26/docs/releases/deprecation-policy><span title=Releases class=categoryLinkLabel_JmoG>Releases</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_cnt8 menu__link menu__link--sublist" href=/2.26/docs/contributions><span title=Contributions class=categoryLinkLabel_JmoG>Contributions</span></a><button aria-label="Expand sidebar category 'Contributions'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_cnt8 menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/2.26/docs/tutorials/testing-plugins><span title=Tutorials class=categoryLinkLabel_JmoG>Tutorials</span></a></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 margin-vert--none"><hr/><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/2.26/reference/global-options><span title=Reference class=linkLabel_BwCR>Reference</span></a></ul></nav></div></div></aside><main class=docMainContainer_oWFJ><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_b2qu"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role=alert><div>This is documentation for <!-- -->Pantsbuild<!-- --> <b>2.26 (deprecated)</b>, which is no longer actively maintained.</div><div class=margin-top--md>For up-to-date documentation, see the <b><a href=/stable/docs/using-pants/using-pants-in-ci>latest version</a></b> (<!-- -->2.30<!-- -->).</div></div><div class=docItemContainer_TkYX><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_nJ9e" aria-label=Breadcrumbs><ul class=breadcrumbs><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_WW1h><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li class=breadcrumbs__item><span class=breadcrumbs__link>Using Pants</span><li class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link>Using Pants in CI</span></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 2.26 (deprecated)</span><div class="tocCollapsible_hk9T theme-doc-toc-mobile tocMobile_cNpz"><button type=button class="clean-btn tocCollapsibleButton_ljii">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Using Pants in CI</h1></header><p>Suggestions for how to use Pants to speed up your CI (continuous integration).</p>
<hr/>
<div class="theme-admonition theme-admonition-note admonition_LZeC alert alert--secondary"><div class=admonitionHeading_SJYM><span class=admonitionIcon_iulS><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"/></svg></span>Examples</div><div class=admonitionContent_NJOy><p>See the example-python repository for an <a href=https://github.com/pantsbuild/example-python/blob/main/.github/workflows/pants.yaml target=_blank rel="noopener noreferrer" class="">example GitHub Actions worfklow</a>.</div></div>
<h2 class="anchor anchorTargetStickyNavbar_UrHV" id=directories-to-cache>Directories to cache<a href=#directories-to-cache class=hash-link aria-label="Direct link to Directories to cache" title="Direct link to Directories to cache" translate=no>​</a></h2>
<div class="theme-admonition theme-admonition-note admonition_LZeC alert alert--secondary"><div class=admonitionHeading_SJYM><span class=admonitionIcon_iulS><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"/></svg></span>The <code>init-pants</code> GitHub Action</div><div class=admonitionContent_NJOy><p>If you're using GitHub Actions to run your CI workflows, then you can use our <a href=https://github.com/pantsbuild/actions/tree/main/init-pants target=_blank rel="noopener noreferrer" class="">standard action</a> to set up and cache the Pants bootstrap state. Otherwise, read on to learn how to configure this manually.</div></div>
<p>In your CI's config file, we recommend caching these directories:</p>
<ul>
<li class=""><code>$HOME/.cache/nce</code> (Linux) or <code>$HOME/Library/Caches/nce</code> (macOS)<br/>
This is the cache directory used by the <a class="" href=/2.26/docs/getting-started/installing-pants>Pants launcher binary</a> to cache the assets, interpreters and venvs required to run Pants itself. Cache this against the Pants version, as specified in <code>pants.toml</code>. See the <a href=https://github.com/pantsbuild/example-python/blob/main/.github/workflows/pants.yaml target=_blank rel="noopener noreferrer" class="">pantsbuild/example-python</a> repo for an example of how to generate an effective cache key for this directory in GitHub Actions.</li>
<li class=""><code>$HOME/.cache/pants/named_caches</code><br/>
Caches used by some underlying tools. Cache this against the inputs to those tools. For the <code>pants.backend.python</code> backend, named caches are used by PEX, and therefore its inputs are your lockfiles. Again, see <a href=https://github.com/pantsbuild/example-python/blob/main/.github/workflows/pants.yaml target=_blank rel="noopener noreferrer" class="">pantsbuild/example-python</a> for an example.</li>
</ul>
<p>If you're not using a fine-grained <a class="" href=/2.26/docs/using-pants/remote-caching-and-execution>remote caching</a> service, then you may also want to preserve the local Pants cache at <code>$HOME/.cache/pants/lmdb_store</code>. This has to be invalidated on any file that can affect any process, e.g., <code>hashFiles('**/*')</code> on GitHub Actions.</p>
<p>Computing such a coarse hash, and saving and restoring large directories, can be unwieldy. So this may be impractical and slow on medium and large repos.</p>
<p>A <a class="" href=/2.26/docs/using-pants/remote-caching-and-execution>remote cache service</a> integrates with Pants's fine-grained invalidation and avoids these problems, and is recommended for the best CI performance.</p>
<p>See <a class="" href=/2.26/docs/using-pants/troubleshooting-common-issues#how-to-change-your-cache-directory>Troubleshooting</a> for how to change these cache locations.</p>
<div class="theme-admonition theme-admonition-note admonition_LZeC alert alert--secondary"><div class=admonitionHeading_SJYM><span class=admonitionIcon_iulS><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"/></svg></span>Nuking the cache when too big</div><div class=admonitionContent_NJOy><p>In CI, the cache must be uploaded and downloaded every run. This takes time, so there is a tradeoff where too large a cache will slow down your CI.<p>You can use this script to nuke the cache when it gets too big:<div class="language-bash codeBlockContainer_LrZr theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_QpNL><pre tabindex=0 class="prism-code language-bash codeBlock_z5Jo thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_YVRJ><span class=token-line style=color:#bfc7d5><span class="token plain"> </span><span class="token keyword" style=font-style:italic>function</span><span class="token plain"> </span><span class="token function-name function" style="color:rgb(130, 170, 255)">nuke_if_too_big</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">   </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">path</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$1</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">   </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">limit_mb</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$2</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">   </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">size_mb</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable function" style="color:rgb(130, 170, 255)">du</span><span class="token variable" style="color:rgb(191, 199, 213)"> </span><span class="token variable parameter variable" style="color:rgb(191, 199, 213)">-m</span><span class="token variable" style="color:rgb(191, 199, 213)"> </span><span class="token variable parameter variable" style="color:rgb(191, 199, 213)">-d0</span><span class="token variable" style="color:rgb(191, 199, 213)"> </span><span class="token variable string" style="color:rgb(195, 232, 141)">"</span><span class="token variable string variable" style="color:rgb(191, 199, 213)">${path}</span><span class="token variable string" style="color:rgb(195, 232, 141)">"</span><span class="token variable" style="color:rgb(191, 199, 213)"> </span><span class="token variable operator" style="color:rgb(137, 221, 255)">|</span><span class="token variable" style="color:rgb(191, 199, 213)"> </span><span class="token variable function" style="color:rgb(130, 170, 255)">cut</span><span class="token variable" style="color:rgb(191, 199, 213)"> </span><span class="token variable parameter variable" style="color:rgb(191, 199, 213)">-f</span><span class="token variable" style="color:rgb(191, 199, 213)"> </span><span class="token variable number" style="color:rgb(247, 140, 108)">1</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">   </span><span class="token keyword" style=font-style:italic>if</span><span class="token plain"> </span><span class="token variable punctuation" style="color:rgb(199, 146, 234)">((</span><span class="token variable" style="color:rgb(191, 199, 213)"> size_mb </span><span class="token variable operator" style="color:rgb(137, 221, 255)">></span><span class="token variable" style="color:rgb(191, 199, 213)"> limit_mb </span><span class="token variable punctuation" style="color:rgb(199, 146, 234)">))</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token keyword" style=font-style:italic>then</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">     </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"</span><span class="token string variable" style="color:rgb(191, 199, 213)">${path}</span><span class="token string" style="color:rgb(195, 232, 141)"> is too large (</span><span class="token string variable" style="color:rgb(191, 199, 213)">${size_mb}</span><span class="token string" style="color:rgb(195, 232, 141)">mb), nuking it."</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">     </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">nuke_prefix</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">"</span><span class="token string variable" style="color:rgb(191, 199, 213)">$(</span><span class="token string variable function" style="color:rgb(130, 170, 255)">dirname</span><span class="token string variable" style="color:rgb(191, 199, 213)"> </span><span class="token string variable string" style="color:rgb(195, 232, 141)">"</span><span class="token string variable string variable" style="color:rgb(191, 199, 213)">${path}</span><span class="token string variable string" style="color:rgb(195, 232, 141)">"</span><span class="token string variable" style="color:rgb(191, 199, 213)">)</span><span class="token string" style="color:rgb(195, 232, 141)">/</span><span class="token string variable" style="color:rgb(191, 199, 213)">$(</span><span class="token string variable function" style="color:rgb(130, 170, 255)">basename</span><span class="token string variable" style="color:rgb(191, 199, 213)"> </span><span class="token string variable string" style="color:rgb(195, 232, 141)">"</span><span class="token string variable string variable" style="color:rgb(191, 199, 213)">${path}</span><span class="token string variable string" style="color:rgb(195, 232, 141)">"</span><span class="token string variable" style="color:rgb(191, 199, 213)">)</span><span class="token string" style="color:rgb(195, 232, 141)">.nuke"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">     </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">nuke_path</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable" style="color:rgb(191, 199, 213)">mktemp </span><span class="token variable parameter variable" style="color:rgb(191, 199, 213)">-d</span><span class="token variable" style="color:rgb(191, 199, 213)"> </span><span class="token variable string" style="color:rgb(195, 232, 141)">"</span><span class="token variable string variable" style="color:rgb(191, 199, 213)">${nuke_prefix}</span><span class="token variable string" style="color:rgb(195, 232, 141)">.XXXXXX"</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">     </span><span class="token function" style="color:rgb(130, 170, 255)">mv</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"</span><span class="token string variable" style="color:rgb(191, 199, 213)">${path}</span><span class="token string" style="color:rgb(195, 232, 141)">"</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"</span><span class="token string variable" style="color:rgb(191, 199, 213)">${nuke_path}</span><span class="token string" style="color:rgb(195, 232, 141)">/"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">     </span><span class="token function" style="color:rgb(130, 170, 255)">rm</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(191, 199, 213)">-rf</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"</span><span class="token string variable" style="color:rgb(191, 199, 213)">${nuke_prefix}</span><span class="token string" style="color:rgb(195, 232, 141)">.*"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">   </span><span class="token keyword" style=font-style:italic>fi</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">nuke_if_too_big ~/.cache/nce </span><span class="token number" style="color:rgb(247, 140, 108)">512</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">nuke_if_too_big ~/.cache/pants/named_caches </span><span class="token number" style="color:rgb(247, 140, 108)">1024</span><br/></span></code></pre></div></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_LZeC alert alert--secondary"><div class=admonitionHeading_SJYM><span class=admonitionIcon_iulS><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"/></svg></span>Tip: check cache performance with <code>[stats].log</code></div><div class=admonitionContent_NJOy><p>Set the option <code>[stats].log = true</code> in <code>pants.ci.toml</code> for Pants to print metrics of your cache's performance at the end of the run, including the number of cache hits and the total time saved thanks to caching, e.g.:<div class="language-text codeBlockContainer_LrZr theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_QpNL><pre tabindex=0 class="prism-code language-text codeBlock_z5Jo thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_YVRJ><span class=token-line style=color:#bfc7d5><span class="token plain">  local_cache_requests: 204</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  local_cache_requests_cached: 182</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  local_cache_requests_uncached: 22</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  local_cache_total_time_saved_ms: 307200</span><br/></span></code></pre></div></div><p>You can also add <code>plugins = ["hdrhistogram"]</code> to the <code>[GLOBAL]</code> section of <code>pants.ci.toml</code> for Pants to print histograms of cache performance, e.g. the size of blobs cached.</div></div>
<div class="theme-admonition theme-admonition-tip admonition_LZeC alert alert--success"><div class=admonitionHeading_SJYM><span class=admonitionIcon_iulS><svg viewBox="0 0 12 16"><path fill-rule=evenodd d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"/></svg></span>Remote caching</div><div class=admonitionContent_NJOy><p>Rather than storing your cache with your CI provider, remote caching stores the cache in the cloud, using gRPC and the open-source Remote Execution API for low-latency and fine-grained caching.<p>This brings several benefits over local caching:<ul>
<li class="">All machines and CI jobs share the same cache.</li>
<li class="">Remote caching downloads precisely what is needed by your run—when it's needed—rather than pessimistically downloading the entire cache at the start of the run.<!-- -->
<ul>
<li class="">No download and upload stage for your cache.</li>
<li class="">No need to "nuke" your cache when it gets too big.</li>
</ul>
</li>
</ul><p>See <a class="" href=/2.26/docs/using-pants/remote-caching-and-execution>Remote Caching and Execution</a> for more information.</div></div>
<h2 class="anchor anchorTargetStickyNavbar_UrHV" id=recommended-commands>Recommended commands<a href=#recommended-commands class=hash-link aria-label="Direct link to Recommended commands" title="Direct link to Recommended commands" translate=no>​</a></h2>
<div class="theme-admonition theme-admonition-caution admonition_LZeC alert alert--warning"><div class=admonitionHeading_SJYM><span class=admonitionIcon_iulS><svg viewBox="0 0 16 16"><path fill-rule=evenodd d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"/></svg></span>Autofixing goals</div><div class=admonitionContent_NJOy><p>The goals <code>fmt</code> and <code>fix</code> will attempt to automatically correct your code and then return zero if they were able to do so. This generally counts as "success" for most CI systems. In contrast the <code>lint</code> goal will not modify code and instead exit with a non-zero status if any tools detected a problem. In other words the <code>lint</code> goal is like the "checking" version of <code>fmt/fix</code>. Prefer <code>lint</code> if you want your CI system to return job failures to enforce linting and format rules.</div></div>
<p>With both approaches, you may want to shard the input targets into multiple CI jobs, for increased parallelism. See <a class="" href=/2.26/docs/using-pants/advanced-target-selection#sharding-the-input-targets>Advanced Target Selection</a>. (This is typically less necessary when using <a class="" href=/2.26/docs/using-pants/remote-caching-and-execution>remote caching</a>.)</p>
<h3 class="anchor anchorTargetStickyNavbar_UrHV" id=approach-1-only-run-over-changed-files>Approach #1: only run over changed files<a href=#approach-1-only-run-over-changed-files class=hash-link aria-label="Direct link to Approach #1: only run over changed files" title="Direct link to Approach #1: only run over changed files" translate=no>​</a></h3>
<p>Because Pants understands the dependencies of your code, you can use Pants to speed up your CI by only running tests and linters over files that actually made changes.</p>
<p>We recommend running these commands in CI:</p>
<div class="language-shell codeBlockContainer_LrZr theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_QpNL><pre tabindex=0 class="prism-code language-shell codeBlock_z5Jo thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_YVRJ><span class=token-line style=color:#bfc7d5><span class="token plain">❯ pants </span><span class="token parameter variable" style="color:rgb(191, 199, 213)">--version</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Bootstrap Pants.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">❯ pants </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  --changed-since</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">origin/main </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  tailor </span><span class="token parameter variable" style="color:rgb(191, 199, 213)">--check</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  update-build-files </span><span class="token parameter variable" style="color:rgb(191, 199, 213)">--check</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  lint</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">❯ pants </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  --changed-since</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">origin/main </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  --changed-dependents</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">transitive </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  check </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">test</span><br/></span></code></pre></div></div>
<p>Because most linters do not care about a target's dependencies, we lint all changed files and targets, but not any dependents of those changes.</p>
<p>Meanwhile, tests should be rerun when any changes are made to the tests <em>or</em> to dependencies of those tests, so we use the option <code>--changed-dependents=transitive</code>. <code>check</code> should also run on any transitive changes.</p>
<p>See <a class="" href=/2.26/docs/using-pants/advanced-target-selection>Advanced target selection</a> for more information on <code>--changed-since</code> and alternative techniques to select targets to run in CI.</p>
<div class="theme-admonition theme-admonition-caution admonition_LZeC alert alert--warning"><div class=admonitionHeading_SJYM><span class=admonitionIcon_iulS><svg viewBox="0 0 16 16"><path fill-rule=evenodd d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"/></svg></span>This will not handle all cases, like hooking up a new linter</div><div class=admonitionContent_NJOy><p>For example, if you add a new plugin to Flake8, Pants will still only run over changed files, meaning you may miss some new lint issues.<p>For absolute correctness, you may want to use Approach #2. Alternatively, add conditional logic to your CI, e.g. that any changes to <code>pants.toml</code> trigger using Approach #2.</div></div>
<div class="theme-admonition theme-admonition-note admonition_LZeC alert alert--secondary"><div class=admonitionHeading_SJYM><span class=admonitionIcon_iulS><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"/></svg></span>GitHub Actions: use <code>Checkout</code></div><div class=admonitionContent_NJOy><p>To use <code>--changed-since</code>, you may want to use the <a href=https://github.com/actions/checkout target=_blank rel="noopener noreferrer" class="">Checkout action</a>.<p>By default, Checkout will only fetch the latest commit; you likely want to set <code>fetch-depth</code> to fetch prior commits.</div></div>
<div class="theme-admonition theme-admonition-note admonition_LZeC alert alert--secondary"><div class=admonitionHeading_SJYM><span class=admonitionIcon_iulS><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"/></svg></span>GitLab CI: disable shallow clones or fetch main branch</div><div class=admonitionContent_NJOy><p>GitLab's merge pipelines make a shallow clone by default, which only contains recent commits for the feature branch being merged. That severely limits <code>--changed-since</code>. There are two possible workarounds:<ol>
<li class="">Clone the entire repository by going to "CI / CD" settings and erase the number from the "Git shallow clone" field of the "General pipelines" section. Don't forget to "Save changes". This has the advantage of cloning everything, which also is the biggest long-term disadvantage.</li>
<li class="">A more targeted and hence light-weight intervention leaves the shallow clone setting at its default value and instead fetches the <code>main</code> branch as well:</li>
</ol><div class="language-text codeBlockContainer_LrZr theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_QpNL><pre tabindex=0 class="prism-code language-text codeBlock_z5Jo thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_YVRJ><span class=token-line style=color:#bfc7d5><span class="token plain">git branch -a</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">git remote set-branches origin main</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">git fetch --depth 1 origin main</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">git branch -a</span><br/></span></code></pre></div></div><p>The <code>git branch</code> commands are only included to print out all available branches before and after fetching <code>origin/main</code>.</div></div>
<div class="theme-admonition theme-admonition-note admonition_LZeC alert alert--secondary"><div class=admonitionHeading_SJYM><span class=admonitionIcon_iulS><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"/></svg></span>Using partial clones in CI</div><div class=admonitionContent_NJOy><p>Shallow clones are fast, but have the disadvantage of breaking <code>--changed-since</code> if an insufficient amount of depth is fetched from remote. This is particularly acute for feature branches that are very out-of-date or have a large number of commits.<p><a href=https://git-scm.com/docs/partial-clone target=_blank rel="noopener noreferrer" class="">Partial clones</a> are still quite fast, have the advantage of not breaking <code>--changed-since</code>, and don't require any depth setting. Unlike shallow clones, Git will fetch trees and blobs on-demand as it needs them without failing.<p>If your CI does not support partial clones directly, you can define your own custom checkout strategy:<ul>
<li class="">Treeless: <code>git clone --filter=tree:0 &lt;repository></code></li>
<li class="">Blobless: <code>git clone --filter=blob:none &lt;repository></code></li>
</ul><p>As a workaround to <a href=https://github.com/pantsbuild/pants/issues/20027 target=_blank rel="noopener noreferrer" class="">#20027</a> permission errors, you might need to run this after the cloning the repo:<p><code>git config core.sshCommand "env SSH_AUTH_SOCK=$SSH_AUTH_SOCK ssh"</code></div></div>
<h3 class="anchor anchorTargetStickyNavbar_UrHV" id=approach-2-run-over-everything>Approach #2: run over everything<a href=#approach-2-run-over-everything class=hash-link aria-label="Direct link to Approach #2: run over everything" title="Direct link to Approach #2: run over everything" translate=no>​</a></h3>
<p>Alternatively, you can simply run over all your code. Pants's caching means that you will not need to rerun on changed files.</p>
<div class="language-bash codeBlockContainer_LrZr theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_QpNL><pre tabindex=0 class="prism-code language-bash codeBlock_z5Jo thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_YVRJ><span class=token-line style=color:#bfc7d5><span class="token plain">❯ pants </span><span class="token parameter variable" style="color:rgb(191, 199, 213)">--version</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Bootstrap Pants.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">❯ pants </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">   tailor </span><span class="token parameter variable" style="color:rgb(191, 199, 213)">--check</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">   update-build-files </span><span class="token parameter variable" style="color:rgb(191, 199, 213)">--check</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">   lint check </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">test</span><span class="token plain"> ::</span><br/></span></code></pre></div></div>
<p>However, when the cache gets too big, it should be nuked (see "Directories to cache"), so your CI may end up doing more work than Approach #1.</p>
<p>This approach works particularly well if you are using <a class="" href=/2.26/docs/using-pants/remote-caching-and-execution/remote-caching>remote caching</a>.</p>
<h2 class="anchor anchorTargetStickyNavbar_UrHV" id=configuring-pants-for-ci-pantscitoml-optional>Configuring Pants for CI: <code>pants.ci.toml</code> (optional)<a href=#configuring-pants-for-ci-pantscitoml-optional class=hash-link aria-label="Direct link to configuring-pants-for-ci-pantscitoml-optional" title="Direct link to configuring-pants-for-ci-pantscitoml-optional" translate=no>​</a></h2>
<p>Sometimes, you may want config specific to your CI, such as turning on test coverage reports. If you want CI-specific config, create a dedicated <code>pants.ci.toml</code> <a class="" href=/2.26/docs/using-pants/key-concepts/options>config file</a>. For example:</p>
<div class="language-toml codeBlockContainer_LrZr theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockTitle_GKkA>pants.ci.toml</div><div class=codeBlockContent_QpNL><pre tabindex=0 class="prism-code language-toml codeBlock_z5Jo thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_YVRJ><span class=token-line style=color:#bfc7d5><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token table class-name" style="color:rgb(255, 203, 107)">GLOBAL</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Colors often work in CI, but the shell is usually not a TTY so Pants</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># doesn't attempt to use them by default.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token key property">colors</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token table class-name" style="color:rgb(255, 203, 107)">stats</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token key property">log</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token table class-name" style="color:rgb(255, 203, 107)">test</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token key property">use_coverage</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token table class-name" style="color:rgb(255, 203, 107)">coverage-py</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token key property">report</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">"xml"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token key property">global_report</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token table class-name" style="color:rgb(255, 203, 107)">pytest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token key property">args</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">"-vv"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"--no-header"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><br/></span></code></pre></div></div>
<p>Then, in your CI script or config, set the environment variable <code>PANTS_CONFIG_FILES=pants.ci.toml</code> to use this new config file, in addition to <code>pants.toml</code>.</p>
<h3 class="anchor anchorTargetStickyNavbar_UrHV" id=tuning-resource-consumption-advanced>Tuning resource consumption (advanced)<a href=#tuning-resource-consumption-advanced class=hash-link aria-label="Direct link to Tuning resource consumption (advanced)" title="Direct link to Tuning resource consumption (advanced)" translate=no>​</a></h3>
<p>Pants allows you to control its resource consumption. These options all have sensible defaults. In most cases, there is no need to change them. However, you may benefit from tuning these options.</p>
<p>Concurrency options:</p>
<ul>
<li class=""><a class="" href=/2.26/reference/global-options#process_execution_local_parallelism><code>process_execution_local_parallelism</code></a>: number of concurrent processes that may be executed locally.</li>
<li class=""><a class="" href=/2.26/reference/global-options#rule_threads_core><code>rule_threads_core</code></a>: number of threads to keep active to execute <code>@rule</code> logic.</li>
<li class=""><a class="" href=/2.26/reference/global-options#rule_threads_max><code>rule_threads_max</code></a>: maximum number of threads to use to execute <code>@rule</code> logic.</li>
</ul>
<p>Memory usage options:</p>
<ul>
<li class=""><a class="" href=/2.26/reference/global-options#pantsd><code>pantsd</code></a>: enable or disable the Pants daemon, which uses an in-memory cache to speed up subsequent runs after the first run in CI.</li>
<li class=""><a class="" href=/2.26/reference/global-options#pantsd_max_memory_usage><code>pantsd_max_memory_usage</code></a>: reduce or increase the size of Pantsd's in-memory cache.</li>
</ul>
<p>The default test runners for these CI providers have the following resources. If you are using a custom runner, e.g. enterprise, check with your CI provider.</p>
<table><thead><tr><th style=text-align:left>CI Provider<th style=text-align:left>Cores<th style=text-align:left>RAM<th style=text-align:left>Docs<tbody><tr><td style=text-align:left>GitHub Actions, Linux<td style=text-align:left>2<td style=text-align:left>7 GB<td style=text-align:left><a href=https://docs.github.com/en/actions/using-github-hosted-runners/about-github-hosted-runners#supported-runners-and-hardware-resources target=_blank rel="noopener noreferrer" class="">link</a><tr><td style=text-align:left>Travis, Linux<td style=text-align:left>2<td style=text-align:left>7.5 GB<td style=text-align:left><a href=https://docs.travis-ci.com/user/reference/overview/#virtualisation-environment-vs-operating-system target=_blank rel="noopener noreferrer" class="">link</a><tr><td style=text-align:left>Circle CI, Linux, free plan<td style=text-align:left>2<td style=text-align:left>4 GB<td style=text-align:left><a href=https://circleci.com/docs/2.0/credits/#free-plan target=_blank rel="noopener noreferrer" class="">link</a><tr><td style=text-align:left>GitLab, Linux shared runners<td style=text-align:left>1<td style=text-align:left>3.75 GB<td style=text-align:left><a href=https://docs.gitlab.com/ee/user/gitlab_com/#linux-shared-runners target=_blank rel="noopener noreferrer" class="">link</a></table>
<h2 class="anchor anchorTargetStickyNavbar_UrHV" id=tip-automatically-retry-failed-tests>Tip: automatically retry failed tests<a href=#tip-automatically-retry-failed-tests class=hash-link aria-label="Direct link to Tip: automatically retry failed tests" title="Direct link to Tip: automatically retry failed tests" translate=no>​</a></h2>
<p>Pants can automatically retry failed tests. This can help keep your builds passing even with flaky tests, like integration tests.</p>
<div class="language-toml codeBlockContainer_LrZr theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_QpNL><pre tabindex=0 class="prism-code language-toml codeBlock_z5Jo thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_YVRJ><span class=token-line style=color:#bfc7d5><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token table class-name" style="color:rgb(255, 203, 107)">test</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token key property">attempts_default</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">3</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_UrHV" id=tip-store-pants-logs-as-artifacts>Tip: store Pants logs as artifacts<a href=#tip-store-pants-logs-as-artifacts class=hash-link aria-label="Direct link to Tip: store Pants logs as artifacts" title="Direct link to Tip: store Pants logs as artifacts" translate=no>​</a></h2>
<p>We recommend that you configure your CI system to store the pants log (<code>.pants.d/workdir/pants.log</code>) as a build artifact, so that it is available in case you need to troubleshoot CI issues.</p>
<p>Different CI providers and systems have different ways to configure build artifacts:</p>
<ul>
<li class="">Circle CI - <a href=https://circleci.com/docs/2.0/artifacts/ target=_blank rel="noopener noreferrer" class="">Storing artifacts</a></li>
<li class="">GitHub Actions - <a href=https://docs.github.com/en/actions/guides/storing-workflow-data-as-artifacts target=_blank rel="noopener noreferrer" class="">Storing Artifacts</a> - <a href=https://github.com/pantsbuild/pants/pull/11860 target=_blank rel="noopener noreferrer" class="">example in the pants repo</a></li>
<li class="">Bitbucket pipelines - <a href=https://support.atlassian.com/bitbucket-cloud/docs/use-artifacts-in-steps/ target=_blank rel="noopener noreferrer" class="">Using artifacts</a></li>
<li class="">Jenkins - <a href=https://www.jenkins.io/doc/pipeline/tour/tests-and-artifacts/ target=_blank rel="noopener noreferrer" class="">Recording artifacts</a></li>
</ul>
<p>It's particularly useful to configure your CI to always upload the log, even if prior steps in your pipeline failed.</div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_eWnd"><a href=https://github.com/pantsbuild/pants/edit/main/docs/docs/using-pants/using-pants-in-ci.mdx target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_HmrO aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>Edit this page</a></div><div class="col lastUpdated_F4iS"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/2.26/docs/using-pants/assets-and-archives><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>Assets and archives</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/2.26/docs/using-pants/setting-up-an-ide><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>Setting up an IDE</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_ZBPU thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#directories-to-cache class="table-of-contents__link toc-highlight">Directories to cache</a><li><a href=#recommended-commands class="table-of-contents__link toc-highlight">Recommended commands</a><ul><li><a href=#approach-1-only-run-over-changed-files class="table-of-contents__link toc-highlight">Approach #1: only run over changed files</a><li><a href=#approach-2-run-over-everything class="table-of-contents__link toc-highlight">Approach #2: run over everything</a></ul><li><a href=#configuring-pants-for-ci-pantscitoml-optional class="table-of-contents__link toc-highlight">Configuring Pants for CI: <code>pants.ci.toml</code> (optional)</a><ul><li><a href=#tuning-resource-consumption-advanced class="table-of-contents__link toc-highlight">Tuning resource consumption (advanced)</a></ul><li><a href=#tip-automatically-retry-failed-tests class="table-of-contents__link toc-highlight">Tip: automatically retry failed tests</a><li><a href=#tip-store-pants-logs-as-artifacts class="table-of-contents__link toc-highlight">Tip: store Pants logs as artifacts</a></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Spotlight</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/spotlight/users>Users</a><li class=footer__item><a class=footer__link-item href=/spotlight/testimonials>Testimonials</a><li class=footer__item><a class=footer__link-item href=/spotlight/media>Media</a><li class=footer__item><a class=footer__link-item href=/spotlight/service-providers>Service Providers</a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Connect</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://github.com/pantsbuild/pants target=_blank rel="noopener noreferrer" class=footer__link-item>GitHub<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_QvT7><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://twitter.com/pantsbuild target=_blank rel="noopener noreferrer" class=footer__link-item>Twitter<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_QvT7><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://www.youtube.com/@pantsbuild target=_blank rel="noopener noreferrer" class=footer__link-item>YouTube<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_QvT7><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://groups.google.com/forum/#!forum/pants-devel target=_blank rel="noopener noreferrer" class=footer__link-item>Mailing List<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_QvT7><use href=#theme-svg-external-link /></svg></a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>More</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/blog>Blog</a><li class=footer__item><a class=footer__link-item href=/sponsors>Sponsors</a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Community</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/community/getting-help>Getting Help</a><li class=footer__item><a class=footer__link-item href=/community/members>Members</a><li class=footer__item><a class=footer__link-item href=/community/code-of-conduct>Code of Conduct</a><li class=footer__item><a class=footer__link-item href=/community/meet-the-team>Meet the Team</a><li class=footer__item><a class=footer__link-item href=/community/maintainers>Maintainers</a><li class=footer__item><a class=footer__link-item href=/community/contentious-decisions>Contentious Decisions</a></ul></div></div><div class="footer__bottom text--center"><div class=footer__copyright>Copyright © Pants project contributors. <a href=https://github.com/pantsbuild/pantsbuild.org>Website source</a> @ <a href=https://github.com/pantsbuild/pantsbuild.org/commit/a274212dfdcfe1657dd5eae4836420db8cdf9099>a27421</a>.</div></div></div></footer></div></body>
<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-2.24 docs-doc-page docs-doc-id-docs/writing-plugins/the-rules-api/installing-tools" data-has-hydrated=false><head><meta charset=UTF-8><meta name=generator content="Docusaurus v3.9.2"><title data-rh=true>Installing tools | Pantsbuild</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"/><meta data-rh=true name=twitter:card content=summary_large_image /><meta data-rh=true property=og:image content=https://www.pantsbuild.org/img/social-card.png /><meta data-rh=true name=twitter:image content=https://www.pantsbuild.org/img/social-card.png /><meta data-rh=true property=og:url content=https://www.pantsbuild.org/2.24/docs/writing-plugins/the-rules-api/installing-tools /><meta data-rh=true property=og:locale content=en /><meta data-rh=true name=docusaurus_locale content=en /><meta data-rh=true name=docsearch:language content=en /><meta data-rh=true name=docusaurus_version content=2.24 /><meta data-rh=true name=docusaurus_tag content=docs-default-2.24 /><meta data-rh=true name=docsearch:version content=2.24 /><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-2.24 /><meta data-rh=true name=robots content="noindex, nofollow"/><meta data-rh=true property=og:title content="Installing tools | Pantsbuild"/><meta data-rh=true name=description content="Various methods for Pants to access the tools your plugin needs."/><meta data-rh=true property=og:description content="Various methods for Pants to access the tools your plugin needs."/><link data-rh=true rel=icon href=/img/favicon.ico /><link data-rh=true rel=canonical href=https://www.pantsbuild.org/2.24/docs/writing-plugins/the-rules-api/installing-tools /><link data-rh=true rel=alternate href=https://www.pantsbuild.org/2.24/docs/writing-plugins/the-rules-api/installing-tools hreflang=en /><link data-rh=true rel=alternate href=https://www.pantsbuild.org/2.24/docs/writing-plugins/the-rules-api/installing-tools hreflang=x-default /><link data-rh=true rel=preconnect href=https://QD9KY1TRVK-dsn.algolia.net crossorigin=anonymous /><script data-rh=true type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://www.pantsbuild.org/2.24/docs/writing-plugins/the-rules-api/","name":"The Rules API","position":1},{"@type":"ListItem","item":"https://www.pantsbuild.org/2.24/docs/writing-plugins/the-rules-api/installing-tools","name":"Installing tools","position":2}]}</script><link rel=alternate type=application/rss+xml href=/blog/rss.xml title="Pantsbuild RSS Feed"><link rel=alternate type=application/atom+xml href=/blog/atom.xml title="Pantsbuild Atom Feed"><link rel=preconnect href=https://www.google-analytics.com><link rel=preconnect href=https://www.googletagmanager.com><script async src="https://www.googletagmanager.com/gtag/js?id=G-SEHBXJRF42"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-SEHBXJRF42",{anonymize_ip:!0})</script><link rel=search type=application/opensearchdescription+xml title=Pantsbuild href=/opensearch.xml><link rel=stylesheet href=/assets/css/styles.b71b45ed.css /><script src=/assets/js/runtime~main.43acf77f.js defer></script><script src=/assets/js/main.636c7439.js defer></script></head><body class=navigation-with-keyboard><svg style="display: none;"><defs>
<symbol id=theme-svg-external-link viewBox="0 0 24 24"><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><div role=region aria-label="Skip to main content"><a class=skipToContent_lucK href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="theme-layout-navbar navbar navbar--fixed-top"><div class=navbar__inner><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/><div class=navbar__logo><img src=/img/logo.svg alt="My Site Logo" class="themedComponent_x_jL themedComponent--light_WGb9"/><img src=/img/logo.svg alt="My Site Logo" class="themedComponent_x_jL themedComponent--dark_oBxQ"/></div><b class="navbar__title text--truncate">Pantsbuild</b></a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/2.24/docs/introduction/welcome-to-pants>Docs</a><a class="navbar__item navbar__link" href=/2.24/reference/global-options>Reference</a><a class="navbar__item navbar__link" href=/blog>Blog</a><a class="navbar__item navbar__link" href=/sponsors>Sponsors</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class=navbar__link aria-haspopup=true aria-expanded=false role=button href=/2.24/docs/introduction/welcome-to-pants>2.24 (deprecated)</a><ul class=dropdown__menu><li><a class=dropdown__link href=/prerelease/docs/writing-plugins/the-rules-api/installing-tools>2.31 (prerelease)</a><li><a class=dropdown__link href=/stable/docs/writing-plugins/the-rules-api/installing-tools>2.30</a><li><a class=dropdown__link href=/2.29/docs/writing-plugins/the-rules-api/installing-tools>2.29</a><li><a class=dropdown__link href=/2.28/docs/writing-plugins/the-rules-api/installing-tools>2.28 (deprecated)</a><li class=""><hr class=dropdown-separator><li><a class=dropdown__link href=/versions>All Versions</a></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link>Slack</a><ul class=dropdown__menu><li><a href=https://pantsbuild.slack.com target=_blank rel="noopener noreferrer" class=dropdown__link>Workspace<svg width=12 height=12 aria-label="(opens in new tab)" class=iconExternalLink_QvT7><use href=#theme-svg-external-link /></svg></a><li><a href="https://docs.google.com/forms/d/e/1FAIpQLSf9zgf-MXRnVDJbrVEST3urqneq7LCcy0zw8qU-GH4hPMn52A/viewform?usp=sf_link" target=_blank rel="noopener noreferrer" class=dropdown__link>Workspace Invite<svg width=12 height=12 aria-label="(opens in new tab)" class=iconExternalLink_QvT7><use href=#theme-svg-external-link /></svg></a><li><a href=https://chat.pantsbuild.org target=_blank rel="noopener noreferrer" class=dropdown__link>Linen Mirror<svg width=12 height=12 aria-label="(opens in new tab)" class=iconExternalLink_QvT7><use href=#theme-svg-external-link /></svg></a></ul></div><a href=https://github.com/pantsbuild/pants target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_QvT7><use href=#theme-svg-external-link /></svg></a><div class=navbarSearchContainer_Mydu><button type=button class="DocSearch DocSearch-Button" aria-label="Search (Meta+k)" aria-keyshortcuts=Meta+k><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 24 24" aria-hidden=true><circle cx=11 cy=11 r=8 stroke=currentColor fill=none stroke-width=1.4 /><path d="m21 21-4.3-4.3" stroke=currentColor fill=none stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>Search</span></span><span class=DocSearch-Button-Keys></span></button></div><div class="toggle_AwgP colorModeToggle_rXRM"><button class="clean-btn toggleButton_kTC9 toggleButtonDisabled_N4X8" type=button disabled title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_X8HE lightToggleIcon_cay9"><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_X8HE darkToggleIcon_B6hH"><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_X8HE systemToggleIcon_k4zv"><path fill=currentColor d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"/></svg></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="theme-layout-main main-wrapper mainWrapper_GzA5"><div class=docsWrapper_LbKj><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_bDNn" type=button></button><div class=docRoot_PpgM><aside class="theme-doc-sidebar-container docSidebarContainer_aj0D"><div class=sidebarViewport_pg77><div class=sidebar_Us5f><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_FPuF"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_cnt8 menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/2.24/docs/introduction/welcome-to-pants><span title=Introduction class=categoryLinkLabel_JmoG>Introduction</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_cnt8 menu__link menu__link--sublist" href=/2.24/docs/getting-started><span title="Getting Started" class=categoryLinkLabel_JmoG>Getting Started</span></a><button aria-label="Expand sidebar category 'Getting Started'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_cnt8 menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/2.24/docs/using-pants/command-line-help><span title="Using Pants" class=categoryLinkLabel_JmoG>Using Pants</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_cnt8 menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/2.24/docs/python/overview><span title=Python class=categoryLinkLabel_JmoG>Python</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_cnt8 menu__link menu__link--sublist" href=/2.24/docs/go><span title=Go class=categoryLinkLabel_JmoG>Go</span></a><button aria-label="Expand sidebar category 'Go'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_cnt8 menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/2.24/docs/jvm/java-and-scala><span title=JVM class=categoryLinkLabel_JmoG>JVM</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_cnt8 menu__link menu__link--sublist" href=/2.24/docs/shell><span title=Shell class=categoryLinkLabel_JmoG>Shell</span></a><button aria-label="Expand sidebar category 'Shell'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_cnt8 menu__link menu__link--sublist" href=/2.24/docs/docker><span title=Docker class=categoryLinkLabel_JmoG>Docker</span></a><button aria-label="Expand sidebar category 'Docker'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_cnt8 menu__link menu__link--sublist" href=/2.24/docs/helm><span title=Helm class=categoryLinkLabel_JmoG>Helm</span></a><button aria-label="Expand sidebar category 'Helm'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/2.24/docs/terraform><span title=Terraform class=linkLabel_BwCR>Terraform</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/2.24/docs/sql><span title=SQL class=linkLabel_BwCR>SQL</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_cnt8 menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/2.24/docs/ad-hoc-tools/integrating-new-tools-without-plugins><span title="Ad-Hoc Tools" class=categoryLinkLabel_JmoG>Ad-Hoc Tools</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_cnt8 menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/2.24/docs/javascript/overview><span title=Javascript class=categoryLinkLabel_JmoG>Javascript</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_cnt8 menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role=button aria-expanded=true href=/2.24/docs/writing-plugins/overview><span title="Writing Plugins" class=categoryLinkLabel_JmoG>Writing Plugins</span></a></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/2.24/docs/writing-plugins/overview><span title="Plugins overview" class=linkLabel_BwCR>Plugins overview</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/2.24/docs/writing-plugins/macros><span title=Macros class=linkLabel_BwCR>Macros</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_cnt8 menu__link menu__link--sublist" tabindex=0 href=/2.24/docs/writing-plugins/the-target-api><span title="The Target API" class=categoryLinkLabel_JmoG>The Target API</span></a><button aria-label="Expand sidebar category 'The Target API'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_cnt8 menu__link menu__link--sublist menu__link--active" tabindex=0 href=/2.24/docs/writing-plugins/the-rules-api><span title="The Rules API" class=categoryLinkLabel_JmoG>The Rules API</span></a><button aria-label="Collapse sidebar category 'The Rules API'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/2.24/docs/writing-plugins/the-rules-api/concepts><span title=Concepts class=linkLabel_BwCR>Concepts</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/2.24/docs/writing-plugins/the-rules-api/goal-rules><span title="Goal rules" class=linkLabel_BwCR>Goal rules</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/2.24/docs/writing-plugins/the-rules-api/options-and-subsystems><span title="Options and subsystems" class=linkLabel_BwCR>Options and subsystems</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/2.24/docs/writing-plugins/the-rules-api/file-system><span title="File system" class=linkLabel_BwCR>File system</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/2.24/docs/writing-plugins/the-rules-api/processes><span title=Processes class=linkLabel_BwCR>Processes</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/2.24/docs/writing-plugins/the-rules-api/installing-tools><span title="Installing tools" class=linkLabel_BwCR>Installing tools</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/2.24/docs/writing-plugins/the-rules-api/rules-and-the-target-api><span title="Rules and the Target API" class=linkLabel_BwCR>Rules and the Target API</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/2.24/docs/writing-plugins/the-rules-api/union-rules-advanced><span title="Union rules (advanced)" class=linkLabel_BwCR>Union rules (advanced)</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/2.24/docs/writing-plugins/the-rules-api/logging-and-dynamic-output><span title="Logging and dynamic output" class=linkLabel_BwCR>Logging and dynamic output</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/2.24/docs/writing-plugins/the-rules-api/testing-plugins><span title="Testing plugins" class=linkLabel_BwCR>Testing plugins</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/2.24/docs/writing-plugins/the-rules-api/tips-and-debugging><span title="Tips and debugging" class=linkLabel_BwCR>Tips and debugging</span></a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_cnt8 menu__link menu__link--sublist" tabindex=0 href=/2.24/docs/writing-plugins/common-plugin-tasks><span title="Common plugin tasks" class=categoryLinkLabel_JmoG>Common plugin tasks</span></a><button aria-label="Expand sidebar category 'Common plugin tasks'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/2.24/docs/writing-plugins/common-subsystem-tasks><span title="Common subsystem tasks" class=linkLabel_BwCR>Common subsystem tasks</span></a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_cnt8 menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/2.24/docs/releases/deprecation-policy><span title=Releases class=categoryLinkLabel_JmoG>Releases</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_cnt8 menu__link menu__link--sublist" href=/2.24/docs/contributions><span title=Contributions class=categoryLinkLabel_JmoG>Contributions</span></a><button aria-label="Expand sidebar category 'Contributions'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_cnt8 menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/2.24/docs/tutorials/testing-plugins><span title=Tutorials class=categoryLinkLabel_JmoG>Tutorials</span></a></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 margin-vert--none"><hr/><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/2.24/reference/global-options><span title=Reference class=linkLabel_BwCR>Reference</span></a></ul></nav></div></div></aside><main class=docMainContainer_oWFJ><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_b2qu"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role=alert><div>This is documentation for <!-- -->Pantsbuild<!-- --> <b>2.24 (deprecated)</b>, which is no longer actively maintained.</div><div class=margin-top--md>For up-to-date documentation, see the <b><a href=/stable/docs/writing-plugins/the-rules-api/installing-tools>latest version</a></b> (<!-- -->2.30<!-- -->).</div></div><div class=docItemContainer_TkYX><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_nJ9e" aria-label=Breadcrumbs><ul class=breadcrumbs><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_WW1h><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li class=breadcrumbs__item><span class=breadcrumbs__link>Writing Plugins</span><li class=breadcrumbs__item><a class=breadcrumbs__link href=/2.24/docs/writing-plugins/the-rules-api><span>The Rules API</span></a><li class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link>Installing tools</span></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 2.24 (deprecated)</span><div class="tocCollapsible_hk9T theme-doc-toc-mobile tocMobile_cNpz"><button type=button class="clean-btn tocCollapsibleButton_ljii">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Installing tools</h1></header><p>Various methods for Pants to access the tools your plugin needs.</p>
<hr/>
<h2 class="anchor anchorTargetStickyNavbar_UrHV" id=binarypaths-find-already-installed-binaries><code>BinaryPaths</code>: Find already installed binaries<a href=#binarypaths-find-already-installed-binaries class=hash-link aria-label="Direct link to binarypaths-find-already-installed-binaries" title="Direct link to binarypaths-find-already-installed-binaries" translate=no>​</a></h2>
<p>For certain tools that are hard to automatically install—such as Docker or language interpreters—you may want to assume that the user already has the tool installed on their machine.</p>
<p>The simplest approach is to assume that the binary is installed at a fixed absolute path, such as <code>/bin/echo</code> or <code>/usr/bin/perl</code>. In the <code>argv</code> for your <code>Process</code>, use this absolute path as your first element.</p>
<p>If you instead want to allow the binary to be located anywhere on a user's machine, you can use <code>BinaryPaths</code> to search certain directories—such as a user's <code>$PATH</code>—to find the absolute path to the binary.</p>
<div class="language-python codeBlockContainer_LrZr theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_QpNL><pre tabindex=0 class="prism-code language-python codeBlock_z5Jo thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_YVRJ><span class=token-line style=color:#bfc7d5><span class="token keyword" style=font-style:italic>from</span><span class="token plain"> pants</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">core</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">util_rules</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">system_binaries </span><span class="token keyword" style=font-style:italic>import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    BinaryPathRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    BinaryPaths</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    ProcessResult</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    Process</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">@rule</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token keyword" style=font-style:italic>async</span><span class="token plain"> </span><span class="token keyword" style=font-style:italic>def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">></span><span class="token plain"> Foo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    docker_paths </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style=font-style:italic>await</span><span class="token plain"> Get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        BinaryPaths</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        BinaryPathRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            binary_name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">"docker"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            search_path</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">"/usr/bin"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"/bin"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    docker_bin </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> docker_paths</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">first_path</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    </span><span class="token keyword" style=font-style:italic>if</span><span class="token plain"> docker_bin </span><span class="token keyword" style=font-style:italic>is</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        </span><span class="token keyword" style=font-style:italic>raise</span><span class="token plain"> OSError</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">"Could not find 'docker'."</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    result </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style=font-style:italic>await</span><span class="token plain"> Get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">ProcessResult</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> Process</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">argv</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">docker_bin</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br/></span></code></pre></div></div>
<p><code>BinaryPaths</code> has a field called <code>paths: tuple[BinaryPath, ...]</code>, which stores all the discovered absolute paths to the specified binary. Each <code>BinaryPath</code> object has the fields <code>path: str</code>, such as <code>/usr/bin/docker</code>, and <code>fingerprint: str</code>, which is used to invalidate the cache if the binary changes. The results will be ordered by the order of <code>search_path</code>, meaning that earlier entries in <code>search_path</code> will show up earlier in the result.</p>
<p><code>BinaryPaths</code> also has a convenience property called <code>first_path: BinaryPath | None</code>, which will return the first matching path, if any.</p>
<p>In this example, the <code>search_path</code> is hardcoded. Instead, you may want to create a <a class="" href=/2.24/docs/writing-plugins/the-rules-api/options-and-subsystems>subsystem</a> to allow users to override the search path through a dedicated option. See <a href=https://github.com/pantsbuild/pants/blob/57a47457bda0b0dfb0882d851ccd58a7535f15c1/src/python/pants/backend/python/rules/pex_environment.py#L60-L71 target=_blank rel="noopener noreferrer" class="">pex_environment.py</a> for an example that allows the user to use the special string <code>&lt;PATH></code> to read the user's <code>$PATH</code> environment variable.</p>
<div class="theme-admonition theme-admonition-note admonition_LZeC alert alert--secondary"><div class=admonitionHeading_SJYM><span class=admonitionIcon_iulS><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"/></svg></span>Checking for valid binaries (recommended)</div><div class=admonitionContent_NJOy><p>When setting up a <code>BinaryPathsRequest</code>, you can optionally pass the argument <code>test: BinaryPathTest</code>. When discovering a binary, Pants will run your test and only use the binary if the return code is 0. Pants will also fingerprint the output and invalidate the cache if the output changes from before, such as because the user upgraded the version of the tool.<p>Why do this? This is helpful to ensure that all discovered binaries are valid and safe. This is also important for Pants to be able to detect when the user has changed the binary, such as upgrading its version.<p><code>BinaryPathTest</code> takes the argument <code>args: Iterable[str]</code>, which is the arguments that Pants should run on your binary to ensure that it's a valid program. Usually, you'll set <code>args=["--version"]</code>.<div class="language-python codeBlockContainer_LrZr theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_QpNL><pre tabindex=0 class="prism-code language-python codeBlock_z5Jo thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_YVRJ><span class=token-line style=color:#bfc7d5><span class="token keyword" style=font-style:italic>from</span><span class="token plain"> pants</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">core</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">util_rules</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">system_binaries </span><span class="token keyword" style=font-style:italic>import</span><span class="token plain"> BinaryPathRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> BinaryPathTest</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">BinaryPathRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    binary_name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">"docker"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    search_path</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">"/usr/bin"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"/bin"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    test</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">BinaryPathTest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">args</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">"--version"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br/></span></code></pre></div></div><p>You can optionally set <code>fingerprint_stdout=False</code> to the <code>BinaryPathTest</code> constructor, but usually, you should keep the default of <code>True</code>.</div></div>
<h2 class="anchor anchorTargetStickyNavbar_UrHV" id=externaltool-install-pre-compiled-binaries><code>ExternalTool</code>: Install pre-compiled binaries<a href=#externaltool-install-pre-compiled-binaries class=hash-link aria-label="Direct link to externaltool-install-pre-compiled-binaries" title="Direct link to externaltool-install-pre-compiled-binaries" translate=no>​</a></h2>
<p>If your tool has a pre-compiled binary available online, Pants can download and use that binary automatically for users. This is often a better user experience than requiring the users to pre-install the tool. This will also make your build more deterministic because everyone will be using the same binary.</p>
<p>First, manually download the file. Typically, the downloaded file will be an archive like a <code>.zip</code> or <code>.tar.xz</code> file, but it may also be the actual binary. Then, run <code>shasum -a 256</code> on the downloaded file to get its digest ID, and <code>wc -c</code> to get its number of bytes.</p>
<p>If the downloaded file is an archive, you will also need to find the relative path within the archive to the binary, such as <code>bin/shellcheck</code>. You may need to use a tool like <code>unzip</code> to inspect the archive.</p>
<p>With this information, you can define a new <code>ExternalTool</code>:</p>
<div class="language-python codeBlockContainer_LrZr theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_QpNL><pre tabindex=0 class="prism-code language-python codeBlock_z5Jo thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_YVRJ><span class=token-line style=color:#bfc7d5><span class="token keyword" style=font-style:italic>from</span><span class="token plain"> pants</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">core</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">util_rules</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">external_tool </span><span class="token keyword" style=font-style:italic>import</span><span class="token plain"> ExternalTool</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token keyword" style=font-style:italic>from</span><span class="token plain"> pants</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">engine</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">platform </span><span class="token keyword" style=font-style:italic>import</span><span class="token plain"> Platform</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token keyword" style=font-style:italic>class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Shellcheck</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">ExternalTool</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    options_scope </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"shellcheck"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    </span><span class="token builtin" style="color:rgb(130, 170, 255)">help</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"A linter for shell scripts."</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    default_version </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"v0.7.1"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    default_known_versions </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">"v0.7.1|macos_arm64 |b080c3b659f7286e27004aa33759664d91e15ef2498ac709a452445d47e3ac23|1348272"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">"v0.7.1|macos_x86_64|b080c3b659f7286e27004aa33759664d91e15ef2498ac709a452445d47e3ac23|1348272"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">"v0.7.1|linux_arm64 |b50cc31509b354ab5bbfc160bc0967567ed98cd9308fd43f38551b36cccc4446|1432492"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">"v0.7.1|linux_x86_64|64f17152d96d7ec261ad3086ed42d18232fcb65148b44571b564d688269d36c8|1443836"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    </span><span class="token keyword" style=font-style:italic>def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">generate_url</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> plat</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Platform</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">></span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        platform_mapping </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">"macos_arm64"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"darwin.x86_64"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">"macos_x86_64"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"darwin.x86_64"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">"linux_arm64"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"linux.aarch64"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">"linux_x86_64"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"linux.x86_64"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        plat_str </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> platform_mapping</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">plat</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        </span><span class="token keyword" style=font-style:italic>return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            </span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">f"https://github.com/koalaman/shellcheck/releases/download/</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">self</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token string-interpolation interpolation">version</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">/"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            </span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">f"shellcheck-</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">self</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token string-interpolation interpolation">version</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">.</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">plat_str</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">.tar.xz"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    </span><span class="token keyword" style=font-style:italic>def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">generate_exe</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token keyword" style=font-style:italic>_</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Platform</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">></span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        </span><span class="token keyword" style=font-style:italic>return</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">f"./shellcheck-</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">self</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token string-interpolation interpolation">version</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">/shellcheck"</span><br/></span></code></pre></div></div>
<p>You must define the class properties <code>default_version</code> and <code>default_known_versions</code>. <code>default_known_versions</code> is a list of pipe-separated strings in the form <code>version|platform|sha256|length</code>. Use the values you found earlier by running <code>shasum</code> and <code>wc</code> for sha256 and length, respectively. <code>platform</code> should be one of <code>linux_arm64</code>, <code>linux_x86_64</code>, <code>macos_arm64</code>, and <code>macos_x86_64</code>.</p>
<p>You must also define the methods <code>generate_url</code>, which is the URL to make a GET request to download the file, and <code>generate_exe</code>, which is the relative path to the binary in the downloaded digest. Both methods take <code>plat: Platform</code> as a parameter.</p>
<p>Because an <code>ExternalTool</code> is a subclass of <a class="" href=/2.24/docs/writing-plugins/the-rules-api/options-and-subsystems><code>Subsystem</code></a>, you must also define an <code>options_scope</code>. You may optionally register additional options from <code>pants.option.option_types</code>.</p>
<p>In your rules, include the <code>ExternalTool</code> as a parameter of the rule, then use <code>Get(DownloadedExternalTool, ExternalToolRequest)</code> to download and extract the tool.</p>
<div class="language-python codeBlockContainer_LrZr theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_QpNL><pre tabindex=0 class="prism-code language-python codeBlock_z5Jo thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_YVRJ><span class=token-line style=color:#bfc7d5><span class="token keyword" style=font-style:italic>from</span><span class="token plain"> pants</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">core</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">util_rules</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">external_tool </span><span class="token keyword" style=font-style:italic>import</span><span class="token plain"> DownloadedExternalTool</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> ExternalToolRequest</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token keyword" style=font-style:italic>from</span><span class="token plain"> pants</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">engine</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">platform </span><span class="token keyword" style=font-style:italic>import</span><span class="token plain"> Platform</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">@rule</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token keyword" style=font-style:italic>async</span><span class="token plain"> </span><span class="token keyword" style=font-style:italic>def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">shellcheck</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Shellcheck</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">></span><span class="token plain"> Foo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    shellcheck </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style=font-style:italic>await</span><span class="token plain"> Get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        DownloadedExternalTool</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        ExternalToolRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        shellcheck</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">get_request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">platform</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    result </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style=font-style:italic>await</span><span class="token plain"> Get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        ProcessResult</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        Process</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">argv</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">shellcheck</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">exe</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> input_digest</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">shellcheck</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">digest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br/></span></code></pre></div></div>
<p>A <code>DownloadedExternalTool</code> object has two fields: <code>digest: Digest</code> and <code>exe: str</code>. Use the <code>.exe</code> field as the first value of a <code>Process</code>'s <code>argv</code>, and use the <code>.digest</code> in the <code>Process's</code> <code>input_digest</code>. If you want to use multiple digests for the input, call <code>Get(Digest, MergeDigests)</code> with the <code>DownloadedExternalTool.digest</code> included.</p>
<h2 class="anchor anchorTargetStickyNavbar_UrHV" id=pex-install-binaries-through-pip><code>Pex</code>: Install binaries through pip<a href=#pex-install-binaries-through-pip class=hash-link aria-label="Direct link to pex-install-binaries-through-pip" title="Direct link to pex-install-binaries-through-pip" translate=no>​</a></h2>
<p>If a tool can be installed via <code>pip</code> - e.g., Pytest or Black - you can install and run it using <code>Pex</code>.</p>
<div class="language-python codeBlockContainer_LrZr theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_QpNL><pre tabindex=0 class="prism-code language-python codeBlock_z5Jo thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_YVRJ><span class=token-line style=color:#bfc7d5><span class="token keyword" style=font-style:italic>from</span><span class="token plain"> pants</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">backend</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">python</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">target_types </span><span class="token keyword" style=font-style:italic>import</span><span class="token plain"> ConsoleScript</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token keyword" style=font-style:italic>from</span><span class="token plain"> pants</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">backend</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">python</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">util_rules</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">interpreter_constraints </span><span class="token keyword" style=font-style:italic>import</span><span class="token plain"> InterpreterConstraints</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token keyword" style=font-style:italic>from</span><span class="token plain"> pants</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">backend</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">python</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">util_rules</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">pex </span><span class="token keyword" style=font-style:italic>import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    Pex</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    PexProcess</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    PexRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    PexRequirements</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token keyword" style=font-style:italic>from</span><span class="token plain"> pants</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">engine</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">process </span><span class="token keyword" style=font-style:italic>import</span><span class="token plain"> FallibleProcessResult</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">@rule</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token keyword" style=font-style:italic>async</span><span class="token plain"> </span><span class="token keyword" style=font-style:italic>def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">></span><span class="token plain"> Foo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    pex </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style=font-style:italic>await</span><span class="token plain"> Get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        Pex</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        PexRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            output_filename</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">"black.pex"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            internal_only</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">True</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            requirements</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">PexRequirements</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">"black==19.10b0"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            interpreter_constraints</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">InterpreterConstraints</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">">=3.6"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            main</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">ConsoleScript</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">"black"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    result </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style=font-style:italic>await</span><span class="token plain"> Get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        FallibleProcessResult</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        PexProcess</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">pex</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> argv</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">"--check"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br/></span></code></pre></div></div>
<p>When defining a <code>PexRequest</code> for a tool, you must give arguments for <code>output_filename</code>, <code>internal_only</code>, <code>requirements</code>, <code>main</code>, and usually <code>interpreter_constraints</code>.</p>
<p>Set <code>internal_only</code> if the PEX is only used as an internal tool, rather than distributed to users (e.g. the <code>package</code> goal). This speeds up performance when building the PEX.</p>
<p>The <code>main</code> argument can be one of:</p>
<ul>
<li class=""><code>ConsoleScript("scriptname")</code>, where <code>scriptname</code> is a <a href=https://packaging.python.org/specifications/entry-points/ target=_blank rel="noopener noreferrer" class="">console_script</a> that the tool installs</li>
<li class=""><code>EntryPoint.parse("module")</code>, which executes the given module</li>
<li class=""><code>EntryPoint.parse("module:func")</code>, which executes the given nullary function in the given module.</li>
</ul>
<p>There are several other optional parameters that may be helpful.</p>
<p>The resulting <code>Pex</code> object has a <code>digest: Digest</code> field containing the built <code>.pex</code> file. This digest should be included in the <code>input_digest</code> to the <code>Process</code> you run.</p>
<p>Instead of the normal <code>Get(ProcessResult, Process)</code>, you should use <code>Get(ProcessResult, PexProcess)</code>, which will set up the environment properly for your Pex to execute. There is a predefined rule to go from <code>PexProcess -> Process</code>, so <code>Get(ProcessResult, PexProcess)</code> will cause the engine to run <code>PexProcess -> Process -> ProcessResult</code>.</p>
<p><code>PexProcess</code> requires arguments for <code>pex: Pex</code>, <code>argv: Iterable[str]</code>, and <code>description: str</code>. It has several optional parameters that mirror the arguments to <code>Process</code>. If you specify <code>input_digest</code>, be careful to first use <code>Get(Digest, MergeDigests)</code> on the <code>pex.digest</code> and any of the other input digests.</p>
<div class="theme-admonition theme-admonition-note admonition_LZeC alert alert--secondary"><div class=admonitionHeading_SJYM><span class=admonitionIcon_iulS><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"/></svg></span>Use <code>PythonToolBase</code> when you need a Subsystem</div><div class=admonitionContent_NJOy><p>Often, you will want to create a <a class="" href=/2.24/docs/writing-plugins/the-rules-api/options-and-subsystems><code>Subsystem</code></a> for your Python tool
to allow users to set options to configure the tool. You can subclass <code>PythonToolBase</code>, which
subclasses <code>Subsystem</code>, to do this:<div class="language-python codeBlockContainer_LrZr theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_QpNL><pre tabindex=0 class="prism-code language-python codeBlock_z5Jo thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_YVRJ><span class=token-line style=color:#bfc7d5><span class="token keyword" style=font-style:italic>from</span><span class="token plain"> pants</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">backend</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">python</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">subsystems</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">python_tool_base </span><span class="token keyword" style=font-style:italic>import</span><span class="token plain"> PythonToolBase</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token keyword" style=font-style:italic>from</span><span class="token plain"> pants</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">backend</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">python</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">target_types </span><span class="token keyword" style=font-style:italic>import</span><span class="token plain"> ConsoleScript</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token keyword" style=font-style:italic>from</span><span class="token plain"> pants</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">option</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">option_types </span><span class="token keyword" style=font-style:italic>import</span><span class="token plain"> StrOption</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token keyword" style=font-style:italic>class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Black</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">PythonToolBase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    options_scope </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"black"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    </span><span class="token builtin" style="color:rgb(130, 170, 255)">help</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"The Black Python code formatter (https://black.readthedocs.io/)."</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    default_main </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ConsoleScript</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">"black"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    register_interpreter_constraints </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">True</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    default_interpreter_constraints </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">"CPython>=3.8,&lt;3.9"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    default_lockfile_resource </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">"pants.backend.python.lint.black"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">"black.lock"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    config </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> StrOption</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        default</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        advanced</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">True</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        </span><span class="token builtin" style="color:rgb(130, 170, 255)">help</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">"Path to Black's pyproject.toml config file"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br/></span></code></pre></div></div><p>You must define the class properties <code>options_scope</code> and <code>default_main</code>, and a
default lockfile at the location referenced by default_lockfile_resource.<p>Then, you can set up your <code>Pex</code> like this:<div class="language-python codeBlockContainer_LrZr theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_QpNL><pre tabindex=0 class="prism-code language-python codeBlock_z5Jo thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_YVRJ><span class=token-line style=color:#bfc7d5><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">@rule</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token keyword" style=font-style:italic>async</span><span class="token plain"> </span><span class="token keyword" style=font-style:italic>def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">black</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Black</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">></span><span class="token plain"> Foo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    pex </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style=font-style:italic>await</span><span class="token plain"> Get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Pex</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> PexRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> black</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">to_pex_request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br/></span></code></pre></div></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_eWnd"><a href=https://github.com/pantsbuild/pants/edit/main/docs/docs/writing-plugins/the-rules-api/installing-tools.mdx target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_HmrO aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>Edit this page</a></div><div class="col lastUpdated_F4iS"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/2.24/docs/writing-plugins/the-rules-api/processes><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>Processes</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/2.24/docs/writing-plugins/the-rules-api/rules-and-the-target-api><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>Rules and the Target API</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_ZBPU thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#binarypaths-find-already-installed-binaries class="table-of-contents__link toc-highlight"><code>BinaryPaths</code>: Find already installed binaries</a><li><a href=#externaltool-install-pre-compiled-binaries class="table-of-contents__link toc-highlight"><code>ExternalTool</code>: Install pre-compiled binaries</a><li><a href=#pex-install-binaries-through-pip class="table-of-contents__link toc-highlight"><code>Pex</code>: Install binaries through pip</a></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Spotlight</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/spotlight/users>Users</a><li class=footer__item><a class=footer__link-item href=/spotlight/testimonials>Testimonials</a><li class=footer__item><a class=footer__link-item href=/spotlight/media>Media</a><li class=footer__item><a class=footer__link-item href=/spotlight/service-providers>Service Providers</a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Connect</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://github.com/pantsbuild/pants target=_blank rel="noopener noreferrer" class=footer__link-item>GitHub<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_QvT7><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://twitter.com/pantsbuild target=_blank rel="noopener noreferrer" class=footer__link-item>Twitter<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_QvT7><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://www.youtube.com/@pantsbuild target=_blank rel="noopener noreferrer" class=footer__link-item>YouTube<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_QvT7><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://groups.google.com/forum/#!forum/pants-devel target=_blank rel="noopener noreferrer" class=footer__link-item>Mailing List<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_QvT7><use href=#theme-svg-external-link /></svg></a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>More</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/blog>Blog</a><li class=footer__item><a class=footer__link-item href=/sponsors>Sponsors</a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Community</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/community/getting-help>Getting Help</a><li class=footer__item><a class=footer__link-item href=/community/members>Members</a><li class=footer__item><a class=footer__link-item href=/community/code-of-conduct>Code of Conduct</a><li class=footer__item><a class=footer__link-item href=/community/meet-the-team>Meet the Team</a><li class=footer__item><a class=footer__link-item href=/community/maintainers>Maintainers</a><li class=footer__item><a class=footer__link-item href=/community/contentious-decisions>Contentious Decisions</a></ul></div></div><div class="footer__bottom text--center"><div class=footer__copyright>Copyright © Pants project contributors. <a href=https://github.com/pantsbuild/pantsbuild.org>Website source</a> @ <a href=https://github.com/pantsbuild/pantsbuild.org/commit/a274212dfdcfe1657dd5eae4836420db8cdf9099>a27421</a>.</div></div></div></footer></div></body>
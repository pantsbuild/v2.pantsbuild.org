"use strict";(self.webpackChunkpantsbuild_org=self.webpackChunkpantsbuild_org||[]).push([["303725"],{930590(e,n,t){t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>i,metadata:()=>o,toc:()=>d});var o=t(630158),s=t(886070),r=t(848193);let i={title:"Setting up an IDE",sidebar_position:9},a,l={},d=[{value:"First-party sources",id:"first-party-sources",level:2},{value:"Third-party dependencies (Python)",id:"third-party-dependencies-python",level:2},{value:"Generated code",id:"generated-code",level:2},{value:"Remote debugging",id:"remote-debugging",level:2},{value:"IDE integrations",id:"ide-integrations",level:2}];function c(e){let n={a:"a",code:"code",h2:"h2",hr:"hr",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.p,{children:"If you use a code-aware editor or IDE, such as PyCharm or VSCode, you may want to set it up to understand your code layout and dependencies. This will allow it to perform code navigation, auto-completion and other features that rely on code comprehension."}),"\n",(0,s.jsx)(n.h2,{id:"first-party-sources",children:"First-party sources"}),"\n",(0,s.jsxs)(n.p,{children:["To get your editor to understand the repo's first-party sources, you will probably need to tell it about the repo's ",(0,s.jsx)(n.a,{href:"/2.9/docs/using-pants/key-concepts/source-roots",children:"source roots"}),". You can list those with:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",metastring:'title="shell"',children:"$ ./pants roots\n"})}),"\n",(0,s.jsx)(n.p,{children:"and then apply the corresponding IDE concept."}),"\n",(0,s.jsxs)(n.p,{children:['For example, in PyCharm you would mark each source root as a "Sources" folder. See ',(0,s.jsx)(n.a,{href:"https://www.jetbrains.com/help/pycharm/configuring-project-structure.html",children:"Configuring Project Structure"})," to learn more."]}),"\n",(0,s.jsxs)(n.p,{children:["In VSCode, the Python extension will look for a file named ",(0,s.jsx)(n.code,{children:".env"})," in the current workspace folder. If the file is found, then it will be loaded and evaluated. This file can be used to set the ",(0,s.jsx)(n.code,{children:"PYTHONPATH"})," variable. Having this file makes it possible to jump to definitions in the source code across multiple projects. It also makes cross-project refactoring possible."]}),"\n",(0,s.jsxs)(n.p,{children:["To generate the ",(0,s.jsx)(n.code,{children:".env"})," file containing all the source roots, you can use something like this:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",metastring:'title="shell"',children:"$ ROOTS=$(./pants roots --roots-sep=' ')\n$ python3 -c \"print('PYTHONPATH=\\\"./' + ':./'.join(\\\"${ROOTS}\\\".split()) + ':\\$PYTHONPATH\\\"')\" > .env\n"})}),"\n",(0,s.jsxs)(n.p,{children:["See ",(0,s.jsx)(n.a,{href:"https://code.visualstudio.com/docs/python/environments#_use-of-the-pythonpath-variable",children:"Use of the PYTHONPATH variable"})," to learn more about using the ",(0,s.jsx)(n.code,{children:"PYTHONPATH"})," variable in VSCode."]}),"\n",(0,s.jsx)(n.h2,{id:"third-party-dependencies-python",children:"Third-party dependencies (Python)"}),"\n",(0,s.jsx)(n.p,{children:"To get your editor to understand the repo's third-party dependencies, you will probably want to point it at a virtualenv containing those dependencies."}),"\n",(0,s.jsxs)(n.p,{children:["You can use the ",(0,s.jsx)(n.code,{children:"export"})," goal to create a suitable virtualenv under ",(0,s.jsx)(n.code,{children:"dist/export/python/virtualenv"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",metastring:'title="Shell"',children:"./pants export ::\n"})}),"\n",(0,s.jsxs)(n.p,{children:["and then point the IDE at the virtualenv. For example, in PyCharm you would select this virtualenv's ",(0,s.jsx)(n.code,{children:"bin/python"})," as the Project SDK."]}),"\n",(0,s.jsxs)(n.p,{children:["Note that this only works if a single consistent global resolve is possible for your repo. If not, you'll have to segment the set of requirements appropriately (e.g. ",(0,s.jsx)(n.code,{children:"./pants export path/to/some/project::"}),"), generate multiple virtualenvs, and set up separate IDE modules for each."]}),"\n",(0,s.jsx)(n.p,{children:"Alternatively, you can export the requirements and build the virtualenv manually using something like:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",metastring:'title="shell"',children:'VENV=/path/to/venv\npython3 -m venv "${VENV}"\n"${VENV}/bin/pip" install -r <(./pants dependencies :: |\n  xargs ./pants filter --target-type=python_requirement |\n  xargs ./pants peek |\n  jq -r \'.[]["requirements"][]\')\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Note that this requires installing the tool ",(0,s.jsx)(n.a,{href:"https://github.com/stedolan/jq",children:(0,s.jsx)(n.code,{children:"jq"})}),".)"]}),"\n",(0,s.jsxs)(n.p,{children:["Again, this only works if a single consistent global resolve is possible for your repo. If not, you'll have to segment the set of requirements appropriately (e.g. ",(0,s.jsx)(n.code,{children:"./pants dependencies --transitive path/to/some/project::"}),"), generate multiple virtualenvs, and set up separate IDE modules for each."]}),"\n",(0,s.jsx)(n.h2,{id:"generated-code",children:"Generated code"}),"\n",(0,s.jsxs)(n.p,{children:["If you're using ",(0,s.jsx)(n.a,{href:"/2.9/docs/python/integrations/protobuf-and-grpc",children:"Protobuf and gRPC"}),", you may want your editor to be able to index and navigate the generated source code."]}),"\n",(0,s.jsxs)(n.p,{children:["Normally Pants treats generated code as an internal byproduct, and doesn't expose it. But you can run the ",(0,s.jsx)(n.code,{children:"export-codegen"})," goal to generate code to a well-known output location for consumption:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",metastring:'title="shell"',children:"$ ./pants export-codegen ::\n"})}),"\n",(0,s.jsxs)(n.p,{children:["The generated code will be written to ",(0,s.jsx)(n.code,{children:"dist/codegen"}),", and you can now add them as sources in the IDE. For example, in PyCharm you would mark ",(0,s.jsx)(n.code,{children:"dist/codegen"}),' as a "Sources" folder.']}),"\n",(0,s.jsx)(n.p,{children:"Warning: you will have to manually rerun this goal when changes are made."}),"\n",(0,s.jsx)(n.h2,{id:"remote-debugging",children:"Remote debugging"}),"\n",(0,s.jsx)(n.p,{children:"You can use PyCharm to debug code running under Pants."}),"\n",(0,s.jsxs)(n.p,{children:["See the following links for instructions on how to do so under the ",(0,s.jsx)(n.a,{href:"/2.9/docs/python/goals/test",children:"test goal"})," and under the ",(0,s.jsx)(n.a,{href:"/2.9/docs/python/goals/run",children:"run goal"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"ide-integrations",children:"IDE integrations"}),"\n",(0,s.jsxs)(n.p,{children:["We have not yet developed tight IDE integrations, such as a PyCharm plugin or a VSCode extension, that would allow the IDE to run Pants on your behalf. If you're interested in developing this functionality for your favorite IDE, ",(0,s.jsx)(n.a,{href:"/community/members",children:"let us know"}),"!"]})]})}function h(e={}){let{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},848193(e,n,t){t.d(n,{R:()=>i,x:()=>a});var o=t(830758);let s={},r=o.createContext(s);function i(e){let n=o.useContext(r);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),o.createElement(r.Provider,{value:n},e.children)}},630158(e){e.exports=JSON.parse('{"id":"docs/using-pants/setting-up-an-ide","title":"Setting up an IDE","description":"---","source":"@site/versioned_docs/version-2.9/docs/using-pants/setting-up-an-ide.mdx","sourceDirName":"docs/using-pants","slug":"/docs/using-pants/setting-up-an-ide","permalink":"/2.9/docs/using-pants/setting-up-an-ide","draft":false,"unlisted":false,"editUrl":"https://github.com/pantsbuild/pants/edit/main/docs/docs/using-pants/setting-up-an-ide.mdx","tags":[],"version":"2.9","sidebarPosition":9,"frontMatter":{"title":"Setting up an IDE","sidebar_position":9},"sidebar":"docsSidebar","previous":{"title":"Remote execution","permalink":"/2.9/docs/using-pants/remote-caching-and-execution/remote-execution"},"next":{"title":"Overview","permalink":"/2.9/docs/python/overview/"}}')}}]);
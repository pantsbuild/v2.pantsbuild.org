"use strict";(self.webpackChunkpantsbuild_org=self.webpackChunkpantsbuild_org||[]).push([["105148"],{224106(e,n,s){s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>_,frontMatter:()=>l,metadata:()=>i,toc:()=>p});var i=s(597905),r=s(886070),t=s(848193),o=s(554707),d=s(375002);let l={title:"python-infer",description:"Options controlling which dependencies will be inferred for Python targets.\n"},c,a={},p=[{value:"Basic options",id:"basic-options",level:2},{value:"<code>assets</code>",id:"assets",level:3},{value:"<code>assets_min_slashes</code>",id:"assets_min_slashes",level:3},{value:"<code>conftests</code>",id:"conftests",level:3},{value:"<code>entry_points</code>",id:"entry_points",level:3},{value:"<code>imports</code>",id:"imports",level:3},{value:"<code>init_files</code>",id:"init_files",level:3},{value:"<code>string_imports</code>",id:"string_imports",level:3},{value:"<code>string_imports_min_dots</code>",id:"string_imports_min_dots",level:3},{value:"<code>unowned_dependency_behavior</code>",id:"unowned_dependency_behavior",level:3},{value:"Advanced options",id:"advanced-options",level:2},{value:"Deprecated options",id:"deprecated-options",level:2},{value:"<code>inits</code>",id:"inits",level:3},{value:"Related subsystems",id:"related-subsystems",level:2}];function h(e){let n={code:"code",h2:"h2",h3:"h3",hr:"hr",p:"p",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.p,{children:"Options controlling which dependencies will be inferred for Python targets."}),"\n",(0,r.jsxs)(n.p,{children:["Backend: ",(0,r.jsx)("span",{className:"color--primary",children:(0,r.jsx)(n.code,{children:"pants.backend.python"})})]}),"\n",(0,r.jsxs)(n.p,{children:["Config section: ",(0,r.jsx)("span",{className:"color--primary",children:(0,r.jsx)(n.code,{children:"[python-infer]"})})]}),"\n",(0,r.jsxs)("span",{className:d.A.options,children:[(0,r.jsx)(n.h2,{id:"basic-options",children:"Basic options"}),(0,r.jsx)(n.h3,{id:"assets",children:(0,r.jsx)(n.code,{children:"assets"})}),(0,r.jsxs)(o.A,{cli_repr:"--[no-]python-infer-assets",env_repr:"PANTS_PYTHON_INFER_ASSETS",toml_repr:`[python-infer]
assets = <bool>`,default_repr:"False",children:[(0,r.jsxs)(n.p,{children:["Infer a target's asset dependencies based on strings that look like Posix filepaths, such as those given to ",(0,r.jsx)(n.code,{children:"open"})," or ",(0,r.jsx)(n.code,{children:"pkgutil.get_data"}),"."]}),(0,r.jsxs)(n.p,{children:["To ignore a false positive, you can either put ",(0,r.jsx)(n.code,{children:"# pants: no-infer-dep"})," on the line of the string or put ",(0,r.jsx)(n.code,{children:"!{bad_address}"})," in the ",(0,r.jsx)(n.code,{children:"dependencies"})," field of your target."]})]}),(0,r.jsx)(n.h3,{id:"assets_min_slashes",children:(0,r.jsx)(n.code,{children:"assets_min_slashes"})}),(0,r.jsx)(o.A,{cli_repr:"--python-infer-assets-min-slashes=<int>",env_repr:"PANTS_PYTHON_INFER_ASSETS_MIN_SLASHES",toml_repr:`[python-infer]
assets_min_slashes = <int>`,default_repr:"1",children:(0,r.jsxs)(n.p,{children:["If --assets is True, treat valid-looking strings with at least this many forward slash characters as potential assets. E.g. ",(0,r.jsx)(n.code,{children:"'data/databases/prod.db'"})," will be treated as a potential candidate if this option is set to 2 but not to 3."]})}),(0,r.jsx)(n.h3,{id:"conftests",children:(0,r.jsx)(n.code,{children:"conftests"})}),(0,r.jsx)(o.A,{cli_repr:"--[no-]python-infer-conftests",env_repr:"PANTS_PYTHON_INFER_CONFTESTS",toml_repr:`[python-infer]
conftests = <bool>`,default_repr:"True",children:(0,r.jsx)(n.p,{children:"Infer a test target's dependencies on any conftest.py files in the current directory and ancestor directories."})}),(0,r.jsx)(n.h3,{id:"entry_points",children:(0,r.jsx)(n.code,{children:"entry_points"})}),(0,r.jsx)(o.A,{cli_repr:"--[no-]python-infer-entry-points",env_repr:"PANTS_PYTHON_INFER_ENTRY_POINTS",toml_repr:`[python-infer]
entry_points = <bool>`,default_repr:"True",children:(0,r.jsxs)(n.p,{children:["Infer dependencies on targets' entry points, e.g. ",(0,r.jsx)(n.code,{children:"pex_binary"}),"'s ",(0,r.jsx)(n.code,{children:"entry_point"})," field, ",(0,r.jsx)(n.code,{children:"python_awslambda"}),"'s ",(0,r.jsx)(n.code,{children:"handler"})," field and ",(0,r.jsx)(n.code,{children:"python_distribution"}),"'s ",(0,r.jsx)(n.code,{children:"entry_points"})," field."]})}),(0,r.jsx)(n.h3,{id:"imports",children:(0,r.jsx)(n.code,{children:"imports"})}),(0,r.jsxs)(o.A,{cli_repr:"--[no-]python-infer-imports",env_repr:"PANTS_PYTHON_INFER_IMPORTS",toml_repr:`[python-infer]
imports = <bool>`,default_repr:"True",children:[(0,r.jsx)(n.p,{children:"Infer a target's imported dependencies by parsing import statements from sources."}),(0,r.jsxs)(n.p,{children:["To ignore a false positive, you can either put ",(0,r.jsx)(n.code,{children:"# pants: no-infer-dep"})," on the line of the import or put ",(0,r.jsx)(n.code,{children:"!{bad_address}"})," in the ",(0,r.jsx)(n.code,{children:"dependencies"})," field of your target."]})]}),(0,r.jsx)(n.h3,{id:"init_files",children:(0,r.jsx)(n.code,{children:"init_files"})}),(0,r.jsxs)(o.A,{cli_repr:"--python-infer-init-files=<InitFilesInference>",env_repr:"PANTS_PYTHON_INFER_INIT_FILES",toml_repr:`[python-infer]
init_files = <InitFilesInference>`,one_of:"always, content_only, never",default_repr:"content_only",children:[(0,r.jsxs)(n.p,{children:["Infer a target's dependencies on any ",(0,r.jsx)(n.code,{children:"__init__.py"})," files in the packages it is located in (recursively upward in the directory structure)."]}),(0,r.jsxs)(n.p,{children:["Even if this is set to ",(0,r.jsx)(n.code,{children:"never"})," or ",(0,r.jsx)(n.code,{children:"content_only"}),", Pants will still always include any ancestor ",(0,r.jsx)(n.code,{children:"__init__.py"}),' files in the sandbox. Only, they will not be "proper" dependencies, e.g. they will not show up in ',(0,r.jsx)(n.code,{children:"/home/josh/work/scie-pants/dist/pants dependencies"})," and their own dependencies will not be used."]}),(0,r.jsxs)(n.p,{children:['By default, Pants only adds a "proper" dependency if there is content in the ',(0,r.jsx)(n.code,{children:"__init__.py"})," file. This makes sure that dependencies are added when likely necessary to build, while also avoiding adding unnecessary dependencies. While accurate, those unnecessary dependencies can complicate setting metadata like the ",(0,r.jsx)(n.code,{children:"interpreter_constraints"})," and ",(0,r.jsx)(n.code,{children:"resolve"})," fields."]})]}),(0,r.jsx)(n.h3,{id:"string_imports",children:(0,r.jsx)(n.code,{children:"string_imports"})}),(0,r.jsxs)(o.A,{cli_repr:"--[no-]python-infer-string-imports",env_repr:"PANTS_PYTHON_INFER_STRING_IMPORTS",toml_repr:`[python-infer]
string_imports = <bool>`,default_repr:"False",children:[(0,r.jsx)(n.p,{children:"Infer a target's dependencies based on strings that look like dynamic dependencies, such as Django settings files expressing dependencies as strings."}),(0,r.jsxs)(n.p,{children:["To ignore a false positive, you can either put ",(0,r.jsx)(n.code,{children:"# pants: no-infer-dep"})," on the line of the string or put ",(0,r.jsx)(n.code,{children:"!{bad_address}"})," in the ",(0,r.jsx)(n.code,{children:"dependencies"})," field of your target."]})]}),(0,r.jsx)(n.h3,{id:"string_imports_min_dots",children:(0,r.jsx)(n.code,{children:"string_imports_min_dots"})}),(0,r.jsx)(o.A,{cli_repr:"--python-infer-string-imports-min-dots=<int>",env_repr:"PANTS_PYTHON_INFER_STRING_IMPORTS_MIN_DOTS",toml_repr:`[python-infer]
string_imports_min_dots = <int>`,default_repr:"2",children:(0,r.jsxs)(n.p,{children:["If --string-imports is True, treat valid-looking strings with at least this many dots in them as potential dynamic dependencies. E.g., ",(0,r.jsx)(n.code,{children:"'foo.bar.Baz'"})," will be treated as a potential dependency if this option is set to 2 but not if set to 3."]})}),(0,r.jsx)(n.h3,{id:"unowned_dependency_behavior",children:(0,r.jsx)(n.code,{children:"unowned_dependency_behavior"})}),(0,r.jsxs)(o.A,{cli_repr:"--python-infer-unowned-dependency-behavior=<UnownedDependencyUsage>",env_repr:"PANTS_PYTHON_INFER_UNOWNED_DEPENDENCY_BEHAVIOR",toml_repr:`[python-infer]
unowned_dependency_behavior = <UnownedDependencyUsage>`,one_of:"error, warning, ignore",default_repr:"ignore",children:[(0,r.jsx)(n.p,{children:"How to handle imports that don't have an inferrable owner."}),(0,r.jsxs)(n.p,{children:["Usually when an import cannot be inferred, it represents an issue like Pants not being properly configured, e.g. targets not set up. Often, missing dependencies will result in confusing runtime errors like ",(0,r.jsx)(n.code,{children:"ModuleNotFoundError"}),", so this option can be helpful to error more eagerly."]}),(0,r.jsxs)(n.p,{children:["To ignore any false positives, either add ",(0,r.jsx)(n.code,{children:"# pants: no-infer-dep"})," to the line of the import or put the import inside a ",(0,r.jsx)(n.code,{children:"try: except ImportError:"})," block."]})]}),(0,r.jsx)(n.h2,{id:"advanced-options",children:"Advanced options"}),(0,r.jsx)(n.p,{children:"None"}),(0,r.jsx)(n.h2,{id:"deprecated-options",children:"Deprecated options"}),(0,r.jsx)(n.h3,{id:"inits",children:(0,r.jsx)(n.code,{children:"inits"})}),(0,r.jsxs)(o.A,{cli_repr:"--[no-]python-infer-inits",env_repr:"PANTS_PYTHON_INFER_INITS",toml_repr:`[python-infer]
inits = <bool>`,default_repr:"False",removal_version:"2.14.0.dev1",removal_hint:"Use the more powerful option `[python-infer].init_files`. For identical behavior, set to 'always'. Otherwise, we recommend the default of `content_only` (simply delete the option `[python-infer].inits` to trigger the default).",children:[(0,r.jsxs)(n.p,{children:["Infer a target's dependencies on any ",(0,r.jsx)(n.code,{children:"__init__.py"})," files in the packages it is located in (recursively upward in the directory structure)."]}),(0,r.jsxs)(n.p,{children:["Even if this is disabled, Pants will still include any ancestor ",(0,r.jsx)(n.code,{children:"__init__.py"})," files, only they will not be 'proper' dependencies, e.g. they will not show up in ",(0,r.jsx)(n.code,{children:"/home/josh/work/scie-pants/dist/pants dependencies"})," and their own dependencies will not be used."]}),(0,r.jsxs)(n.p,{children:["If you have empty ",(0,r.jsx)(n.code,{children:"__init__.py"})," files, it's safe to leave this option off; otherwise, you should enable this option."]})]}),(0,r.jsx)(n.h2,{id:"related-subsystems",children:"Related subsystems"}),(0,r.jsx)(n.p,{children:"None"})]})]})}function _(e={}){let{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},375002(e,n,s){s.d(n,{A:()=>i});let i={options:"options_nrbo"}},554707(e,n,s){s.d(n,{A:()=>o});var i=s(886070),r=s(384122),t=s(580830);function o({children:e,cli_repr:n,env_repr:s,toml_repr:o,one_of:d,default_repr:l,target_field_name:c,removal_version:a,removal_hint:p}){return(0,i.jsxs)("div",{className:"margin-bottom--lg",children:[(0,i.jsx)("code",{style:{color:"var(--pants-reference-option-repr)"},children:n}),(0,i.jsx)("br",{}),(0,i.jsx)("code",{style:{color:"var(--pants-reference-option-repr)"},children:s}),(0,i.jsx)("br",{}),(0,i.jsx)(r.A,{language:"toml",title:"pants.toml",children:o}),(0,i.jsxs)("div",{style:{paddingLeft:"2em"},children:[(0,i.jsxs)("span",{children:[d&&(0,i.jsxs)("span",{children:["one of:"," ",(0,i.jsx)("code",{style:{color:"var(--ifm-color-success)"},children:d}),(0,i.jsx)("br",{})]}),"default:"," ",(0,i.jsx)("span",{style:{color:"var(--ifm-color-success)"},children:(l||"").includes("\n")?(0,i.jsx)("pre",{className:"padding--sm",children:l}):(0,i.jsx)("code",{children:l})})]}),(0,i.jsx)("br",{}),a&&(0,i.jsxs)("span",{style:{color:"var(--ifm-color-danger-darkest)"},children:["Deprecated, will be removed in version: ",a,".",(0,i.jsx)("br",{}),p,(0,i.jsx)("br",{})]}),e,c&&(0,i.jsxs)("span",{children:["Can be overriden by field",(0,i.jsx)("code",{children:c})," on"," ",(0,i.jsx)(t.A,{to:"../targets/local_environment",children:(0,i.jsx)("code",{children:"local_environment"})}),","," ",(0,i.jsx)(t.A,{to:"../targets/docker_environment",children:(0,i.jsx)("code",{children:"docker_environment"})}),", or"," ",(0,i.jsx)(t.A,{to:"../targets/remote_environment",children:(0,i.jsx)("code",{children:"remote_environment"})}),"targets."]})]})]})}},597905(e){e.exports=JSON.parse('{"id":"reference/subsystems/python-infer","title":"python-infer","description":"Options controlling which dependencies will be inferred for Python targets.\\n","source":"@site/versioned_docs/version-2.13/reference/subsystems/python-infer.mdx","sourceDirName":"reference/subsystems","slug":"/reference/subsystems/python-infer","permalink":"/2.13/reference/subsystems/python-infer","draft":false,"unlisted":false,"tags":[],"version":"2.13","frontMatter":{"title":"python-infer","description":"Options controlling which dependencies will be inferred for Python targets.\\n"},"sidebar":"referenceSidebar","previous":{"title":"python-bootstrap","permalink":"/2.13/reference/subsystems/python-bootstrap"},"next":{"title":"python-native-code","permalink":"/2.13/reference/subsystems/python-native-code"}}')}}]);
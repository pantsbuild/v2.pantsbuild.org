"use strict";(self.webpackChunkpantsbuild_org=self.webpackChunkpantsbuild_org||[]).push([["947086"],{810862(e,r,s){s.r(r),s.d(r,{assets:()=>p,contentTitle:()=>c,default:()=>u,frontMatter:()=>a,metadata:()=>t,toc:()=>d});var t=s(471926),n=s(886070),i=s(848193),o=s(554707),l=s(375002);let a={title:"python-setup",description:"Options for Pants&#x27;s Python support.\n"},c,p={},d=[{value:"Basic options",id:"basic-options",level:2},{value:"Advanced options",id:"advanced-options",level:2},{value:"<code>experimental_lockfile</code>",id:"experimental_lockfile",level:3},{value:"<code>interpreter_constraints</code>",id:"interpreter_constraints",level:3},{value:"<code>interpreter_search_paths</code>",id:"interpreter_search_paths",level:3},{value:"<code>interpreter_versions_universe</code>",id:"interpreter_versions_universe",level:3},{value:"<code>invalid_lockfile_behavior</code>",id:"invalid_lockfile_behavior",level:3},{value:"<code>requirement_constraints</code>",id:"requirement_constraints",level:3},{value:"<code>resolve_all_constraints</code>",id:"resolve_all_constraints",level:3},{value:"<code>resolver_jobs</code>",id:"resolver_jobs",level:3},{value:"<code>resolver_manylinux</code>",id:"resolver_manylinux",level:3},{value:"<code>tailor_ignore_solitary_init_files</code>",id:"tailor_ignore_solitary_init_files",level:3},{value:"<code>tailor_pex_binary_targets</code>",id:"tailor_pex_binary_targets",level:3},{value:"Deprecated options",id:"deprecated-options",level:2},{value:"Related subsystems",id:"related-subsystems",level:2}];function h(e){let r={a:"a",code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.hr,{}),"\n",(0,n.jsx)(r.p,{children:"Options for Pants's Python support."}),"\n",(0,n.jsxs)(r.p,{children:["Backend: ",(0,n.jsx)("span",{className:"color--primary",children:"``"})]}),"\n",(0,n.jsxs)(r.p,{children:["Config section: ",(0,n.jsx)("span",{className:"color--primary",children:(0,n.jsx)(r.code,{children:"[python-setup]"})})]}),"\n",(0,n.jsxs)("span",{className:l.A.options,children:[(0,n.jsx)(r.h2,{id:"basic-options",children:"Basic options"}),(0,n.jsx)(r.p,{children:"None"}),(0,n.jsx)(r.h2,{id:"advanced-options",children:"Advanced options"}),(0,n.jsx)(r.h3,{id:"experimental_lockfile",children:(0,n.jsx)(r.code,{children:"experimental_lockfile"})}),(0,n.jsxs)(o.A,{cli_repr:"--python-setup-experimental-lockfile=<file>",env_repr:"PANTS_PYTHON_SETUP_EXPERIMENTAL_LOCKFILE",toml_repr:`[python-setup]
experimental_lockfile = <file>`,default_repr:"None",children:[(0,n.jsx)(r.p,{children:"The lockfile to use when resolving requirements for your own code (vs. tools you run)."}),(0,n.jsx)(r.p,{children:"This is highly experimental and will change, including adding support for multiple lockfiles. This option's behavior may change without the normal deprecation cycle."}),(0,n.jsxs)(r.p,{children:["To generate a lockfile, activate the backend ",(0,n.jsx)(r.code,{children:"pants.backend.experimental.python"}),"and run ",(0,n.jsx)(r.code,{children:"./pants generate-user-lockfile ::"}),"."]}),(0,n.jsxs)(r.p,{children:["Mutually exclusive with ",(0,n.jsx)(r.code,{children:"[python-setup].requirement_constraints"}),"."]})]}),(0,n.jsx)(r.h3,{id:"interpreter_constraints",children:(0,n.jsx)(r.code,{children:"interpreter_constraints"})}),(0,n.jsxs)(o.A,{cli_repr:'--python-setup-interpreter-constraints="[<requirement>, <requirement>, ...]"',env_repr:"PANTS_PYTHON_SETUP_INTERPRETER_CONSTRAINTS",toml_repr:`[python-setup]
interpreter_constraints = [
  <requirement>,
  <requirement>,
  ...,
]`,default_repr:`[
  "CPython>=3.6,<4"
]`,children:[(0,n.jsx)(r.p,{children:"The Python interpreters your codebase is compatible with."}),(0,n.jsx)(r.p,{children:"Specify with requirement syntax, e.g. 'CPython>=2.7,<3' (A CPython interpreter with version >=2.7 AND version <3) or 'PyPy' (A pypy interpreter of any version). Multiple constraint strings will be ORed together."}),(0,n.jsxs)(r.p,{children:["These constraints are used as the default value for the ",(0,n.jsx)(r.code,{children:"interpreter_constraints"})," field of Python targets."]})]}),(0,n.jsx)(r.h3,{id:"interpreter_search_paths",children:(0,n.jsx)(r.code,{children:"interpreter_search_paths"})}),(0,n.jsxs)(o.A,{cli_repr:'--python-setup-interpreter-search-paths="[<binary-paths>, <binary-paths>, ...]"',env_repr:"PANTS_PYTHON_SETUP_INTERPRETER_SEARCH_PATHS",toml_repr:`[python-setup]
interpreter_search_paths = [
  <binary-paths>,
  <binary-paths>,
  ...,
]`,default_repr:`[
  "<PYENV>",
  "<PATH>"
]`,children:[(0,n.jsx)(r.p,{children:"A list of paths to search for Python interpreters that match your project's interpreter constraints. You can specify absolute paths to interpreter binaries and/or to directories containing interpreter binaries. The order of entries does not matter. The following special strings are supported:"}),(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:'"<PATH>", the contents of the PATH env var'}),"\n",(0,n.jsx)(r.li,{children:'"<ASDF>", all Python versions currently configured by ASDF (asdf shell, ${HOME}/.tool-versions), with a fallback to all installed versions'}),"\n",(0,n.jsx)(r.li,{children:'"<ASDF_LOCAL>", the ASDF interpreter with the version in BUILD_ROOT/.tool-versions'}),"\n",(0,n.jsx)(r.li,{children:'"<PYENV>", all Python versions under $(pyenv root)/versions'}),"\n",(0,n.jsx)(r.li,{children:'"<PYENV_LOCAL>", the Pyenv interpreter with the version in BUILD_ROOT/.python-version'}),"\n",(0,n.jsx)(r.li,{children:'"<PEXRC>", paths in the PEX_PYTHON_PATH variable in /etc/pexrc or ~/.pexrc'}),"\n"]})]}),(0,n.jsx)(r.h3,{id:"interpreter_versions_universe",children:(0,n.jsx)(r.code,{children:"interpreter_versions_universe"})}),(0,n.jsxs)(o.A,{cli_repr:"--python-setup-interpreter-versions-universe=\"['<str>', '<str>', ...]\"",env_repr:"PANTS_PYTHON_SETUP_INTERPRETER_VERSIONS_UNIVERSE",toml_repr:`[python-setup]
interpreter_versions_universe = [
  '<str>',
  '<str>',
  ...,
]`,default_repr:`[
  "2.7",
  "3.5",
  "3.6",
  "3.7",
  "3.8",
  "3.9",
  "3.10"
]`,children:[(0,n.jsx)(r.p,{children:"All known Python major/minor interpreter versions that may be used by either your code or tools used by your code."}),(0,n.jsx)(r.p,{children:"This is used by Pants to robustly handle interpreter constraints, such as knowing when generating lockfiles which Python versions to check if your code is using."}),(0,n.jsxs)(r.p,{children:["This does not control which interpreter your code will use. Instead, to set your interpreter constraints, update ",(0,n.jsx)(r.code,{children:"[python-setup].interpreter_constraints"}),", the ",(0,n.jsx)(r.code,{children:"interpreter_constraints"})," field, and relevant tool options like ",(0,n.jsx)(r.code,{children:"[isort].interpreter_constraints"})," to tell Pants which interpreters your code actually uses. See ",(0,n.jsx)(r.a,{href:"https://www.pantsbuild.org/v2.7/docs/python-interpreter-compatibility",children:"https://www.pantsbuild.org/v2.7/docs/python-interpreter-compatibility"}),"."]}),(0,n.jsx)(r.p,{children:"All elements must be the minor and major Python version, e.g. '2.7' or '3.10'. Do not include the patch version."})]}),(0,n.jsx)(r.h3,{id:"invalid_lockfile_behavior",children:(0,n.jsx)(r.code,{children:"invalid_lockfile_behavior"})}),(0,n.jsxs)(o.A,{cli_repr:"--python-setup-invalid-lockfile-behavior=<InvalidLockfileBehavior>",env_repr:"PANTS_PYTHON_SETUP_INVALID_LOCKFILE_BEHAVIOR",toml_repr:`[python-setup]
invalid_lockfile_behavior = <InvalidLockfileBehavior>`,one_of:"error, ignore, warn",default_repr:"error",children:[(0,n.jsx)(r.p,{children:"The behavior when a lockfile has requirements or interpreter constraints that are not compatible with what the current build is using."}),(0,n.jsxs)(r.p,{children:["We recommend keeping the default of ",(0,n.jsx)(r.code,{children:"error"})," for CI builds."]})]}),(0,n.jsx)(r.h3,{id:"requirement_constraints",children:(0,n.jsx)(r.code,{children:"requirement_constraints"})}),(0,n.jsxs)(o.A,{cli_repr:"--python-setup-requirement-constraints=<file_option>",env_repr:"PANTS_PYTHON_SETUP_REQUIREMENT_CONSTRAINTS",toml_repr:`[python-setup]
requirement_constraints = <file_option>`,default_repr:"None",children:[(0,n.jsx)(r.p,{children:"When resolving third-party requirements for your own code (vs. tools you run), use this constraints file to determine which versions to use."}),(0,n.jsxs)(r.p,{children:["This only applies when resolving user requirements, rather than tools you run like Black and Pytest. To constrain tools, set ",(0,n.jsx)(r.code,{children:"[tool].lockfile"}),", e.g. ",(0,n.jsx)(r.code,{children:"[black].lockfile"}),"."]}),(0,n.jsxs)(r.p,{children:["See ",(0,n.jsx)(r.a,{href:"https://pip.pypa.io/en/stable/user_guide/#constraints-files",children:"https://pip.pypa.io/en/stable/user_guide/#constraints-files"})," for more information on the format of constraint files and how constraints are applied in Pex and pip."]}),(0,n.jsxs)(r.p,{children:["Mutually exclusive with ",(0,n.jsx)(r.code,{children:"[python-setup].experimental_lockfile"}),"."]})]}),(0,n.jsx)(r.h3,{id:"resolve_all_constraints",children:(0,n.jsx)(r.code,{children:"resolve_all_constraints"})}),(0,n.jsxs)(o.A,{cli_repr:"--[no-]python-setup-resolve-all-constraints",env_repr:"PANTS_PYTHON_SETUP_RESOLVE_ALL_CONSTRAINTS",toml_repr:`[python-setup]
resolve_all_constraints = <bool>`,default_repr:"True",children:[(0,n.jsx)(r.p,{children:"If enabled, when resolving requirements, Pants will first resolve your entire constraints file as a single global resolve. Then, if the code uses a subset of your constraints file, Pants will extract the relevant requirements from that global resolve so that only what's actually needed gets used. If disabled, Pants will not use a global resolve and will resolve each subset of your requirements independently."}),(0,n.jsx)(r.p,{children:"Usually this option should be enabled because it can result in far fewer resolves."}),(0,n.jsx)(r.p,{children:"Requires [python-setup].requirement_constraints to be set."})]}),(0,n.jsx)(r.h3,{id:"resolver_jobs",children:(0,n.jsx)(r.code,{children:"resolver_jobs"})}),(0,n.jsxs)(o.A,{cli_repr:"--python-setup-resolver-jobs=<int>",env_repr:"PANTS_PYTHON_SETUP_RESOLVER_JOBS",toml_repr:`[python-setup]
resolver_jobs = <int>`,default_repr:"#cores/2",children:[(0,n.jsx)(r.p,{children:"The maximum number of concurrent jobs to build wheels with."}),(0,n.jsxs)(r.p,{children:["Because Pants can run multiple subprocesses in parallel, the maximum total parallelism will be ",(0,n.jsx)(r.code,{children:"--process-execution-{local,remote}-parallelism x --python-setup-resolver-jobs"}),"."]}),(0,n.jsx)(r.p,{children:"Setting this option higher may result in better parallelism, but, if set too high, may result in starvation and Out of Memory errors."})]}),(0,n.jsx)(r.h3,{id:"resolver_manylinux",children:(0,n.jsx)(r.code,{children:"resolver_manylinux"})}),(0,n.jsx)(o.A,{cli_repr:"--python-setup-resolver-manylinux=<str>",env_repr:"PANTS_PYTHON_SETUP_RESOLVER_MANYLINUX",toml_repr:`[python-setup]
resolver_manylinux = <str>`,default_repr:"manylinux2014",children:(0,n.jsx)(r.p,{children:"Whether to allow resolution of manylinux wheels when resolving requirements for foreign linux platforms. The value should be a manylinux platform upper bound, e.g.: 'manylinux2010', or else the string 'no' to disallow."})}),(0,n.jsx)(r.h3,{id:"tailor_ignore_solitary_init_files",children:(0,n.jsx)(r.code,{children:"tailor_ignore_solitary_init_files"})}),(0,n.jsxs)(o.A,{cli_repr:"--[no-]python-setup-tailor-ignore-solitary-init-files",env_repr:"PANTS_PYTHON_SETUP_TAILOR_IGNORE_SOLITARY_INIT_FILES",toml_repr:`[python-setup]
tailor_ignore_solitary_init_files = <bool>`,default_repr:"True",children:[(0,n.jsxs)(r.p,{children:["Don't tailor python_library targets for solitary ",(0,n.jsx)(r.strong,{children:"init"}),".py files, as those usually exist as import scaffolding rather than true library code."]}),(0,n.jsxs)(r.p,{children:["Set to False if you commonly have packages containing real code in ",(0,n.jsx)(r.strong,{children:"init"}),".py and there are no other .py files in the package."]})]}),(0,n.jsx)(r.h3,{id:"tailor_pex_binary_targets",children:(0,n.jsx)(r.code,{children:"tailor_pex_binary_targets"})}),(0,n.jsx)(o.A,{cli_repr:"--[no-]python-setup-tailor-pex-binary-targets",env_repr:"PANTS_PYTHON_SETUP_TAILOR_PEX_BINARY_TARGETS",toml_repr:`[python-setup]
tailor_pex_binary_targets = <bool>`,default_repr:"True",children:(0,n.jsx)(r.p,{children:"Tailor pex_binary() targets for Python entry point files."})}),(0,n.jsx)(r.h2,{id:"deprecated-options",children:"Deprecated options"}),(0,n.jsx)(r.p,{children:"None"}),(0,n.jsx)(r.h2,{id:"related-subsystems",children:"Related subsystems"}),(0,n.jsx)(r.p,{children:"None"})]})]})}function u(e={}){let{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(h,{...e})}):h(e)}},375002(e,r,s){s.d(r,{A:()=>t});let t={options:"options_nrbo"}},554707(e,r,s){s.d(r,{A:()=>o});var t=s(886070),n=s(384122),i=s(580830);function o({children:e,cli_repr:r,env_repr:s,toml_repr:o,one_of:l,default_repr:a,target_field_name:c,removal_version:p,removal_hint:d}){return(0,t.jsxs)("div",{className:"margin-bottom--lg",children:[(0,t.jsx)("code",{style:{color:"var(--pants-reference-option-repr)"},children:r}),(0,t.jsx)("br",{}),(0,t.jsx)("code",{style:{color:"var(--pants-reference-option-repr)"},children:s}),(0,t.jsx)("br",{}),(0,t.jsx)(n.A,{language:"toml",title:"pants.toml",children:o}),(0,t.jsxs)("div",{style:{paddingLeft:"2em"},children:[(0,t.jsxs)("span",{children:[l&&(0,t.jsxs)("span",{children:["one of:"," ",(0,t.jsx)("code",{style:{color:"var(--ifm-color-success)"},children:l}),(0,t.jsx)("br",{})]}),"default:"," ",(0,t.jsx)("span",{style:{color:"var(--ifm-color-success)"},children:(a||"").includes("\n")?(0,t.jsx)("pre",{className:"padding--sm",children:a}):(0,t.jsx)("code",{children:a})})]}),(0,t.jsx)("br",{}),p&&(0,t.jsxs)("span",{style:{color:"var(--ifm-color-danger-darkest)"},children:["Deprecated, will be removed in version: ",p,".",(0,t.jsx)("br",{}),d,(0,t.jsx)("br",{})]}),e,c&&(0,t.jsxs)("span",{children:["Can be overriden by field",(0,t.jsx)("code",{children:c})," on"," ",(0,t.jsx)(i.A,{to:"../targets/local_environment",children:(0,t.jsx)("code",{children:"local_environment"})}),","," ",(0,t.jsx)(i.A,{to:"../targets/docker_environment",children:(0,t.jsx)("code",{children:"docker_environment"})}),", or"," ",(0,t.jsx)(i.A,{to:"../targets/remote_environment",children:(0,t.jsx)("code",{children:"remote_environment"})}),"targets."]})]})]})}},471926(e){e.exports=JSON.parse('{"id":"reference/subsystems/python-setup","title":"python-setup","description":"Options for Pants&#x27;s Python support.\\n","source":"@site/versioned_docs/version-2.7/reference/subsystems/python-setup.mdx","sourceDirName":"reference/subsystems","slug":"/reference/subsystems/python-setup","permalink":"/2.7/reference/subsystems/python-setup","draft":false,"unlisted":false,"tags":[],"version":"2.7","frontMatter":{"title":"python-setup","description":"Options for Pants&#x27;s Python support.\\n"},"sidebar":"referenceSidebar","previous":{"title":"python-repos","permalink":"/2.7/reference/subsystems/python-repos"},"next":{"title":"scc","permalink":"/2.7/reference/subsystems/scc"}}')}}]);
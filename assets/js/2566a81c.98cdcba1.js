"use strict";(self.webpackChunkpantsbuild_org=self.webpackChunkpantsbuild_org||[]).push([["179380"],{647571(e,n,t){t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>u,frontMatter:()=>a,metadata:()=>s,toc:()=>h});var s=t(384580),r=t(886070),i=t(848193),o=t(685008),l=t(637180);let a={title:"Third-party dependencies",sidebar_position:1},d,c={},h=[{value:"Teaching Pants your &quot;universe&quot;(s) of dependencies",id:"teaching-pants-your-universes-of-dependencies",level:2},{value:"<code>requirements.txt</code>",id:"requirementstxt",level:3},{value:"Poetry",id:"poetry",level:3},{value:"How dependencies are chosen",id:"how-dependencies-are-chosen",level:2},{value:"Use <code>modules</code> and <code>module_mapping</code> when the module name is not standard",id:"use-modules-and-module_mapping-when-the-module-name-is-not-standard",level:3},{value:"Warning: multiple versions of the same dependency",id:"warning-multiple-versions-of-the-same-dependency",level:3},{value:"Lockfiles",id:"lockfiles",level:2},{value:"User lockfiles",id:"user-lockfiles",level:3},{value:"Multiple lockfiles",id:"multiple-lockfiles",level:4},{value:"Tool lockfiles",id:"tool-lockfiles",level:3},{value:"Pex vs. Poetry for lockfile generation",id:"pex-vs-poetry-for-lockfile-generation",level:3},{value:"Poetry issue with environment markers",id:"poetry-issue-with-environment-markers",level:4},{value:"Advanced usage",id:"advanced-usage",level:2},{value:"Requirements with undeclared dependencies",id:"requirements-with-undeclared-dependencies",level:3},{value:"Version control and local requirements",id:"version-control-and-local-requirements",level:3},{value:"Custom repositories",id:"custom-repositories",level:3},{value:"Simple repositories as defined by PEP 503",id:"simple-repositories-as-defined-by-pep-503",level:4},{value:"A Pip findlinks repository",id:"a-pip-findlinks-repository",level:4},{value:"Authenticating to custom repos",id:"authenticating-to-custom-repos",level:4},{value:"Tip: use <code>./pants export</code> to create a virtual environment for IDEs",id:"tip-use-pants-export-to-create-a-virtual-environment-for-ides",level:2}];function p(e){let n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"How to use third-party Python libraries in your project."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.p,{children:["Pants handles dependencies with more precision than traditional Python workflows. Traditionally, you have a single heavyweight ",(0,r.jsx)(n.a,{href:"https://docs.python.org/3/tutorial/venv.html",children:"virtual environment"})," that includes a large set of dependencies, whether or not you actually need them for your current task."]}),"\n",(0,r.jsx)(n.p,{children:"Instead, Pants understands exactly which dependencies every file in your project needs, and efficiently uses just that subset of dependencies needed for the task."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"\u276F ./pants dependencies src/py/util.py\n3rdparty/py#requests\n\n\u276F ./pants dependencies --transitive src/py/app.py\n3rdparty/py#flask\n3rdparty/py#requests\n"})}),"\n",(0,r.jsx)(n.p,{children:"Among other benefits, this precise and automatic understanding of your dependencies gives you fine-grained caching. This means, for example, that if none of the dependencies for a particular test file have changed, the cached result can be safely used."}),"\n",(0,r.jsx)(n.h2,{id:"teaching-pants-your-universes-of-dependencies",children:'Teaching Pants your "universe"(s) of dependencies'}),"\n",(0,r.jsx)(n.p,{children:'For Pants to know which dependencies each file uses, it must first know which specific dependencies are in your "universe", i.e. all the third-party dependencies your project directly uses.'}),"\n",(0,r.jsx)(n.p,{children:'By default, Pants uses a single universe for your whole project, but it\'s possible to set up multiple. See the header "Multiple resolves" in the "Lockfiles" section.'}),"\n",(0,r.jsxs)(n.p,{children:["Each third-party dependency you directly use is modeled by a ",(0,r.jsx)(n.code,{children:"python_requirement"})," target:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",metastring:'title="BUILD"',children:'python_requirement(\n    name="django",\n    requirements=["Django==3.2.1"],\n)\n'})}),"\n",(0,r.jsxs)(n.p,{children:["You do not need a ",(0,r.jsx)(n.code,{children:"python_requirement"})," target for transitive dependencies, i.e. requirements that you do not directly import."]}),"\n",(0,r.jsxs)(n.p,{children:["To minimize boilerplate, Pants has target generators to generate ",(0,r.jsx)(n.code,{children:"python_requirement"})," targets for you:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"python_requirements"})," for ",(0,r.jsx)(n.code,{children:"requirements.txt"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"poetry_requirements"})," for Poetry projects."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"requirementstxt",children:(0,r.jsx)(n.code,{children:"requirements.txt"})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"python_requirements()"})," target generator parses a ",(0,r.jsxs)(n.a,{href:"https://pip.pypa.io/en/stable/user_guide/#requirements-files",children:[(0,r.jsx)(n.code,{children:"requirements.txt"}),"-style file"]})," to produce a ",(0,r.jsx)(n.code,{children:"python_requirement"})," target for each entry."]}),"\n",(0,r.jsx)(n.p,{children:"For example:"}),"\n",(0,r.jsxs)(o.A,{groupId:"code-examples",children:[(0,r.jsx)(l.A,{value:"requirements.txt",label:"requirements.txt",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",metastring:'tab={"label":"requirements.txt"}',children:"flask>=1.1.2,<1.3\nrequests[security]==2.23.0\ndataclasses ; python_version<'3.7'\n"})})}),(0,r.jsx)(l.A,{value:"build",label:"BUILD",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",metastring:'tab={"label":"BUILD"}',children:'# This will generate three targets:\n#\n#  - //:reqs#flask\n#  - //:reqs#requests\n#  - //:reqs#dataclasses\npython_requirements(name="reqs")\n\n# The above target generator is spiritually equivalent to this:\npython_requirement(\n    name="flask",\n    requirements=["flask>=1.1.2,<1.3"],\n)\npython_requirement(\n    name="requests",\n    requirements=["requests[security]==2.23.0"],\n)\npython_requirement(\n    name="dataclasses",\n    requirements=["dataclasses ; python_version<\'3.7\'"],\n)\n'})})})]}),"\n",(0,r.jsxs)(n.p,{children:["If the file uses a different name than ",(0,r.jsx)(n.code,{children:"requirements.txt"}),", set ",(0,r.jsx)(n.code,{children:"source"})," like this:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'python_requirements(source="reqs.txt")\n'})}),"\n",(0,r.jsxs)(n.admonition,{type:"note",children:[(0,r.jsxs)(n.mdxAdmonitionTitle,{children:["Where should I put the ",(0,r.jsx)(n.code,{children:"requirements.txt"}),"?"]}),(0,r.jsx)(n.p,{children:"You can name the file whatever you want, and put it wherever makes the most sense for your project."}),(0,r.jsx)(n.p,{children:'In smaller repositories that only use Python, it\'s often convenient to put the file at the "build root" (top-level), as used on this page.'}),(0,r.jsxs)(n.p,{children:["For larger repositories or multilingual repositories, it's often useful to have a ",(0,r.jsx)(n.code,{children:"3rdparty"})," or ",(0,r.jsx)(n.code,{children:"3rdparty/python"})," directory. Rather than the target's address being ",(0,r.jsx)(n.code,{children:"//:reqs#my_requirement"}),", its address would be ",(0,r.jsx)(n.code,{children:"3rdparty/python:reqs#my_requirement"}),", for example; or ",(0,r.jsx)(n.code,{children:"3rdparty/python#my_requirement"})," if you leave off the ",(0,r.jsx)(n.code,{children:"name"})," field for ",(0,r.jsx)(n.code,{children:"python_requirements"}),". See ",(0,r.jsx)(n.a,{href:"/2.13/docs/using-pants/key-concepts/targets-and-build-files#target-generation",children:"Target Generation"}),"."]})]}),"\n",(0,r.jsx)(n.h3,{id:"poetry",children:"Poetry"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"poetry_requirements()"})," target generator parses the ",(0,r.jsx)(n.a,{href:"https://python-poetry.org/docs/",children:"Poetry"})," section in ",(0,r.jsx)(n.code,{children:"pyproject.toml"})," to produce a ",(0,r.jsx)(n.code,{children:"python_requirement"})," target for each entry."]}),"\n",(0,r.jsxs)(o.A,{groupId:"code-examples",children:[(0,r.jsx)(l.A,{value:"pyproject.toml",label:"pyproject.toml",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-toml",metastring:'tab={"label":"pyproject.toml"}',children:'[tool.poetry.dependencies]\npython = "^3.8"\nrequests = {extras = ["security"], version = "~1"}\nflask = "~1.12"\n\n[tool.poetry.dev-dependencies]\nisort = "~5.5"\n'})})}),(0,r.jsx)(l.A,{value:"build",label:"BUILD",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",metastring:'tab={"label":"BUILD"}',children:'# This will generate three targets:\n#\n#  - //:poetry#flask\n#  - //:poetry#requests\n#  - //:poetry#dataclasses\npoetry_requirements(name="poetry")\n\n# The above target generator is spiritually equivalent to this:\npython_requirement(\n    name="requests",\n    requirements=["requests[security]>=1,<2.0"],\n)\npython_requirement(\n    name="flask",\n    requirements=["flask>=1.12,<1.13"],\n)\npython_requirement(\n    name="isort",\n    requirements=["isort>=5.5,<5.6"],\n)\n'})})})]}),"\n",(0,r.jsxs)(n.p,{children:["Note that Pants does not consume your ",(0,r.jsx)(n.code,{children:"poetry.lock"})," file. Instead, see the ",(0,r.jsx)(n.a,{href:"#lockfiles",children:"section on lockfiles"})," below."]}),"\n",(0,r.jsx)(n.h2,{id:"how-dependencies-are-chosen",children:"How dependencies are chosen"}),"\n",(0,r.jsxs)(n.p,{children:['Once Pants knows about your "universe"(s) of dependencies, it determines which subset should be used through ',(0,r.jsx)(n.a,{href:"https://blog.pantsbuild.org/dependency-inference/",children:"dependency inference"}),". Pants will read your import statements, like ",(0,r.jsx)(n.code,{children:"import django"}),", and map it back to the relevant ",(0,r.jsx)(n.code,{children:"python_requirement"})," target. Run ",(0,r.jsx)(n.a,{href:"/2.13/docs/using-pants/project-introspection",children:(0,r.jsx)(n.code,{children:"./pants dependencies path/to/file.py"})})," or ",(0,r.jsx)(n.code,{children:"./pants dependencies path/to:target"})," to confirm this works."]}),"\n",(0,r.jsxs)(n.p,{children:["If dependency inference does not work\u2014such as because it's a runtime dependency you do not import\u2014you can explicitly add the ",(0,r.jsx)(n.code,{children:"python_requirement"})," target to the ",(0,r.jsx)(n.code,{children:"dependencies"})," field, like this:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",metastring:'title="project/BUILD"',children:'python_sources(\n    name="lib",\n    dependencies=[\n        # We don\'t have an import statement for this dep, so inference\n        # won\'t add it automatically. We add it explicitly instead.\n        "3rdparty/python#psyscopg2-binary",\n    ],\n)\n'})}),"\n",(0,r.jsxs)(n.h3,{id:"use-modules-and-module_mapping-when-the-module-name-is-not-standard",children:["Use ",(0,r.jsx)(n.code,{children:"modules"})," and ",(0,r.jsx)(n.code,{children:"module_mapping"})," when the module name is not standard"]}),"\n",(0,r.jsxs)(n.p,{children:["Some dependencies expose a module different than their project name, such as ",(0,r.jsx)(n.code,{children:"beautifulsoup4"})," exposing ",(0,r.jsx)(n.code,{children:"bs4"}),". Pants assumes that a dependency's module is its normalized name\u2014i.e. ",(0,r.jsx)(n.code,{children:"My-distribution"})," exposes the module ",(0,r.jsx)(n.code,{children:"my_distribution"}),". If that default does not apply to a dependency, it will not be inferred."]}),"\n",(0,r.jsxs)(n.p,{children:["Pants already defines a ",(0,r.jsx)(n.a,{href:"https://github.com/pantsbuild/pants/blob/main/src/python/pants/backend/python/dependency_inference/default_module_mapping.py",children:"default module mapping"})," for some common Python requirements, but you may need to augment this by teaching Pants additional mappings:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",metastring:'title="3rdparty/python/BUILD"',children:'# `modules` and `module_mapping` is only needed for requirements where\n# the defaults do not work.\n\npython_requirement(\n    name="my_distribution",\n    requirements=["my_distribution==4.1"],\n    modules=["custom_module"],\n)\n\npython_requirements(\n    name="reqs",\n    module_mapping={"my_distribution": ["custom_module"]},\n)\n\npoetry_requirements(\n    name="poetry",\n    module_mapping={"my_distribution": ["custom_module"]},\n)\n'})}),"\n",(0,r.jsxs)(n.p,{children:["If the dependency is a type stub, and the default does not work, set ",(0,r.jsx)(n.code,{children:"type_stub_modules"})," on the ",(0,r.jsx)(n.code,{children:"python_requirement"})," target, and ",(0,r.jsx)(n.code,{children:"type_stubs_module_mapping"})," on the ",(0,r.jsx)(n.code,{children:"python_requirements"})," and ",(0,r.jsx)(n.code,{children:"poetry_requirements"})," target generators. (The default for type stubs is to strip off ",(0,r.jsx)(n.code,{children:"types-"}),", ",(0,r.jsx)(n.code,{children:"-types"}),", ",(0,r.jsx)(n.code,{children:"-stubs"}),", and ",(0,r.jsx)(n.code,{children:"stubs-"}),". So, ",(0,r.jsx)(n.code,{children:"types-requests"})," gives type stubs for the module ",(0,r.jsx)(n.code,{children:"requests"}),".)"]}),"\n",(0,r.jsx)(n.h3,{id:"warning-multiple-versions-of-the-same-dependency",children:"Warning: multiple versions of the same dependency"}),"\n",(0,r.jsxs)(n.p,{children:["It's invalid in Python to have conflicting versions of the same requirement, e.g. ",(0,r.jsx)(n.code,{children:"Django==2"})," and ",(0,r.jsx)(n.code,{children:"Django==3"}),'. Instead, Pants supports "multiple resolves" (i.e. multiple lockfiles), as explained in the below section on lockfiles.']}),"\n",(0,r.jsxs)(n.p,{children:['When you have multiple targets for the same dependency and they belong to the same resolve ("lockfile"), dependency inference will not work due to ambiguity. If you\'re using lockfiles\u2014which we strongly recommend\u2014the solution is to set the ',(0,r.jsx)(n.code,{children:"resolve"})," field for problematic ",(0,r.jsx)(n.code,{children:"python_requirement"})," targets so that each resolve has only one requirement and there is no ambiguity."]}),"\n",(0,r.jsxs)(n.p,{children:["This ambiguity is often a problem when you have 2+ ",(0,r.jsx)(n.code,{children:"requirements.txt"})," or ",(0,r.jsx)(n.code,{children:"pyproject.toml"})," files in your project, such as ",(0,r.jsx)(n.code,{children:"project1/requirements.txt"})," and ",(0,r.jsx)(n.code,{children:"project2/requirements.txt"})," both specifying ",(0,r.jsx)(n.code,{children:"django"}),". You may want to set up each ",(0,r.jsx)(n.code,{children:"poetry_requirements"}),"/",(0,r.jsx)(n.code,{children:"python_requirements"})," target generator to use a distinct resolve so that there is no overlap. Alternatively, if the versions are the same, you may want to consolidate the requirements into a common file."]}),"\n",(0,r.jsx)(n.h2,{id:"lockfiles",children:"Lockfiles"}),"\n",(0,r.jsxs)(n.p,{children:["We strongly recommend using lockfiles because they make your builds ",(0,r.jsx)(n.a,{href:"https://classic.yarnpkg.com/blog/2016/11/24/lockfiles-for-all/",children:"more stable"})," so that new releases of dependencies will not break your project. They also reduce the risk of ",(0,r.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/windows/security/threat-protection/intelligence/supply-chain-malware",children:"supply chain attacks"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"Pants has two types of lockfiles:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"User lockfiles, for your own code such as packaging binaries and running tests."}),"\n",(0,r.jsx)(n.li,{children:"Tool lockfiles, to install tools that Pants runs like Pytest and Flake8."}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["With both types of lockfiles, Pants can generate the lockfile for you with the ",(0,r.jsx)(n.code,{children:"generate-lockfiles"})," goal."]}),"\n",(0,r.jsx)(n.h3,{id:"user-lockfiles",children:"User lockfiles"}),"\n",(0,r.jsxs)(n.p,{children:["First, set ",(0,r.jsx)(n.code,{children:"[python].enable_resolves"})," in ",(0,r.jsx)(n.code,{children:"pants.toml"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-toml",children:"[python]\nenable_resolves = true\n"})}),"\n",(0,r.jsxs)(n.p,{children:["By default, Pants will write the lockfile to ",(0,r.jsx)(n.code,{children:"3rdparty/python/default.lock"}),". If you want a different location, change ",(0,r.jsx)(n.code,{children:"[python].resolves"})," like this:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-toml",children:'[python]\nenable_resolves = true\n\n[python.resolves]\npython-default = "lockfile_path.txt"\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Then, use ",(0,r.jsx)(n.code,{children:"./pants generate-lockfiles"})," to generate the lockfile."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"\u276F ./pants generate-lockfiles\n19:00:39.26 [INFO] Completed: Generate lockfile for python-default\n19:00:39.29 [INFO] Wrote lockfile for the resolve `python-default` to 3rdparty/python/default.lock\n"})}),"\n",(0,r.jsxs)(n.admonition,{title:"FYI: user lockfiles improve performance",type:"note",children:[(0,r.jsx)(n.p,{children:'As explained at the top of these docs, Pants only uses the subset of the "universe" of your dependencies that is actually needed for a build, such as running tests and packaging a wheel file. This gives fine-grained caching and has other benefits like built packages (e.g. PEX binaries) only including their true dependencies. However, naively, this would mean that you need to resolve dependencies multiple times, which can be slow.'}),(0,r.jsxs)(n.p,{children:["If you use the default of Pex-generated lockfiles (see below), Pants will only install the\nsubset of the lockfile you need for a task. If you instead use Poetry-generated lockfiles,\nPants will first install the entire lockfile and then it\nwill ",(0,r.jsx)(n.a,{href:"https://blog.pantsbuild.org/introducing-pants-2-5/",children:"extract"})," the exact subset needed."]}),(0,r.jsxs)(n.p,{children:["This greatly speeds up performance and improves caching for goals like ",(0,r.jsx)(n.code,{children:"test"}),", ",(0,r.jsx)(n.code,{children:"run"}),", ",(0,r.jsx)(n.code,{children:"package"}),", and ",(0,r.jsx)(n.code,{children:"repl"}),"."]})]}),"\n",(0,r.jsx)(n.h4,{id:"multiple-lockfiles",children:"Multiple lockfiles"}),"\n",(0,r.jsx)(n.p,{children:"While it's often desirable to have a single lockfile for the whole repository for simplicity and consistency, sometimes you may need multiple. This is necessary, for example, when you have conflicting versions of requirements, such as one project using Django 2 and other projects using Django 3."}),"\n",(0,r.jsx)(n.p,{children:'Start by defining multiple "resolves", which are logical names for lockfile paths. For example:'}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-toml",children:'[python]\nenable_resolves = true\ndefault_resolve = "web-app"\n\n[python.resolves]\ndata-science = "3rdparty/python/data_science_lock.txt"\nweb-app = "3rdparty/python/web_app_lock.txt"\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Then, teach Pants which resolves every ",(0,r.jsx)(n.code,{children:"python_requirement"})," target belongs to through the ",(0,r.jsx)(n.code,{children:"resolve"})," field. It will default to ",(0,r.jsx)(n.code,{children:"[python].default_resolve"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",metastring:'title="BUILD"',children:'python_requirement(\n    name="ansicolors",\n    requirements=["ansicolors==1.18"],\n    resolve="web-app",\n)\n\n# Often, you will want to set `resolve` on the\n# `poetry_requirements` and `python_requirements`\n# target generators.\npoetry_requirements(\n    name="poetry",\n    resolve="data-science",\n    # You can use `overrides` if you only want to change\n    # some targets.\n    overrides={"requests": {"resolve": "web-app"}},\n)\n'})}),"\n",(0,r.jsxs)(n.p,{children:["If you want the same requirement to show up in multiple resolves, use the ",(0,r.jsx)(n.a,{href:"/2.13/docs/using-pants/key-concepts/targets-and-build-files",children:(0,r.jsx)(n.code,{children:"parametrize"})})," mechanism."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",metastring:'title="BUILD"',children:'# The same requirement in multiple resolves:\npython_requirement(\n    name="ansicolors_web-app",\n    requirements=["ansicolors==1.18"],\n    resolve=parametrize("web-app", "data-science")\n)\n\n# You can parametrize target generators, including\n# via the `overrides` field:\npoetry_requirements(\n    name="poetry",\n    resolve="data-science",\n    overrides={\n        "requests": {\n            "resolve": parametrize("web-app", "data-science")\n        }\n    },\n)\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Then, run ",(0,r.jsx)(n.code,{children:"./pants generate-lockfiles"})," to generate the lockfiles. If the results aren't what you'd expect, adjust the prior step."]}),"\n",(0,r.jsxs)(n.p,{children:["Finally, update your first-party targets like ",(0,r.jsx)(n.code,{children:"python_source"})," / ",(0,r.jsx)(n.code,{children:"python_sources"}),", ",(0,r.jsx)(n.code,{children:"python_test"})," / ",(0,r.jsx)(n.code,{children:"python_tests"}),", and ",(0,r.jsx)(n.code,{children:"pex_binary"})," to set their ",(0,r.jsx)(n.code,{children:"resolve"})," field. As before, the ",(0,r.jsx)(n.code,{children:"resolve"})," field defaults to ",(0,r.jsx)(n.code,{children:"[python].default_resolve"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",metastring:'title="project/BUILD"',children:'python_sources(\n    resolve="web-app",\n)\n\npython_tests(\n    name="tests",\n    resolve="web-app",\n    # You can use `overrides` to change certain generated targets\n    overrides={"test_utils.py": {"resolve": "data-science"}},\n)\n\npex_binary(\n    name="main",\n    entry_point="main.py",\n    resolve="web-app",\n)\n'})}),"\n",(0,r.jsxs)(n.p,{children:["If a first-party target is compatible with multiple resolves\u2014such as some utility code\u2014you can either use the ",(0,r.jsxs)(n.a,{href:"/2.13/docs/using-pants/key-concepts/targets-and-build-files",children:[(0,r.jsx)(n.code,{children:"parametrize"})," mechanism"]})," with the ",(0,r.jsx)(n.code,{children:"resolve"})," field or create distinct targets for the same entity."]}),"\n",(0,r.jsxs)(n.p,{children:["All transitive dependencies of a target must use the same resolve. Pants's dependency inference already handles this for you by only inferring dependencies on targets that share the same resolve. If you incorrectly add a target from a different resolve to the ",(0,r.jsx)(n.code,{children:"dependencies"})," field, Pants will error with a helpful message when building your code with goals like ",(0,r.jsx)(n.code,{children:"test"}),", ",(0,r.jsx)(n.code,{children:"package"}),", and ",(0,r.jsx)(n.code,{children:"run"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"tool-lockfiles",children:"Tool lockfiles"}),"\n",(0,r.jsxs)(n.p,{children:["Pants distributes a lockfile with each tool by default. However, if you change the tool's ",(0,r.jsx)(n.code,{children:"version"})," and ",(0,r.jsx)(n.code,{children:"extra_requirements"}),"\u2014or you change its interpreter constraints to not be compatible with our default lockfile\u2014you will need to use a custom lockfile. Set the ",(0,r.jsx)(n.code,{children:"lockfile"})," option in ",(0,r.jsx)(n.code,{children:"pants.toml"})," for that tool, and then run ",(0,r.jsx)(n.code,{children:"./pants generate-lockfiles"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-toml",children:'[flake8]\nversion = "flake8==3.8.0"\nlockfile = "3rdparty/flake8_lockfile.txt"  # This can be any path you\'d like.\n\n[pytest]\nextra_requirements.add = ["pytest-icdiff"]\nlockfile = "3rdparty/pytest_lockfile.txt"\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"\u276F  ./pants generate-lockfiles\n19:00:39.26 [INFO] Completed: Generate lockfile for flake8\n19:00:39.27 [INFO] Completed: Generate lockfile for pytest\n19:00:39.29 [INFO] Wrote lockfile for the resolve `flake8` to 3rdparty/flake8_lockfile.txt\n19:00:39.30 [INFO] Wrote lockfile for the resolve `pytest` to 3rdparty/pytest_lockfile.txt\n"})}),"\n",(0,r.jsxs)(n.p,{children:["You can also run ",(0,r.jsx)(n.code,{children:"./pants generate-lockfiles --resolve=tool"}),", e.g. ",(0,r.jsx)(n.code,{children:"--resolve=flake8"}),", to only generate that tool's lockfile rather than generating all lockfiles."]}),"\n",(0,r.jsxs)(n.p,{children:["To disable lockfiles entirely for a tool, set ",(0,r.jsx)(n.code,{children:'[tool].lockfile = "<none>"'})," for that tool. Although we do not recommend this!"]}),"\n",(0,r.jsx)(n.h3,{id:"pex-vs-poetry-for-lockfile-generation",children:"Pex vs. Poetry for lockfile generation"}),"\n",(0,r.jsxs)(n.p,{children:["Pants defaults to using ",(0,r.jsx)(n.a,{href:"https://pex.readthedocs.io/",children:"Pex"})," to generate lockfiles, but you can\ninstead use ",(0,r.jsx)(n.a,{href:"https://python-poetry.org",children:"Poetry"})," by setting ",(0,r.jsx)(n.code,{children:'[python].lockfile_generator = "poetry"'}),"\nin ",(0,r.jsx)(n.code,{children:"pants.toml"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"We generally recommend using the default of Pex, which has several benefits:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Supports ",(0,r.jsx)(n.code,{children:"[python-repos]"})," if you have a custom index or repository other than PyPI."]}),"\n",(0,r.jsxs)(n.li,{children:["Supports ",(0,r.jsx)(n.code,{children:"[GLOBAL].ca_certs_path"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"Supports VCS (Git) requirements."}),"\n",(0,r.jsx)(n.li,{children:"Faster performance when installing lockfiles. With Pex, Pants will only install the subset of the lockfile needed for a task; with Poetry, Pants will first install the lockfile and then extract the relevant subset."}),"\n",(0,r.jsx)(n.li,{children:"Avoids an issue many users have with problematic environment markers for transitive requirements (see below)."}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["However, it is very plausible there are still issues with Pex lockfiles because the Python ecosystem is so vast. Please open ",(0,r.jsx)(n.a,{href:"docs:getting-help",children:"bug reports"}),"! If ",(0,r.jsx)(n.code,{children:"generate-lockfiles"})," fails\u2014or the lockfile errors when installed during goals like ",(0,r.jsx)(n.code,{children:"test"})," and ",(0,r.jsx)(n.code,{children:"package"}),"\u2014you may need to temporarily use Poetry."]}),"\n",(0,r.jsx)(n.p,{children:"Alternatively, you can try to manually generate and manage lockfiles\u2014change to the v2.10 version of these docs to see instructions."}),"\n",(0,r.jsxs)(n.admonition,{title:"Incremental migration from Poetry to Pex",type:"note",children:[(0,r.jsxs)(n.p,{children:["Pants can understand lockfiles in either Pex's JSON format or Poetry's requirements.txt-style file, regardless of what you set ",(0,r.jsx)(n.code,{children:"[python].lockfile_generator"})," to. This means that you can have some lockfiles using a different format than the others."]}),(0,r.jsxs)(n.p,{children:["To incrementally migrate, consider writing a script that dynamically sets the option ",(0,r.jsx)(n.code,{children:"--python-lockfile-generator"}),", like this:"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"./pants --python-lockfile-generator=pex generate-lockfiles --resolve=black --resolve=isort\n./pants --python-lockfile-generator=poetry generate-lockfiles --resolve=python-default\n"})}),(0,r.jsxs)(n.p,{children:["Tip: if you write a script, set ",(0,r.jsx)(n.code,{children:"[generate-lockfiles].custom_command"})," to say how to run your script."]})]}),"\n",(0,r.jsx)(n.h4,{id:"poetry-issue-with-environment-markers",children:"Poetry issue with environment markers"}),"\n",(0,r.jsxs)(n.p,{children:["One of the issues with Poetry is that sometimes ",(0,r.jsx)(n.code,{children:"generate-lockfiles"})," will work, but then it errors when being installed due to missing transitive dependencies. This is especially common with user lockfiles. For example:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Failed to resolve requirements from PEX environment @ /home/pantsbuild/.cache/pants/named_caches/pex_root/unzipped_pexes/42735ba5593c0be585614e50072f765c6a45be15.\nNeeded manylinux_2_28_x86_64-cp-37-cp37m compatible dependencies for:\n 1: colorama<0.5.0,>=0.4.0\n    Required by:\n      FingerprintedDistribution(distribution=rich 11.0.0 (/home/pantsbuild/.cache/pants/named_caches/pex_root/installed_wheels/4ce6259e437af26bac891ed2867340d4163662b9/rich-11.0.0-py3-none-any.whl), fingerprint='ff22612617b194af3cd95380174413855aad7240')\n    But this pex had no 'colorama' distributions.\n"})}),"\n",(0,r.jsx)(n.p,{children:"Usually, the transitive dependency is in the lockfile, but it doesn't get installed because it has nonsensical environment markers, like this:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'colorama==0.4.4; sys_platform == "win32" and python_version >= "3.6" and python_full_version >= "3.6.2" and python_full_version < "4.0.0" and (python_version >= "3.6" and python_full_version < "3.0.0" or python_full_version >= "3.5.0" and python_version >= "3.6") and (python_version >= "3.6" and python_full_version < "3.0.0" and sys_platform == "win32" or sys_platform == "win32" and python_version >= "3.6" and python_full_version >= "3.5.0") and (python_version >= "3.6" and python_full_version < "3.0.0" and platform_system == "Windows" or python_full_version >= "3.5.0" and python_version >= "3.6" and platform_system == "Windows")\n'})}),"\n",(0,r.jsxs)(n.p,{children:["For user lockfiles, the workaround is to treat the problematic transitive dependencies as direct inputs to the resolve by creating a ",(0,r.jsx)(n.code,{children:"python_requirement"})," target, which usually causes the lockfile generator to handle things correctly. For example:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",metastring:'title="BUILD"',children:'python_requirement(\n    name="bad_transitive_dependencies_workaround",\n    requirements=[\n        "colorama",\n        "zipp",\n    ],\n    # This turns off dependency inference for these\n    # requirements, which you may want to do as they\n    # are transitive dependencies that should not be directly imported.\n    modules=[],\n    # If you are using multiple resolves, you may need to set the\n    # `resolve` field.\n)\n'})}),"\n",(0,r.jsxs)(n.p,{children:["For tool lockfiles, add the problematic transitive dependencies to ",(0,r.jsx)(n.code,{children:"[tool].extra_requirements"}),". For example:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-toml",children:'[pylint]\nversion = "pylint>=2.11.0,<2.12"\nextra_requirements.add = ["colorama"]\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Then, regenerate the lock with ",(0,r.jsx)(n.code,{children:"generate-lockfiles"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["You can also try manually removing the problematic environment markers, although you will need to remember to do this again whenever re-running ",(0,r.jsx)(n.code,{children:"generate-lockfiles"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"advanced-usage",children:"Advanced usage"}),"\n",(0,r.jsx)(n.h3,{id:"requirements-with-undeclared-dependencies",children:"Requirements with undeclared dependencies"}),"\n",(0,r.jsxs)(n.p,{children:["Sometimes a requirement does not properly declare in its packaging metadata the other dependencies it depends on, so those will not be installed. It's especially common to leave off dependencies on ",(0,r.jsx)(n.code,{children:"setuptools"}),", which results in import errors like this:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"import pkg_resources\nModuleNotFoundError: No module named 'pkg_resources'\n"})}),"\n",(0,r.jsxs)(n.p,{children:["To work around this, you can use the ",(0,r.jsx)(n.code,{children:"dependencies"})," field of ",(0,r.jsx)(n.code,{children:"python_requirement"}),", so that anytime you depend on your requirement, you also bring in the undeclared dependency."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",metastring:'title="BUILD"',children:'# First, make sure you have a `python_requirement` target for\n# the undeclared dependency.\npython_requirement(\n    name="setuptools",\n    requirements=["setuptools"],\n)\n\npython_requirement(\n    name="mongomock",\n    requirements=["mongomock"],\n    dependencies=[":setuptools"],\n)\n'})}),"\n",(0,r.jsxs)(n.p,{children:["If you are using the ",(0,r.jsx)(n.code,{children:"python_requirements"})," and ",(0,r.jsx)(n.code,{children:"poetry_requirements"})," target generators, you can use the ",(0,r.jsx)(n.code,{children:"overrides"})," field to do the same thing:"]}),"\n",(0,r.jsxs)(o.A,{groupId:"code-examples",children:[(0,r.jsx)(l.A,{value:"build",label:"BUILD",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",metastring:'tab={"label":"BUILD"}',children:'python_requirements(\n    name="reqs",\n    overrides={\n        "mongomock": {"dependencies": [":reqs#setuptools"]},\n    },\n)\n'})})}),(0,r.jsx)(l.A,{value:"requirements.txt",label:"requirements.txt",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",metastring:'tab={"label":"requirements.txt"}',children:"setuptools\nmongomock\n"})})})]}),"\n",(0,r.jsx)(n.h3,{id:"version-control-and-local-requirements",children:"Version control and local requirements"}),"\n",(0,r.jsx)(n.p,{children:"You can install requirements from version control using two styles:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["pip's proprietary VCS-style requirements, e.g.","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"git+https://github.com/django/django.git#egg=Django"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"git+https://github.com/django/django.git@stable/2.1.x#egg=Django"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"git+https://github.com/django/django.git@fd209f62f1d83233cc634443cfac5ee4328d98b8#egg=Django"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["direct references from ",(0,r.jsx)(n.a,{href:"https://www.python.org/dev/peps/pep-0440/#direct-references",children:"PEP 440"}),", e.g.","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"Django@ git+https://github.com/django/django.git"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"Django@ git+https://github.com/django/django.git@stable/2.1.x"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"Django@ git+https://github.com/django/django.git@fd209f62f1d83233cc634443cfac5ee4328d98b8"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["You can also install from local files using ",(0,r.jsx)(n.a,{href:"https://www.python.org/dev/peps/pep-0440/#direct-references",children:"PEP 440 direct references"}),". You must use an absolute path to the file, and you should ensure that the file exists on your machine."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Django @ file:///Users/pantsbuild/prebuilt_wheels/django-3.1.1-py3-none-any.whl\n"})}),"\n",(0,r.jsxs)(n.admonition,{title:"Local file requirements do not yet work with lockfiles",type:"caution",children:[(0,r.jsx)(n.p,{children:"Pex lockfiles will soon support local file requirements."}),(0,r.jsxs)(n.p,{children:["In the meantime, the workaround is to host the files in a private repository / index and load it with ",(0,r.jsx)(n.code,{children:"[python-repos]"}),"."]})]}),"\n",(0,r.jsxs)(n.admonition,{title:"Version control via SSH",type:"note",children:[(0,r.jsx)(n.p,{children:"When using version controlled direct references hosted on private repositories with SSH access:"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"target@ git+ssh://git@github.com:/myorg/myrepo.git@myhash\n"})}),(0,r.jsx)(n.p,{children:"...you may see errors like:"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:" Complete output (5 lines):\n  git@github.com: Permission denied (publickey).\n  fatal: Could not read from remote repository.\n  Please make sure you have the correct access rights\n  and the repository exists.\n  ----------------------------------------\n"})}),(0,r.jsxs)(n.p,{children:["To fix this, Pants needs to be configured to pass relevant SSH specific environment variables to processes by adding the following to ",(0,r.jsx)(n.code,{children:"pants.toml"}),":"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'[subprocess-environment]\nenv_vars.add = [\n  "SSH_AUTH_SOCK",\n]\n'})})]}),"\n",(0,r.jsx)(n.h3,{id:"custom-repositories",children:"Custom repositories"}),"\n",(0,r.jsx)(n.p,{children:"There are two mechanisms for setting up custom Python distribution repositories:"}),"\n",(0,r.jsx)(n.h4,{id:"simple-repositories-as-defined-by-pep-503",children:"Simple repositories as defined by PEP 503"}),"\n",(0,r.jsxs)(n.p,{children:['If your custom repo is of this type, i.e., "private PyPI", aka "cheese shop", use the option ',(0,r.jsx)(n.code,{children:"indexes"})," in the ",(0,r.jsx)(n.code,{children:"[python-repos]"})," scope."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-toml",metastring:'title="pants.toml"',children:'[python-repos]\nindexes.add = ["https://custom-cheeseshop.net/simple"]\n'})}),"\n",(0,r.jsxs)(n.p,{children:["To exclusively use your custom index\u2014i.e. to not use PyPI\u2014use ",(0,r.jsx)(n.code,{children:"indexes = [..]"})," instead of ",(0,r.jsx)(n.code,{children:"indexes.add = [..]"}),"."]}),"\n",(0,r.jsx)(n.h4,{id:"a-pip-findlinks-repository",children:"A Pip findlinks repository"}),"\n",(0,r.jsxs)(n.p,{children:["If your custom repo is of this type, use the option ",(0,r.jsx)(n.code,{children:"repos"})," in the ",(0,r.jsx)(n.code,{children:"[python-repos]"})," scope."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-toml",children:'[python-repos]\nrepos = ["https://your/repo/here"]\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Indexes are assumed to have a nested structure (like ",(0,r.jsx)(n.a,{href:"http://pypi.org/simple",children:"http://pypi.org/simple"}),"), whereas repos are flat lists of packages."]}),"\n",(0,r.jsx)(n.h4,{id:"authenticating-to-custom-repos",children:"Authenticating to custom repos"}),"\n",(0,r.jsx)(n.p,{children:"To authenticate to custom repos, you may need to provide credentials\n(such as a username and password) in the URL."}),"\n",(0,r.jsxs)(n.p,{children:["You can use ",(0,r.jsxs)(n.a,{href:"/2.13/docs/using-pants/key-concepts/options#config-file-interpolation",children:["config file ",(0,r.jsx)(n.code,{children:"%(env.ENV_VAR)s"})," interpolation"]}),"\nto load the values via environment variables. This avoids checking in sensitive information to\nversion control."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-toml",metastring:'title="pants.toml"',children:'[python-repos]\nindexes.add = ["http://%(env.INDEX_USERNAME)s:%(INDEX_PASSWORD)s@my.custom.repo/index"]\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Alternatively, you can hardcode the value in a private (not checked-in)\n",(0,r.jsx)(n.a,{href:"/2.13/docs/using-pants/key-concepts/options#pantsrc-file",children:".pants.rc file"})," in each user's Pants repo, that sets this config for\nthe user:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-toml",metastring:'title=".pants.rc"',children:'[python-repos]\nindexes.add = ["http://$USERNAME:$PASSWORD@my.custom.repo/index"]\n'})}),"\n",(0,r.jsxs)(n.h2,{id:"tip-use-pants-export-to-create-a-virtual-environment-for-ides",children:["Tip: use ",(0,r.jsx)(n.code,{children:"./pants export"})," to create a virtual environment for IDEs"]}),"\n",(0,r.jsxs)(n.p,{children:["See ",(0,r.jsx)(n.a,{href:"/2.13/docs/using-pants/setting-up-an-ide",children:"Setting up an IDE"})," for more information on ",(0,r.jsx)(n.code,{children:"./pants export"}),". This will create a virtual environment for your user code for compatibility with the rest of the Python ecosystem, e.g. IDEs like Pycharm."]})]})}function u(e={}){let{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(p,{...e})}):p(e)}},753348(e,n,t){t.d(n,{A:()=>s});let s={tabItem:"tabItem_mHvh"}},618264(e,n,t){t.d(n,{A:()=>s});let s={tabList:"tabList_sFbf",tabItem:"tabItem_UVfV"}},637180(e,n,t){t.d(n,{A:()=>o});var s=t(886070);t(830758);var r=t(313526),i=t(753348);function o({children:e,hidden:n,className:t}){return(0,s.jsx)("div",{role:"tabpanel",className:(0,r.A)(i.A.tabItem,t),hidden:n,children:e})}},685008(e,n,t){t.d(n,{A:()=>m});var s=t(886070),r=t(830758),i=t(313526),o=t(911212),l=t(274875),a=t(106632),d=t(189223),c=t(618264);function h({className:e,block:n,selectedValue:t,selectValue:r,tabValues:o}){let a=[],{blockElementScrollPositionUntilNextRender:d}=(0,l.a_)(),h=e=>{let n=e.currentTarget,s=o[a.indexOf(n)].value;s!==t&&(d(n),r(s))},p=e=>{let n=null;switch(e.key){case"Enter":h(e);break;case"ArrowRight":{let t=a.indexOf(e.currentTarget)+1;n=a[t]??a[0];break}case"ArrowLeft":{let t=a.indexOf(e.currentTarget)-1;n=a[t]??a[a.length-1]}}n?.focus()};return(0,s.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.A)("tabs",{"tabs--block":n},e),children:o.map(({value:e,label:n,attributes:r})=>(0,s.jsx)("li",{role:"tab",tabIndex:t===e?0:-1,"aria-selected":t===e,ref:e=>{a.push(e)},onKeyDown:p,onClick:h,...r,className:(0,i.A)("tabs__item",c.A.tabItem,r?.className,{"tabs__item--active":t===e}),children:n??e},e))})}function p({lazy:e,children:n,selectedValue:t}){let o=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){let e=o.find(e=>e.props.value===t);return e?(0,r.cloneElement)(e,{className:(0,i.A)("margin-top--md",e.props.className)}):null}return(0,s.jsx)("div",{className:"margin-top--md",children:o.map((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==t}))})}function u(e){let n=(0,a.u)(e);return(0,s.jsxs)("div",{className:(0,i.A)(o.G.tabs.container,"tabs-container",c.A.tabList),children:[(0,s.jsx)(h,{...n,...e}),(0,s.jsx)(p,{...n,...e})]})}function m(e){let n=(0,d.A)();return(0,s.jsx)(u,{...e,children:(0,a.v)(e.children)},String(n))}},106632(e,n,t){t.d(n,{u:()=>h,v:()=>d});var s=t(830758),r=t(325557),i=t(363717),o=t(125740),l=t(574229),a=t(270367);function d(e){return s.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,s.isValidElement)(e)&&function(e){let{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function c({value:e,tabValues:n}){return n.some(n=>n.value===e)}function h(e){let n,{defaultValue:t,queryString:h=!1,groupId:p}=e,u=function(e){let{values:n,children:t}=e;return(0,s.useMemo)(()=>{let e=n??d(t).map(({props:{value:e,label:n,attributes:t,default:s}})=>({value:e,label:n,attributes:t,default:s})),s=(0,l.XI)(e,(e,n)=>e.value===n.value);if(s.length>0)throw Error(`Docusaurus error: Duplicate values "${s.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`);return e},[n,t])}(e),[m,y]=(0,s.useState)(()=>(function({defaultValue:e,tabValues:n}){if(0===n.length)throw Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!c({value:e,tabValues:n}))throw Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}let t=n.find(e=>e.default)??n[0];if(!t)throw Error("Unexpected error: 0 tabValues");return t.value})({defaultValue:t,tabValues:u})),[f,x]=function({queryString:e=!1,groupId:n}){let t=(0,r.W6)(),i=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,o.aZ)(i),(0,s.useCallback)(e=>{if(!i)return;let n=new URLSearchParams(t.location.search);n.set(i,e),t.replace({...t.location,search:n.toString()})},[i,t])]}({queryString:h,groupId:p}),[j,g]=function({groupId:e}){let n=e?`docusaurus.tab.${e}`:null,[t,r]=(0,a.Dv)(n);return[t,(0,s.useCallback)(e=>{n&&r.set(e)},[n,r])]}({groupId:p}),v=c({value:n=f??j,tabValues:u})?n:null;return(0,i.A)(()=>{v&&y(v)},[v]),{selectedValue:m,selectValue:(0,s.useCallback)(e=>{if(!c({value:e,tabValues:u}))throw Error(`Can't select invalid tab value=${e}`);y(e),x(e),g(e)},[x,g,u]),tabValues:u}}},848193(e,n,t){t.d(n,{R:()=>o,x:()=>l});var s=t(830758);let r={},i=s.createContext(r);function o(e){let n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(i.Provider,{value:n},e.children)}},384580(e){e.exports=JSON.parse('{"id":"docs/python/overview/third-party-dependencies","title":"Third-party dependencies","description":"How to use third-party Python libraries in your project.","source":"@site/versioned_docs/version-2.13/docs/python/overview/third-party-dependencies.mdx","sourceDirName":"docs/python/overview","slug":"/docs/python/overview/third-party-dependencies","permalink":"/2.13/docs/python/overview/third-party-dependencies","draft":false,"unlisted":false,"editUrl":"https://github.com/pantsbuild/pants/edit/main/docs/docs/python/overview/third-party-dependencies.mdx","tags":[],"version":"2.13","sidebarPosition":1,"frontMatter":{"title":"Third-party dependencies","sidebar_position":1},"sidebar":"docsSidebar","previous":{"title":"Enabling Python support","permalink":"/2.13/docs/python/overview/enabling-python-support"},"next":{"title":"Interpreter compatibility","permalink":"/2.13/docs/python/overview/interpreter-compatibility"}}')}}]);
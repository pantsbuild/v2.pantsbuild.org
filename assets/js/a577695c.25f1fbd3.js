"use strict";(self.webpackChunkpantsbuild_org=self.webpackChunkpantsbuild_org||[]).push([["795809"],{296925(e,n,r){r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>u,frontMatter:()=>i,metadata:()=>t,toc:()=>p});var t=r(767916),o=r(886070),l=r(848193),s=r(923668);let i={title:"per_platform",description:"An object containing differing homogeneous platform-dependent values.\n"},a,d={},p=[];function c(e){let n={code:"code",p:"p",pre:"pre",...(0,l.R)(),...e.components};return(0,o.jsxs)(s.A,{name:"per_platform",signature:"(linux_arm64: '_T | None' = None, linux_x86_64: '_T | None' = None, macos_arm64: '_T | None' = None, macos_x86_64: '_T | None' = None) -> None",children:[(0,o.jsx)(n.p,{children:"An object containing differing homogeneous platform-dependent values."}),(0,o.jsxs)(n.p,{children:["The values should be evaluated for the execution environment, and not the host environment (I.e. it should be evaluated in a ",(0,o.jsx)(n.code,{children:"rule"})," which requests ",(0,o.jsx)(n.code,{children:"Platform"}),")."]}),(0,o.jsx)(n.p,{children:"Expected usage is roughly:"}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",metastring:"class MyFieldType(...):",children:"    value = str | per_platform[str]\n\n    @classmethod\n    def compute_value( # type: ignore[override]\n        cls,\n        raw_value: Optional[Union[str, per_platform[str]]],\n        address: Address,\n    ) -> Optional[Union[str, per_platform[str]]]:\n        if isinstance(raw_value, per_platform):\n            # NOTE: Ensure the values are homogeneous\n            raw_value.check_types(str)\n\n        return raw_value\n\n...\n\n@rule async def my_rule(..., platform: Platform) -> ...:\n    field_value = target[MyFieldType].value\n\n    if isinstance(field_value, per_platform):\n        field_value = field_value.get_value_for_platform(platform)\n\n    ...\n"})}),(0,o.jsxs)(n.p,{children:["NOTE: Support for this object should be heavily weighed, as it would be inappropriate to use in certain contexts (such as the ",(0,o.jsx)(n.code,{children:"source"})," field in a ",(0,o.jsx)(n.code,{children:"foo_source"})," target, where the intent is to support differing source files based on platform. The result would be that dependency inference (and therefore the dependencies field) wouldn't be knowable on the host, which is not something the engine can support yet)."]})]})}function u(e={}){let{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},923668(e,n,r){r.d(n,{A:()=>l});var t=r(886070),o=r(384122);function l({name:e,signature:n,children:r}){return(0,t.jsxs)("div",{className:"margin-bottom--lg",children:[(0,t.jsx)(o.A,{language:"python",children:n?`def ${e}${n}: ...`:`${e} = ...`}),r]})}},767916(e){e.exports=JSON.parse('{"id":"reference/build-file-symbols/per_platform","title":"per_platform","description":"An object containing differing homogeneous platform-dependent values.\\n","source":"@site/versioned_docs/version-2.24/reference/build-file-symbols/per_platform.mdx","sourceDirName":"reference/build-file-symbols","slug":"/reference/build-file-symbols/per_platform","permalink":"/2.24/reference/build-file-symbols/per_platform","draft":false,"unlisted":false,"tags":[],"version":"2.24","frontMatter":{"title":"per_platform","description":"An object containing differing homogeneous platform-dependent values.\\n"},"sidebar":"referenceSidebar","previous":{"title":"parametrize","permalink":"/2.24/reference/build-file-symbols/parametrize"},"next":{"title":"python_artifact","permalink":"/2.24/reference/build-file-symbols/python_artifact"}}')}}]);
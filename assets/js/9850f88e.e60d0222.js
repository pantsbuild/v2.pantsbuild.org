"use strict";(self.webpackChunkpantsbuild_org=self.webpackChunkpantsbuild_org||[]).push([["82281"],{835123(e,n,s){s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>p,frontMatter:()=>o,metadata:()=>t,toc:()=>h});var t=s(225367),r=s(886070),a=s(848193),i=s(685008),l=s(637180);let o={title:"Java and Scala overview",sidebar_position:0},c,d={},h=[{value:"Initial setup",id:"initial-setup",level:2},{value:"Choosing JDK and Scala versions",id:"choosing-jdk-and-scala-versions",level:3},{value:"JDK",id:"jdk",level:4},{value:"Scala version",id:"scala-version",level:4},{value:"First-party dependencies",id:"first-party-dependencies",level:3},{value:"Third-party dependencies and lockfiles",id:"third-party-dependencies-and-lockfiles",level:3},{value:"<code>resource</code> targets",id:"resource-targets",level:3},{value:"Compile code",id:"compile-code",level:2},{value:"Run tests",id:"run-tests",level:2},{value:"Lint and Format",id:"lint-and-format",level:2},{value:"Working in an IDE",id:"working-in-an-ide",level:2},{value:"Usage",id:"usage",level:3},{value:"Setup",id:"setup",level:3},{value:"First time setup (per-repository)",id:"first-time-setup-per-repository",level:4},{value:"Per-user setup",id:"per-user-setup",level:4},{value:"Troubleshooting",id:"troubleshooting",level:3}];function u(e){let n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",hr:"hr",img:"img",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"Pants's support for Java and Scala."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.admonition,{title:"Java and Scala support is beta stage",type:"caution",children:[(0,r.jsxs)(n.p,{children:["We are done implementing most functionality for Pants's Java and Scala support (",(0,r.jsx)(n.a,{href:"https://github.com/pantsbuild/pants/labels/lang-jvm",children:"tracked here"}),"). However, there may be use cases that we aren't yet handling."]}),(0,r.jsxs)(n.p,{children:["Please share feedback for what you need to use Pants with your JVM project by either ",(0,r.jsx)(n.a,{href:"https://github.com/pantsbuild/pants/issues/new/choose",children:"opening a GitHub issue"})," or ",(0,r.jsx)(n.a,{href:"/community/members",children:"joining our Slack"}),"!"]})]}),"\n",(0,r.jsx)(n.admonition,{title:"Example Java and Scala repository",type:"note",children:(0,r.jsxs)(n.p,{children:["Check out ",(0,r.jsx)(n.a,{href:"https://github.com/pantsbuild/example-jvm",children:"github.com/pantsbuild/example-jvm"})," to try out Pants's Java and Scala support."]})}),"\n",(0,r.jsx)(n.h2,{id:"initial-setup",children:"Initial setup"}),"\n",(0,r.jsxs)(n.p,{children:["First, activate the relevant backends in ",(0,r.jsx)(n.code,{children:"pants.toml"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-toml",metastring:'title="pants.toml"',children:'[GLOBAL]\nbackend_packages = [\n  # Each backend can be used independently, so there is no need to enable Scala if you\n  # have a pure-Java repository (or vice versa).\n  "pants.backend.experimental.java",\n  "pants.backend.experimental.scala",\n]\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Then run ",(0,r.jsx)(n.a,{href:"/2.12/docs/getting-started/initial-configuration#5-generate-build-files",children:(0,r.jsx)(n.code,{children:"./pants tailor"})})," to generate BUILD files. This will create ",(0,r.jsx)(n.code,{children:"java_sources"})," and ",(0,r.jsx)(n.code,{children:"scala_sources"})," targets in every directory containing library code, as well as test targets like ",(0,r.jsx)(n.code,{children:"scalatest_tests"})," and ",(0,r.jsx)(n.code,{children:"junit_tests"})," for filenames that look like tests."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"\u276F ./pants tailor\nCreated src/jvm/org/pantsbuild/example/app/BUILD:\n  - Add scala_sources target app\nCreated src/jvm/org/pantsbuild/example/lib/BUILD:\n  - Add java_sources target lib\nCreated tests/jvm/org/pantsbuild/example/lib/BUILD:\n  - Add scalatest_tests target lib\n"})}),"\n",(0,r.jsxs)(n.p,{children:["You can run ",(0,r.jsx)(n.code,{children:"./pants list ::"})," to see all targets in your project:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"\u276F ./pants list\n...\nsrc/jvm/org/pantsbuild/example/app:app\nsrc/jvm/org/pantsbuild/example/app/ExampleApp.scala\nsrc/jvm/org/pantsbuild/example/lib:lib\nsrc/jvm/org/pantsbuild/example/lib/ExampleLib.java\ntests/jvm/org/pantsbuild/example/lib:lib\ntests/jvm/org/pantsbuild/example/lib/ExampleLibSpec.scala\n"})}),"\n",(0,r.jsx)(n.h3,{id:"choosing-jdk-and-scala-versions",children:"Choosing JDK and Scala versions"}),"\n",(0,r.jsxs)(n.p,{children:["Pants ",(0,r.jsx)(n.code,{children:"2.11.x"})," adds support for choosing JDK and Scala versions per target in your repository, but to reduce the amount of boilerplate required, most users set repository-wide defaults in ",(0,r.jsx)(n.code,{children:"pants.toml"}),", and then only override them when necessary for particular targets."]}),"\n",(0,r.jsx)(n.h4,{id:"jdk",children:"JDK"}),"\n",(0,r.jsxs)(n.p,{children:["JDKs used by Pants are automatically fetched using ",(0,r.jsx)(n.a,{href:"https://get-coursier.io/",children:"Coursier"}),", and are chosen using the ",(0,r.jsxs)(n.a,{href:"/2.12/reference/subsystems/jvm#section-jdk",children:[(0,r.jsx)(n.code,{children:"[jvm].jdk"})," setting"]})," to set a repository-wide default."]}),"\n",(0,r.jsxs)(n.p,{children:["To override the default on a particular target, you can use the ",(0,r.jsxs)(n.a,{href:"/2.12/reference/targets/java_source#jdk",children:[(0,r.jsx)(n.code,{children:"jdk="})," field"]}),". It can be useful to use the ",(0,r.jsxs)(n.a,{href:"/2.12/docs/using-pants/key-concepts/targets-and-build-files#parametrizing-targets",children:[(0,r.jsx)(n.code,{children:"parametrize"})," builtin"]})," with the ",(0,r.jsx)(n.code,{children:"jdk="})," field, particularly to run test targets under multiple JDKs."]}),"\n",(0,r.jsx)(n.h4,{id:"scala-version",children:"Scala version"}),"\n",(0,r.jsxs)(n.p,{children:['The Scala version to use is configured on a resolve-by-resolve basis (see the "Third-party dependencies" section below) using the ',(0,r.jsxs)(n.a,{href:"/2.12/reference/subsystems/scala#section-version_for_resolve",children:[(0,r.jsx)(n.code,{children:"[scala].version_for_resolve"})," option"]}),'. The default Scala version for your repository will thus be whichever Scala version is configured for the "default" resolve, which is configured by the ',(0,r.jsxs)(n.a,{href:"reference-jvm#section-default-resolve",children:[(0,r.jsx)(n.code,{children:"[jvm].default_resolve"})," option"]}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["To use multiple Scala versions in a repository, you would define multiple resolves, and then adjust the ",(0,r.jsxs)(n.a,{href:"/2.12/reference/targets/scalatest_test#resolve",children:[(0,r.jsx)(n.code,{children:"resolve"})," field"]})," of any targets which should be used with the non-",(0,r.jsx)(n.code,{children:"default_resolve"})," resolve."]}),"\n",(0,r.jsxs)(n.p,{children:["To cross-build a set of Scala targets for multiple Scala versions, you can use the ",(0,r.jsxs)(n.a,{href:"/2.12/docs/using-pants/key-concepts/targets-and-build-files#parametrizing-targets",children:[(0,r.jsx)(n.code,{children:"parametrize"})," builtin"]})," with the ",(0,r.jsx)(n.code,{children:"resolve="})," field of the target and its dependencies."]}),"\n",(0,r.jsx)(n.admonition,{title:"A jvm_artifact for scala-library artifact is explicitly required.",type:"caution",children:(0,r.jsxs)(n.p,{children:["The Scala backend currently requires that a ",(0,r.jsx)(n.code,{children:"jvm_artifact"})," target for the ",(0,r.jsx)(n.code,{children:"org.scala-lang:scala-library"})," Scala runtime be present in any resolve used for Scala. If such a jvm_artifact is missing, Pants will error. Pants will automatically inject a dependency on the runtime. (This target may be automatically supplied by Pants in a future version, but that is not currently implemented.)"]})}),"\n",(0,r.jsx)(n.h3,{id:"first-party-dependencies",children:"First-party dependencies"}),"\n",(0,r.jsxs)(n.p,{children:["In many cases, the dependencies of your first-party code are automatically inferred via ",(0,r.jsx)(n.a,{href:"https://blog.pantsbuild.org/automatically-unlocking-concurrent-builds-and-fine-grained-caching-on-the-jvm-with-dependency-inference/",children:"dependency inference"})," based on your ",(0,r.jsx)(n.code,{children:"import"})," statements. If you do need to declare additional dependencies for any reason, you can do so using Pants' ",(0,r.jsx)(n.a,{href:"/2.12/docs/using-pants/key-concepts/targets-and-build-files",children:"syntax for declaring dependencies for targets"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"third-party-dependencies-and-lockfiles",children:"Third-party dependencies and lockfiles"}),"\n",(0,r.jsxs)(n.p,{children:["Third-party dependencies (i.e. those from repositories like ",(0,r.jsx)(n.a,{href:"https://search.maven.org/",children:"Maven central"}),") are also automatically inferred via dependency inference, but must first be declared once per repository as ",(0,r.jsxs)(n.a,{href:"/2.12/reference/targets/jvm_artifact",children:[(0,r.jsx)(n.code,{children:"jvm_artifact"})," targets"]}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",metastring:'title="BUILD"',children:'jvm_artifact(\n    group="com.google.guava",\n    artifact="guava",\n    version="31.0.1-jre",\n    # See the callout below for more information on the `packages` argument.\n    packages=["com.google.common.**"],\n)\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Pants requires use of a lockfile for thirdparty dependencies. After adding or editing ",(0,r.jsx)(n.code,{children:"jvm_artifact"})," targets, you will need to update affected lockfiles by running ",(0,r.jsx)(n.code,{children:"./pants generate-lockfiles"}),". The default lockfile is located at ",(0,r.jsx)(n.code,{children:"3rdparty/jvm/default.lock"}),", but it can be relocated (as well as additional resolves declared) via the ",(0,r.jsxs)(n.a,{href:"/2.12/reference/subsystems/jvm#section-resolves",children:[(0,r.jsx)(n.code,{children:"[jvm].resolves"})," option"]}),"."]}),"\n",(0,r.jsxs)(n.admonition,{type:"note",children:[(0,r.jsxs)(n.mdxAdmonitionTitle,{children:["Thirdparty symbols and the ",(0,r.jsx)(n.code,{children:"packages"})," argument"]}),(0,r.jsxs)(n.p,{children:["To efficiently determine which symbols are provided by thirdparty code (i.e., without hitting the network in order to compute dependencies in the common case), Pants relies on a static mapping of which artifacts provide which symbols, and defaults to treating each ",(0,r.jsx)(n.code,{children:"jvm_artifact"})," as providing symbols within its ",(0,r.jsx)(n.code,{children:"group"}),"."]}),(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"packages"})," argument allows you to override which symbols a ",(0,r.jsx)(n.code,{children:"jvm_artifact"})," provides. See the ",(0,r.jsxs)(n.a,{href:"/2.12/reference/targets/jvm_artifact#packages",children:[(0,r.jsx)(n.code,{children:"jvm_artifact"})," docs"]})," for more information."]})]}),"\n",(0,r.jsxs)(n.h3,{id:"resource-targets",children:[(0,r.jsx)(n.code,{children:"resource"})," targets"]}),"\n",(0,r.jsxs)(n.p,{children:["To have your code ",(0,r.jsx)(n.a,{href:"https://docs.oracle.com/javase/8/docs/technotes/guides/lang/resources.html",children:'load files as "resources"'}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Add a ",(0,r.jsx)(n.code,{children:"resource"})," or ",(0,r.jsx)(n.code,{children:"resources"})," target with the relevant files in the ",(0,r.jsx)(n.code,{children:"source"})," / ",(0,r.jsx)(n.code,{children:"sources"})," field, respectively."]}),"\n",(0,r.jsxs)(n.li,{children:["Ensure that ",(0,r.jsxs)(n.a,{href:"/2.12/docs/using-pants/key-concepts/source-roots",children:["an appropriate ",(0,r.jsx)(n.code,{children:"source_root"})]})," is detected for the ",(0,r.jsx)(n.code,{children:"resources"})," target, in order to trim the relevant prefix from the filename to align with the layout of your JVM packages."]}),"\n",(0,r.jsxs)(n.li,{children:["Add that target to the ",(0,r.jsx)(n.code,{children:"dependencies"})," field of the relevant JVM target (usually the one that uses the JVM APIs to load the resource)."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"For example:"}),"\n",(0,r.jsxs)(i.A,{groupId:"code-examples",children:[(0,r.jsx)(l.A,{value:"pants.toml",label:"pants.toml",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-toml",metastring:'tab={"label":"pants.toml"}',children:'[source]\n# In order for the resource to be loadable as `org/pantsbuild/example/lib/hello.txt`,\n# the `/src/jvm/ prefix needs to be stripped.\nroot_patterns = ["/src/*"]\n'})})}),(0,r.jsx)(l.A,{value:"src/jvm/org/pantsbuild/example/lib/build",label:"src/jvm/org/pantsbuild/example/lib/BUILD",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",metastring:'tab={"label":"src/jvm/org/pantsbuild/example/lib/BUILD"}',children:'java_sources(dependencies=[":hello"])\n\nresources(name="hello", sources=["hello.txt"])\n'})})}),(0,r.jsx)(l.A,{value:"src/jvm/org/pantsbuild/example/lib/loader.java",label:"src/jvm/org/pantsbuild/example/lib/Loader.java",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",metastring:'tab={"label":"src/jvm/org/pantsbuild/example/lib/Loader.java"}',children:'package org.pantsbuild.example.lib;\n\nimport com.google.common.io.Resources;\n\npublic class Loader {\n  public static String load() {\n    ... = Resources.getResource(Loader.class, "hello.txt");\n  }\n}\n'})})}),(0,r.jsx)(l.A,{value:"src/jvm/org/pantsbuild/example/lib/hello.txt",label:"src/jvm/org/pantsbuild/example/lib/hello.txt",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",metastring:'tab={"label":"src/jvm/org/pantsbuild/example/lib/hello.txt"}',children:"Hello world!\n"})})})]}),"\n",(0,r.jsx)(n.h2,{id:"compile-code",children:"Compile code"}),"\n",(0,r.jsxs)(n.p,{children:["To manually check that sources compile, use ",(0,r.jsx)(n.code,{children:"./pants check"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# Check a single file\n\u276F ./pants check src/jvm/org/pantsbuild/example/lib/ExampleLib.java\n\n# Check files located recursively under a directory\n\u276F ./pants check src/jvm::\n\n# Check the whole repository\n\u276F ./pants check ::\n"})}),"\n",(0,r.jsx)(n.h2,{id:"run-tests",children:"Run tests"}),"\n",(0,r.jsxs)(n.p,{children:["To run tests, use ",(0,r.jsx)(n.code,{children:"./pants test"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# Run a single test file\n\u276F ./pants test tests/jvm/org/pantsbuild/example/lib/ExampleLibSpec.scala\n\n# Test all files in a directory\n\u276F ./pants test tests/jvm::\n\n# Test the whole repository\n\u276F ./pants test ::\n"})}),"\n",(0,r.jsxs)(n.p,{children:["You can also pass through arguments to the test runner with ",(0,r.jsx)(n.code,{children:"--"}),", e.g.:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# Pass `-z hello` to scalatest in order to test a single method\n\u276F ./pants test tests/jvm/org/pantsbuild/example/lib/ExampleLibSpec.scala -- -z hello\n"})}),"\n",(0,r.jsx)(n.h2,{id:"lint-and-format",children:"Lint and Format"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"scalafmt"})," and ",(0,r.jsx)(n.code,{children:"Google Java Format"})," can be enabled by adding the ",(0,r.jsx)(n.code,{children:"pants.backend.experimental.scala.lint.scalafmt"})," and ",(0,r.jsx)(n.code,{children:"pants.backend.experimental.java.lint.google_java_format"})," backends (respectively) to ",(0,r.jsx)(n.code,{children:"backend_packages"})," in the ",(0,r.jsx)(n.code,{children:"[GLOBAL]"})," section of ",(0,r.jsx)(n.code,{children:"pants.toml"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["Once enabled, ",(0,r.jsx)(n.code,{children:"lint"})," and ",(0,r.jsx)(n.code,{children:"fmt"})," will check and automatically reformat your code:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# Format this directory and all subdirectories\n\u276F ./pants fmt src/jvm::\n\n# Check that the whole project is formatted\n\u276F ./pants lint ::\n\n# Format all changed files\n\u276F ./pants --changed-since=HEAD fmt\n"})}),"\n",(0,r.jsx)(n.h2,{id:"working-in-an-ide",children:"Working in an IDE"}),"\n",(0,r.jsxs)(n.p,{children:["Pants supports loading Java and Scala projects in IntelliJ via the ",(0,r.jsx)(n.a,{href:"https://build-server-protocol.github.io/",children:"BSP protocol"})," (which should ease VSCode support ",(0,r.jsx)(n.a,{href:"https://scalameta.org/metals/docs/editors/vscode",children:"via Metals"}),", although it is not yet supported)."]}),"\n",(0,r.jsx)(n.h3,{id:"usage",children:"Usage"}),"\n",(0,r.jsx)(n.p,{children:"After Setup (see below), and after IntelliJ has finished indexing your code, you should be able to:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Use goto definition and other symbol-index-using operations."}),"\n",(0,r.jsx)(n.li,{children:"Run test classes, which will first compile them will Pants (and render compile failures if not), and then run them in the foreground with IntelliJ's test runner."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"setup",children:"Setup"}),"\n",(0,r.jsx)(n.h4,{id:"first-time-setup-per-repository",children:"First time setup (per-repository)"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Use a version of Pants containing BSP support:","\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Versions after ",(0,r.jsx)(n.code,{children:"2.12.0a0"})," support code indexing."]}),"\n",(0,r.jsxs)(n.li,{children:["Versions after ",(0,r.jsx)(n.code,{children:"2.13.0.dev2"})," support test running."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Add a ",(0,r.jsx)(n.code,{children:".gitignore"})," entry for the ",(0,r.jsx)(n.code,{children:".bsp"})," directory:"]}),"\n"]}),"\n",(0,r.jsxs)(i.A,{groupId:"code-examples",children:[(0,r.jsx)(l.A,{value:".gitignore",label:".gitignore",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",metastring:'tab={"label":".gitignore"}',children:"# This directory is not committed: each BSP user will create it independently.\n/.bsp/\n"})})}),(0,r.jsx)(l.A,{value:"...",label:"...",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",metastring:'tab={"label":"..."}'})})})]}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:'Add a "group" config file like the one below, adjusting the address specs and resolve name as appropriate.'}),"\n"]}),"\n",(0,r.jsxs)(i.A,{groupId:"code-examples",children:[(0,r.jsx)(l.A,{value:"bsp-groups.toml",label:"bsp-groups.toml",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-toml",metastring:'tab={"label":"bsp-groups.toml"}',children:'# A "group" named `default`.\n# Multiple groups are supported: consider creating a group per project or team.\n[groups.default]\naddresses =\n[\n  "src/jvm::",\n  "tests/jvm::",\n]\n\nresolve = "jvm:jvm-default"\n'})})}),(0,r.jsx)(l.A,{value:"...",label:"...",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",metastring:'tab={"label":"..."}'})})})]}),"\n",(0,r.jsxs)(n.ol,{start:"4",children:["\n",(0,r.jsxs)(n.li,{children:["Add to ",(0,r.jsx)(n.code,{children:"pants.toml"})," an option to point at the BSP configuration file:"]}),"\n"]}),"\n",(0,r.jsxs)(i.A,{groupId:"code-examples",children:[(0,r.jsx)(l.A,{value:"pants.toml",label:"pants.toml",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-toml",metastring:'tab={"label":"pants.toml"}',children:'[experimental-bsp]\ngroups_config_files = ["bsp-groups.toml"]\n'})})}),(0,r.jsx)(l.A,{value:"...",label:"...",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",metastring:'tab={"label":"..."}'})})})]}),"\n",(0,r.jsx)(n.h4,{id:"per-user-setup",children:"Per-user setup"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Run ./pants experimental-bsp to write the BSP connection file and script."}),"\n",(0,r.jsx)(n.li,{children:"Ensure that you have the IntelliJ Scala plugin installed (it provides BSP support)."}),"\n",(0,r.jsxs)(n.li,{children:["In IntelliJ, choose ",(0,r.jsx)(n.code,{children:"File > New > Project from Existing Sources\u2026"})]}),"\n",(0,r.jsx)(n.li,{children:"Choose the root of the repository for the project from the file dialog."}),"\n",(0,r.jsx)(n.li,{children:'In the "Import Project" dialog, choose "Import project from external model" and select "BSP."'}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://files.readme.io/47ad6e7-Screen_Shot_2022-05-13_at_09.40.33.png",alt:""})}),"\n",(0,r.jsxs)(n.ol,{start:"6",children:["\n",(0,r.jsx)(n.li,{children:'Click "Create".'}),"\n",(0,r.jsx)(n.li,{children:"IntelliJ will invoke Pants to run the BSP server and synchronize state to produce IntelliJ modules."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["If you see errors related to missing tools, you can set additional environment variables for BSP invocations in ",(0,r.jsx)(n.code,{children:"pants.toml"})," under the ",(0,r.jsx)(n.code,{children:"[experimental-bsp].runner_env_vars"})," option, and then re-run ",(0,r.jsx)(n.code,{children:"./pants experimental-bsp"}),".","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["This is necessary because IntelliJ is invoked on macOS generally by launchd and not from the shell. Any ",(0,r.jsx)(n.code,{children:"PATH"})," set in the shell will not be passed to the Pants BSP server in that case."]}),"\n",(0,r.jsxs)(n.li,{children:["If this is developer-specific, consider setting ",(0,r.jsx)(n.code,{children:"--experimental-bsp-runner-env-args"})," as a command-line option, or using a ",(0,r.jsx)(n.code,{children:".pantsrc"})," file."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["After configuration changes, or after adding new thirdparty dependencies, you will generally need to reload the BSP configuration (",(0,r.jsx)(n.a,{href:"https://github.com/pantsbuild/pants/issues/15054",children:"for now"}),"), which you can do with this button in the side panel:"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:"https://files.readme.io/b6db23d-Screen_Shot_2022-05-13_at_09.50.28.png",alt:""})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["When filing bug reports, include the log output of the Pants instance hosting the BSP server, which goes to ",(0,r.jsx)(n.code,{children:".pants.d/bsp/logs/stderr.log"}),"."]}),"\n"]})]})}function p(e={}){let{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}},753348(e,n,s){s.d(n,{A:()=>t});let t={tabItem:"tabItem_mHvh"}},618264(e,n,s){s.d(n,{A:()=>t});let t={tabList:"tabList_sFbf",tabItem:"tabItem_UVfV"}},637180(e,n,s){s.d(n,{A:()=>i});var t=s(886070);s(830758);var r=s(313526),a=s(753348);function i({children:e,hidden:n,className:s}){return(0,t.jsx)("div",{role:"tabpanel",className:(0,r.A)(a.A.tabItem,s),hidden:n,children:e})}},685008(e,n,s){s.d(n,{A:()=>m});var t=s(886070),r=s(830758),a=s(313526),i=s(911212),l=s(274875),o=s(106632),c=s(189223),d=s(618264);function h({className:e,block:n,selectedValue:s,selectValue:r,tabValues:i}){let o=[],{blockElementScrollPositionUntilNextRender:c}=(0,l.a_)(),h=e=>{let n=e.currentTarget,t=i[o.indexOf(n)].value;t!==s&&(c(n),r(t))},u=e=>{let n=null;switch(e.key){case"Enter":h(e);break;case"ArrowRight":{let s=o.indexOf(e.currentTarget)+1;n=o[s]??o[0];break}case"ArrowLeft":{let s=o.indexOf(e.currentTarget)-1;n=o[s]??o[o.length-1]}}n?.focus()};return(0,t.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.A)("tabs",{"tabs--block":n},e),children:i.map(({value:e,label:n,attributes:r})=>(0,t.jsx)("li",{role:"tab",tabIndex:s===e?0:-1,"aria-selected":s===e,ref:e=>{o.push(e)},onKeyDown:u,onClick:h,...r,className:(0,a.A)("tabs__item",d.A.tabItem,r?.className,{"tabs__item--active":s===e}),children:n??e},e))})}function u({lazy:e,children:n,selectedValue:s}){let i=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){let e=i.find(e=>e.props.value===s);return e?(0,r.cloneElement)(e,{className:(0,a.A)("margin-top--md",e.props.className)}):null}return(0,t.jsx)("div",{className:"margin-top--md",children:i.map((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==s}))})}function p(e){let n=(0,o.u)(e);return(0,t.jsxs)("div",{className:(0,a.A)(i.G.tabs.container,"tabs-container",d.A.tabList),children:[(0,t.jsx)(h,{...n,...e}),(0,t.jsx)(u,{...n,...e})]})}function m(e){let n=(0,c.A)();return(0,t.jsx)(p,{...e,children:(0,o.v)(e.children)},String(n))}},106632(e,n,s){s.d(n,{u:()=>h,v:()=>c});var t=s(830758),r=s(325557),a=s(363717),i=s(125740),l=s(574229),o=s(270367);function c(e){return t.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,t.isValidElement)(e)&&function(e){let{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function d({value:e,tabValues:n}){return n.some(n=>n.value===e)}function h(e){let n,{defaultValue:s,queryString:h=!1,groupId:u}=e,p=function(e){let{values:n,children:s}=e;return(0,t.useMemo)(()=>{let e=n??c(s).map(({props:{value:e,label:n,attributes:s,default:t}})=>({value:e,label:n,attributes:s,default:t})),t=(0,l.XI)(e,(e,n)=>e.value===n.value);if(t.length>0)throw Error(`Docusaurus error: Duplicate values "${t.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`);return e},[n,s])}(e),[m,j]=(0,t.useState)(()=>(function({defaultValue:e,tabValues:n}){if(0===n.length)throw Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!d({value:e,tabValues:n}))throw Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}let s=n.find(e=>e.default)??n[0];if(!s)throw Error("Unexpected error: 0 tabValues");return s.value})({defaultValue:s,tabValues:p})),[x,g]=function({queryString:e=!1,groupId:n}){let s=(0,r.W6)(),a=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,i.aZ)(a),(0,t.useCallback)(e=>{if(!a)return;let n=new URLSearchParams(s.location.search);n.set(a,e),s.replace({...s.location,search:n.toString()})},[a,s])]}({queryString:h,groupId:u}),[f,v]=function({groupId:e}){let n=e?`docusaurus.tab.${e}`:null,[s,r]=(0,o.Dv)(n);return[s,(0,t.useCallback)(e=>{n&&r.set(e)},[n,r])]}({groupId:u}),b=d({value:n=x??f,tabValues:p})?n:null;return(0,a.A)(()=>{b&&j(b)},[b]),{selectedValue:m,selectValue:(0,t.useCallback)(e=>{if(!d({value:e,tabValues:p}))throw Error(`Can't select invalid tab value=${e}`);j(e),g(e),v(e)},[g,v,p]),tabValues:p}}},848193(e,n,s){s.d(n,{R:()=>i,x:()=>l});var t=s(830758);let r={},a=t.createContext(r);function i(e){let n=t.useContext(a);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),t.createElement(a.Provider,{value:n},e.children)}},225367(e){e.exports=JSON.parse('{"id":"docs/java-and-scala/index","title":"Java and Scala overview","description":"Pants\'s support for Java and Scala.","source":"@site/versioned_docs/version-2.12/docs/java-and-scala/index.mdx","sourceDirName":"docs/java-and-scala","slug":"/docs/java-and-scala/","permalink":"/2.12/docs/java-and-scala/","draft":false,"unlisted":false,"editUrl":"https://github.com/pantsbuild/pants/edit/main/docs/docs/java-and-scala/index.mdx","tags":[],"version":"2.12","sidebarPosition":0,"frontMatter":{"title":"Java and Scala overview","sidebar_position":0},"sidebar":"docsSidebar","previous":{"title":"Protobuf","permalink":"/2.12/docs/go/integrations/protobuf"},"next":{"title":"Shell overview","permalink":"/2.12/docs/shell/"}}')}}]);
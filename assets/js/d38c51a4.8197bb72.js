"use strict";(self.webpackChunkpantsbuild_org=self.webpackChunkpantsbuild_org||[]).push([["826923"],{657634(e,t,n){n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>d});var i=n(170877),s=n(886070),r=n(848193);let l={title:"Linters and formatters",sidebar_position:4},o,a={},d=[{value:"Activating linters and formatters",id:"activating-linters-and-formatters",level:2},{value:"Configuring the tools and adding plugins",id:"configuring-the-tools-and-adding-plugins",level:2},{value:"Temporarily skipping a formatter or linter",id:"temporarily-skipping-a-formatter-or-linter",level:2},{value:"Tip: only run over changed files",id:"tip-only-run-over-changed-files",level:2}];function c(e){let t={a:"a",admonition:"admonition",code:"code",h2:"h2",hr:"hr",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.p,{children:"How to activate and use the Python linters and formatters bundled with Pants."}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h2,{id:"activating-linters-and-formatters",children:"Activating linters and formatters"}),"\n",(0,s.jsxs)(t.p,{children:["Linter/formatter support is implemented in separate ",(0,s.jsx)(t.a,{href:"/2.4/docs/using-pants/concepts/backends",children:"backends"})," so that they are easy to opt in to individually:"]}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Backend"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Tool"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"pants.backend.python.lint.bandit"})}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:[(0,s.jsx)(t.a,{href:"https://bandit.readthedocs.io/en/latest/",children:"Bandit"}),": security linter"]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"pants.backend.python.lint.black"})}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:[(0,s.jsx)(t.a,{href:"https://black.readthedocs.io/en/stable/",children:"Black"}),": code formatter"]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"pants.backend.python.lint.docformatter"})}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:[(0,s.jsx)(t.a,{href:"https://pypi.org/project/docformatter/",children:"Docformatter"}),": docstring formatter"]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"pants.backend.python.lint.flake8"})}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:[(0,s.jsx)(t.a,{href:"https://flake8.pycqa.org/en/latest/",children:"Flake8"}),": style and bug linter"]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"pants.backend.python.lint.isort"})}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:[(0,s.jsx)(t.a,{href:"https://readthedocs.org/projects/isort/",children:"isort"}),": import statement formatter"]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"pants.backend.python.lint.pylint"})}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:[(0,s.jsx)(t.a,{href:"https://www.pylint.org/",children:"Pylint"}),": style and bug linter"]})]})]})]}),"\n",(0,s.jsxs)(t.p,{children:["To enable, add the appropriate backends in ",(0,s.jsx)(t.code,{children:"pants.toml"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-toml",metastring:'title="pants.toml"',children:"[GLOBAL]\n...\nbackend_packages = [\n  'pants.backend.python',\n  'pants.backend.python.lint.black',\n  'pants.backend.python.lint.isort',\n]\n"})}),"\n",(0,s.jsxs)(t.p,{children:["You should now be able to run ",(0,s.jsx)(t.code,{children:"./pants lint"}),", and possibly ",(0,s.jsx)(t.code,{children:"./pants fmt"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"$ ./pants lint src/py/project.py\n17:54:32.51 [INFO] Completed: lint - Flake8 succeeded.\n17:54:32.70 [INFO] Completed: lint - Black succeeded.\nAll done! \u2728 \u{1F370} \u2728\n1 file would be left unchanged.\n\n17:54:33.91 [INFO] Completed: lint - isort succeeded.\n\n\u2713 Black succeeded.\n\u2713 Flake8 succeeded.\n\u2713 isort succeeded.\n"})}),"\n",(0,s.jsx)(t.admonition,{title:"How to activate MyPy",type:"note",children:(0,s.jsxs)(t.p,{children:["MyPy is run with the ",(0,s.jsx)(t.a,{href:"/2.4/docs/python/goals/typecheck",children:"typecheck goal"}),", rather than ",(0,s.jsx)(t.code,{children:"lint"}),"."]})}),"\n",(0,s.jsx)(t.h2,{id:"configuring-the-tools-and-adding-plugins",children:"Configuring the tools and adding plugins"}),"\n",(0,s.jsx)(t.p,{children:"Each formatter and linter allows you to configure"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"--version"}),": the version to use."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"--config"}),": the config file location (relative to the build root)."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"--args"}),": any command-line arguments you want to pass to the tool."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"--extra-requirements"}),": any additional libraries to install, such as any plugins."]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"For example:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-toml",metastring:'title="pants.toml"',children:'[black]\nconfig = "pyproject.toml"\n\n[docformatter]\nargs = ["--wrap-summaries=100", "--wrap-descriptions=100"]\n\n[flake8]\nconfig = "build-support/.flake8"\nversion = "flake8==3.8.0"\n# Add a Flake8 plugin:\nextra_requirements.add = ["flake8-2020"]\n'})}),"\n",(0,s.jsxs)(t.p,{children:["Run ",(0,s.jsx)(t.code,{children:"./pants help-advanced black"}),", ",(0,s.jsx)(t.code,{children:"./pants help-advanced flake8"}),", and so on for more information."]}),"\n",(0,s.jsxs)(t.admonition,{title:"Config files must be explicitly declared before Pants 2.5+",type:"caution",children:[(0,s.jsxs)(t.p,{children:["Many tools will automatically discover their config files if it's at a standard location, like isort looking for the file ",(0,s.jsx)(t.code,{children:".isort.cfg"}),". This auto-discovery does not work with Pants; you must explicitly set the ",(0,s.jsx)(t.code,{children:"--config"})," option for Pants to use the correct config file."]}),(0,s.jsx)(t.p,{children:"This was fixed in Pants 2.5."})]}),"\n",(0,s.jsxs)(t.admonition,{title:"How to use first-party Pylint plugins",type:"note",children:[(0,s.jsxs)(t.p,{children:["Pants supports custom Pylint plugins written by you. Run ",(0,s.jsx)(t.code,{children:"./pants help-advanced pylint"})," for instructions with the ",(0,s.jsx)(t.code,{children:"--pylint-source-plugins"})," option."]}),(0,s.jsxs)(t.p,{children:["If you want to write first-party plugins for other linters like Flake8, let us know on ",(0,s.jsx)(t.a,{href:"/community/members",children:"Slack"}),"."]})]}),"\n",(0,s.jsx)(t.h2,{id:"temporarily-skipping-a-formatter-or-linter",children:"Temporarily skipping a formatter or linter"}),"\n",(0,s.jsxs)(t.p,{children:["Use the ",(0,s.jsx)(t.code,{children:"--skip"})," option. For example, run:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"$ ./pants --black-skip --flake8-skip fmt ::\n"})}),"\n",(0,s.jsx)(t.h2,{id:"tip-only-run-over-changed-files",children:"Tip: only run over changed files"}),"\n",(0,s.jsx)(t.p,{children:"With formatters and linters, there is usually no need to rerun on files that have not changed."}),"\n",(0,s.jsxs)(t.p,{children:["Use the option ",(0,s.jsx)(t.code,{children:"--changed-since"})," to get much better performance, like this:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"$ ./pants --changed-since=HEAD fmt\n"})}),"\n",(0,s.jsx)(t.p,{children:"or"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"$ ./pants --changed-since=main lint\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Pants will find which files have changed and only run over those files. See ",(0,s.jsx)(t.a,{href:"/2.4/docs/using-pants/advanced-target-selection",children:"Advanced target selection"})," for more information."]})]})}function h(e={}){let{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},848193(e,t,n){n.d(t,{R:()=>l,x:()=>o});var i=n(830758);let s={},r=i.createContext(s);function l(e){let t=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),i.createElement(r.Provider,{value:t},e.children)}},170877(e){e.exports=JSON.parse('{"id":"docs/python/overview/linters-and-formatters","title":"Linters and formatters","description":"How to activate and use the Python linters and formatters bundled with Pants.","source":"@site/versioned_docs/version-2.4/docs/python/overview/linters-and-formatters.mdx","sourceDirName":"docs/python/overview","slug":"/docs/python/overview/linters-and-formatters","permalink":"/2.4/docs/python/overview/linters-and-formatters","draft":false,"unlisted":false,"editUrl":"https://github.com/pantsbuild/pants/edit/main/docs/docs/python/overview/linters-and-formatters.mdx","tags":[],"version":"2.4","sidebarPosition":4,"frontMatter":{"title":"Linters and formatters","sidebar_position":4},"sidebar":"docsSidebar","previous":{"title":"Interpreter compatibility","permalink":"/2.4/docs/python/overview/interpreter-compatibility"},"next":{"title":"Pex files","permalink":"/2.4/docs/python/overview/pex-files"}}')}}]);
"use strict";(self.webpackChunkpantsbuild_org=self.webpackChunkpantsbuild_org||[]).push([["395423"],{937318(e,t,s){s.r(t),s.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>c,frontMatter:()=>o,metadata:()=>n,toc:()=>u});var n=s(125768),i=s(886070),a=s(848193);let o={title:"Run tests",sidebar_position:7},r,l={},u=[{value:"1. Set up a tests target type",id:"1-set-up-a-tests-target-type",level:2},{value:"2. Set up a subclass of <code>TestFieldSet</code>",id:"2-set-up-a-subclass-of-testfieldset",level:2}];function d(e){let t={a:"a",admonition:"admonition",code:"code",h2:"h2",hr:"hr",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(t.p,{children:["How to add a new test runner to the ",(0,i.jsx)(t.code,{children:"test"})," goal."]}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.admonition,{title:"Example repository",type:"note",children:(0,i.jsxs)(t.p,{children:["This guide walks through adding a simple ",(0,i.jsx)(t.code,{children:"test"})," implementation for Bash that runs the ",(0,i.jsx)(t.code,{children:"shunit2"})," test runner. See ",(0,i.jsx)(t.a,{href:"https://github.com/pantsbuild/example-plugin/blob/main/pants-plugins/examples/bash/shunit2_test_runner.py",children:"here"})," for the final implementation."]})}),"\n",(0,i.jsx)(t.h2,{id:"1-set-up-a-tests-target-type",children:"1. Set up a tests target type"}),"\n",(0,i.jsxs)(t.p,{children:['Usually, you will want to add a "tests" target type for your language, such as ',(0,i.jsx)(t.code,{children:"bash_tests"})," or ",(0,i.jsx)(t.code,{children:"python_tests"}),'. A binary target contrasts with a "library" target, such as ',(0,i.jsx)(t.code,{children:"bash_library"}),". A test target is useful so that ",(0,i.jsx)(t.code,{children:"./pants test ::"})," doesn't try to run tests on non-test files."]}),"\n",(0,i.jsxs)(t.p,{children:["When creating a tests target, you should usually subclass the ",(0,i.jsx)(t.code,{children:"Sources"})," field and set the ",(0,i.jsx)(t.code,{children:"default"}),". You may also want to create a ",(0,i.jsx)(t.code,{children:"Timeout"})," field, which should subclass ",(0,i.jsx)(t.code,{children:"IntField"}),"."]}),"\n",(0,i.jsxs)(t.p,{children:["See ",(0,i.jsx)(t.a,{href:"/2.7/docs/writing-plugins/the-target-api/creating-new-targets",children:"Creating new targets"})," for a guide on how to define new target types."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-python",children:'from pants.engine.target import COMMON_TARGET_FIELDS, Dependencies, IntField, Sources, Target\n\nclass BashSources(Sources):\n    expected_file_extensions = (".sh",)\n\n\nclass BashTestSources(BashSources):\n    default = ("*_test.sh", "test_*.sh")\n\n\nclass BashTestTimeout(IntField):\n     """Whether to time out after a certain amount of time.\n\n      If unset, the test will never time out.\n      """\n\n     alias = "timeout"\n\n\nclass BashTests(Target):\n    """Bash tests that are run via `shunit2`."""\n\n    alias = "bash_tests"\n    core_fields = (*COMMON_TARGET_FIELDS, Dependencies, BashTestSources, BashTestTimeout)\n\n'})}),"\n",(0,i.jsxs)(t.h2,{id:"2-set-up-a-subclass-of-testfieldset",children:["2. Set up a subclass of ",(0,i.jsx)(t.code,{children:"TestFieldSet"})]})]})}function c(e={}){let{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},848193(e,t,s){s.d(t,{R:()=>o,x:()=>r});var n=s(830758);let i={},a=n.createContext(i);function o(e){let t=n.useContext(a);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),n.createElement(a.Provider,{value:t},e.children)}},125768(e){e.exports=JSON.parse('{"id":"docs/writing-plugins/common-plugin-tasks/run-tests","title":"Run tests","description":"How to add a new test runner to the test goal.","source":"@site/versioned_docs/version-2.7/docs/writing-plugins/common-plugin-tasks/run-tests.mdx","sourceDirName":"docs/writing-plugins/common-plugin-tasks","slug":"/docs/writing-plugins/common-plugin-tasks/run-tests","permalink":"/2.7/docs/writing-plugins/common-plugin-tasks/run-tests","draft":false,"unlisted":false,"editUrl":"https://github.com/pantsbuild/pants/edit/main/docs/docs/writing-plugins/common-plugin-tasks/run-tests.mdx","tags":[],"version":"2.7","sidebarPosition":7,"frontMatter":{"title":"Run tests","sidebar_position":7},"sidebar":"docsSidebar","previous":{"title":"Add a REPL","permalink":"/2.7/docs/writing-plugins/common-plugin-tasks/add-a-repl"},"next":{"title":"Custom `setup_py()` kwargs","permalink":"/2.7/docs/writing-plugins/common-plugin-tasks/custom-setup-py-kwargs"}}')}}]);
"use strict";(self.webpackChunkpantsbuild_org=self.webpackChunkpantsbuild_org||[]).push([["343851"],{520556(e,n,t){t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>d});var i=t(469266),s=t(886070),o=t(848193);let a={authors:["eric"],tags:["announcement","golang-2"]},r="Pants 2.8 adds experimental Golang support",l={authorsImageUrls:[void 0]},d=[{value:"What is Pants?",id:"what-is-pants",level:2},{value:"Why Pants for Go?",id:"why-pants-for-go",level:2},{value:"A consistent interface for all languages &amp; tools in your repository",id:"a-consistent-interface-for-all-languages--tools-in-your-repository",level:3},{value:"Integration with Git + advanced project introspection",id:"integration-with-git--advanced-project-introspection",level:3},{value:"Remote caching and execution",id:"remote-caching-and-execution",level:3},{value:"Minimal boilerplate",id:"minimal-boilerplate",level:3},{value:"Trying out Go support",id:"trying-out-go-support",level:2},{value:"What&#39;s upcoming",id:"whats-upcoming",level:2}];function c(e){let n={a:"a",code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components},{CaptionedImg:i}=n;return i||function(e,n){throw Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("CaptionedImg",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i,{src:t(233362).A}),"\n",(0,s.jsx)(n.p,{children:"Why Pants for Golang? A consistent interface for all languages & tools, integration with Git + advanced project introspection, and remote caching and execution. All with minimal boilerplate."}),"\n","\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.p,{children:["The open source ",(0,s.jsx)(n.a,{href:"https://www.pantsbuild.org/",children:"Pants build system"})," adds experimental Golang support to Pants 2.8, in addition to already supporting Python, Shell, and Docker!"]}),"\n",(0,s.jsx)(n.h2,{id:"what-is-pants",children:"What is Pants?"}),"\n",(0,s.jsx)(n.p,{children:"Pants is a state-of-the-art software workflow system. It orchestrates the various tools you use during iterative development and CI\u2014compilers, testing frameworks, linters, formatters, and packagers\u2014installing, configuring, sequencing, and invoking them in just the right way to create the desired outputs."}),"\n",(0,s.jsx)(n.p,{children:"Pants applies fine-grained invalidation, caching, and concurrency to speed up your builds and other workflows, and it uses static analysis to minimize the amount of metadata and other boilerplate required to achieve this."}),"\n",(0,s.jsx)(n.h2,{id:"why-pants-for-go",children:"Why Pants for Go?"}),"\n",(0,s.jsx)(n.p,{children:"Go's built-in tooling is already excellent! Many projects may be fine using only Go's tooling, although Pants offers some unique benefits:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"A consistent interface for all languages and tools in your repository."}),"\n",(0,s.jsx)(n.li,{children:"Integration with Git + advanced project management."}),"\n",(0,s.jsx)(n.li,{children:"Remote caching and execution."}),"\n",(0,s.jsx)(n.li,{children:"Unlike legacy build systems, these benefits all come with minimal boilerplate."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"a-consistent-interface-for-all-languages--tools-in-your-repository",children:"A consistent interface for all languages & tools in your repository"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"./pants fmt ::"})," \xa0 runs all formatters."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"./pants lint ::"})," runs all linters and formatters (in check-mode) in parallel."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"./pants test ::"})," runs all tests in parallel, regardless of language and test framework."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"./pants check ::"})," runs all compilation and type checkers like MyPy in parallel."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"./pants package ::"})," builds all binaries, e.g. Go binaries and Python wheels. (Also see ",(0,s.jsx)(n.a,{href:"/blog/2021/10/13/pants-pex-and-docker",children:"Streamline your Docker builds with Pants"}),")"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell-session",children:"$ ./pants lint ::\n16:28:34.37 [ERROR] Completed: Lint with gofmt - gofmt failed (exit code 1).\nThe following Go files require formatting:\ntestprojects/src/go/pants_test/bar/bar.go\ntestprojects/src/go/pants_test/foo.go\n16:28:36.70 [INFO] Completed: Lint with Shellcheck - Shellcheck succeeded.\n16:28:42.69 [INFO] Completed: Lint with Black - Black succeeded.\nAll done! \u2728 \u{1F370} \u2728\n747 files would be left unchanged.\n16:28:53.63 [INFO] Completed: Lint with Flake8 - Flake8 succeeded.\n\u2713 Black succeeded.\n\u2713 Flake8 succeeded.\n\u2713 Shellcheck succeeded.\n\u2715 gofmt failed.\n"})}),"\n",(0,s.jsx)(n.h3,{id:"integration-with-git--advanced-project-introspection",children:"Integration with Git + advanced project introspection"}),"\n",(0,s.jsx)(n.p,{children:"Pants integrates with Git to allow you to, for example, only format and lint changed files:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell-session",children:"./pants --changed-since=HEAD fmt\n./pants --changed-since=upstream/main lint\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Pants can combine this integration with Git with its ",(0,s.jsx)(n.a,{href:"https://www.pantsbuild.org/v2.8/docs/project-introspection",children:"advanced project introspection"}),". For example, to only run tests that could have possibly been changed:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell-session",children:"./pants --changed-since=HEAD --changed-dependees=transitive test\n"})}),"\n",(0,s.jsx)(n.p,{children:"That is, Pants will only run tests when their package or any transitive dependency was changed."}),"\n",(0,s.jsx)(n.p,{children:"You can also use Pants's project introspection to better understand your dependency graph, such as identifying which code will be impacted by updating a third-party dependency:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell-session",children:"$ ./pants dependees --transitive //:mod#github.com/google/uuid\ncmd/greeter_en\ncmd/greeter_es\npkg/greeter\npkg/uuid\n"})}),"\n",(0,s.jsx)(n.h3,{id:"remote-caching-and-execution",children:"Remote caching and execution"}),"\n",(0,s.jsx)(n.p,{children:"Like Go, Pants locally caches each step of your build so that once you compile a package or run a package's tests, for example, you don't need to run it again unless that package or any of its transitive dependencies have changed."}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://www.pantsbuild.org/docs/remote-caching-execution",children:"Remote caching"})," allows you to share this same cache amongst your CI runs and amongst your local team so that you don't have to redo work that others on your team have already done\u2014like running tests and downloading third-party dependencies."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://www.pantsbuild.org/docs/remote-caching-execution",children:"Remote execution"})," allows you to run your builds directly in the cloud with low-latency workers for extreme parallelism, such as running your entire test suite in total parallelism."]}),"\n",(0,s.jsx)(n.h3,{id:"minimal-boilerplate",children:"Minimal boilerplate"}),"\n",(0,s.jsx)(n.p,{children:"Unlike previous-generation build tools like Bazel, Pants 2's benefits come with minimal boilerplate."}),"\n",(0,s.jsxs)(n.p,{children:["To get set up, add just four lines to the ",(0,s.jsx)(n.code,{children:"pants.toml"})," config file:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-toml",children:'[GLOBAL]\nbackend_packages = ["pants.backend.experimental.go"]\n\n[golang]\nexpected_version = "1.17"\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Then run ",(0,s.jsx)(n.code,{children:"./pants tailor"})," to generate a couple of one-line ",(0,s.jsx)(n.code,{children:"BUILD"})," files:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell-session",children:'$ ./pants tailor\nCreated BUILD:\n- Added go_mod target root\nCreated cmd/deploy/BUILD:\n- Added go_binary target bin\nCreated cmd/runner/BUILD:\n- Added go_binary target bin\n\n# BUILD\ngo_mod()\n\n# cmd/deploy/BUILD\ngo_binary(name="bin")\n'})}),"\n",(0,s.jsxs)(n.p,{children:["In contrast, Bazel ",(0,s.jsx)(n.code,{children:"BUILD"})," files often have 30-100+ lines per-directory, requiring you to enumerate every import your package has and every package provided by your third-party modules."]}),"\n",(0,s.jsxs)(n.p,{children:["With Bazel, whenever you change your code's imports or your third-party dependencies, you have to update your ",(0,s.jsx)(n.code,{children:"BUILD"})," files saved on-disk, usually by running a different tool called Gazelle."]}),"\n",(0,s.jsxs)(n.p,{children:["Instead, with Pants, there is no need to update ",(0,s.jsx)(n.code,{children:"BUILD"})," files. Pants uses this initial setup to analyze dependencies on startup, based on your ",(0,s.jsx)(n.code,{children:"require"})," directives in ",(0,s.jsx)(n.code,{children:"go.mod"})," and ",(0,s.jsx)(n.code,{children:"go.sum"}),", and the import statements in first-party ",(0,s.jsx)(n.code,{children:".go"})," files in your project."]}),"\n",(0,s.jsx)(n.h2,{id:"trying-out-go-support",children:"Trying out Go support"}),"\n",(0,s.jsxs)(n.p,{children:["Check out the ",(0,s.jsx)(n.a,{href:"https://github.com/pantsbuild/example-golang",children:"example-golang repository"})," to try out Pants 2.8's Go support! And let us know what you think in ",(0,s.jsx)(n.a,{href:"https://www.pantsbuild.org/docs/getting-help",children:"Slack"})," and ",(0,s.jsx)(n.a,{href:"https://github.com/pantsbuild/pants/issues",children:"GitHub"}),"!"]}),"\n",(0,s.jsxs)(n.p,{children:["To use Pants with your project, check out our ",(0,s.jsx)(n.a,{href:"https://www.pantsbuild.org/v2.8/docs/getting-started",children:"Getting started guide"})," and our ",(0,s.jsx)(n.a,{href:"https://www.pantsbuild.org/v2.8/docs/go-overview",children:"Golang docs"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"whats-upcoming",children:"What's upcoming"}),"\n",(0,s.jsx)(n.p,{children:"We plan to make Pants's Go support more comprehensive in Pants 2.9, before the end of 2021. Some features we have planned:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"The embed directive / resources"}),"\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.code,{children:"testdata"})," folder"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"go vet"})}),"\n",(0,s.jsx)(n.li,{children:"Vendoring"}),"\n",(0,s.jsx)(n.li,{children:"Finalizing the layout of target definitions in BUILD files"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["We would ",(0,s.jsx)(n.a,{href:"https://www.pantsbuild.org/docs/getting-help",children:"love your feedback"})," on what features your project needs to build with Pants, along with any bug reports. For example, while these features are not yet currently on the roadmap, they can be bumped based on community input:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Cgo files"}),"\n",(0,s.jsxs)(n.li,{children:["Non-Go file types, like ",(0,s.jsx)(n.code,{children:".h"})," files (",(0,s.jsx)(n.code,{children:".s"})," assembly files are already supported)"]}),"\n",(0,s.jsxs)(n.li,{children:["Multiple ",(0,s.jsx)(n.code,{children:"go.mod"})," projects in the same repository"]}),"\n",(0,s.jsx)(n.li,{children:"Protobuf support"}),"\n"]})]})}function h(e={}){let{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},233362(e,n,t){t.d(n,{A:()=>i});let i=t.p+"assets/images/splash-0d934b7cffc41f522a31b409940bc90e.jpg"},848193(e,n,t){t.d(n,{R:()=>a,x:()=>r});var i=t(830758);let s={},o=i.createContext(s);function a(e){let n=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(o.Provider,{value:n},e.children)}},469266(e){e.exports=JSON.parse('{"permalink":"/blog/2021/11/10/golang-support-pants-28","editUrl":"https://github.com/pantsbuild/pantsbuild.org/edit/main/blog/2021-11-10-golang-support-pants-28/index.mdx","source":"@site/blog/2021-11-10-golang-support-pants-28/index.mdx","title":"Pants 2.8 adds experimental Golang support","description":"Why Pants for Golang? A consistent interface for all languages & tools, integration with Git + advanced project introspection, and remote caching and execution. All with minimal boilerplate.","date":"2021-11-10T00:00:00.000Z","tags":[{"inline":true,"label":"announcement","permalink":"/blog/tags/announcement"},{"inline":true,"label":"golang-2","permalink":"/blog/tags/golang-2"}],"readingTime":4.97,"hasTruncateMarker":true,"authors":[{"name":"Eric Arellano","title":"Pants Maintainer","url":"https://github.com/Eric-Arellano","imageURL":"https://github.com/Eric-Arellano.png","key":"eric","page":null}],"frontMatter":{"authors":["eric"],"tags":["announcement","golang-2"]},"unlisted":false,"prevItem":{"title":"Pants 2.8 adds Autoflake & Pyupgrade, Docker publishing, Golang, and Google Cloud Functions","permalink":"/blog/2021/11/17/introducing-pants-2-8"},"nextItem":{"title":"Pants supports PEP 517","permalink":"/blog/2021/10/27/pants-supports-pep-517"}}')}}]);
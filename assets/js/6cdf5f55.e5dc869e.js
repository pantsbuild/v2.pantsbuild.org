"use strict";(self.webpackChunkpantsbuild_org=self.webpackChunkpantsbuild_org||[]).push([["432020"],{267475(e,n,t){t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>c});var s=t(752726),o=t(886070),l=t(848193);let i={title:"Project introspection",sidebar_position:4},r,d={},c=[{value:"<code>list</code> - find your project&#39;s targets",id:"list---find-your-projects-targets",level:2},{value:"<code>filter</code> - find targets that match a predicate",id:"filter---find-targets-that-match-a-predicate",level:2},{value:"<code>filter --target-type</code>",id:"filter---target-type",level:3},{value:"<code>filter --address-regex</code>",id:"filter---address-regex",level:3},{value:"<code>filter --tag-regex</code>",id:"filter---tag-regex",level:3},{value:"<code>dependencies</code> - find a target&#39;s dependencies",id:"dependencies---find-a-targets-dependencies",level:2},{value:"<code>dependees</code> - find which targets depend on a target",id:"dependees---find-which-targets-depend-on-a-target",level:2},{value:"<code>filedeps</code> - find which files a target owns",id:"filedeps---find-which-files-a-target-owns",level:2},{value:"<code>count-loc</code> - count lines of code",id:"count-loc---count-lines-of-code",level:2}];function a(e){let n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",hr:"hr",mdxAdmonitionTitle:"mdxAdmonitionTitle",p:"p",pre:"pre",...(0,l.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.p,{children:"Finding insights in your project."}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.p,{children:"Pants provides several goals to provide insights into your project's structure."}),"\n",(0,o.jsxs)(n.admonition,{type:"note",children:[(0,o.jsxs)(n.mdxAdmonitionTitle,{children:["Tip: Use ",(0,o.jsx)(n.code,{children:"xargs"})," to pipe these goals into other Pants commands"]}),(0,o.jsx)(n.p,{children:"For example:"}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"$ ./pants dependees project:lib | xargs ./pants test\n"})}),(0,o.jsxs)(n.p,{children:["See ",(0,o.jsx)(n.a,{href:"/2.2/docs/using-pants/advanced-target-selection",children:"Advanced target selection"})," for more info and other techniques to use the results."]})]}),"\n",(0,o.jsxs)(n.h2,{id:"list---find-your-projects-targets",children:[(0,o.jsx)(n.code,{children:"list"})," - find your project's targets"]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"list"})," will find all targets that match the arguments."]}),"\n",(0,o.jsx)(n.p,{children:"For example, to show all targets in your project:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"$ ./pants list ::\n//:ansicolors\n//:setuptools\nhelloworld:config\nhelloworld:config_file\n...\n"})}),"\n",(0,o.jsxs)(n.h2,{id:"filter---find-targets-that-match-a-predicate",children:[(0,o.jsx)(n.code,{children:"filter"})," - find targets that match a predicate"]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"filter"})," is like ",(0,o.jsx)(n.code,{children:"list"}),", but will only include targets that match the predicate(s)."]}),"\n",(0,o.jsxs)(n.p,{children:["Specify a predicate by using one of the below ",(0,o.jsx)(n.code,{children:"filter"})," options, like ",(0,o.jsx)(n.code,{children:"--target-type"}),". You can use a comma to OR multiple values, meaning that at least one member must be matched. You can repeat the option multiple times to AND each filter. You can prefix the filter with ",(0,o.jsx)(n.code,{children:"-"})," to negate the filter, meaning that the target must not be true for the filter."]}),"\n",(0,o.jsx)(n.p,{children:"Some examples:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# Only `python_library` targets.\n./pants filter --target-type=python_library ::\n\n# `python_library` or `python_tests` targets.\n./pants filter --target-type='python_library,python_tests' ::\n\n# `python_library` targets which have \"type_checked\" in their `tags` field.\n./pants filter --target-type=python_library --tag-regex=type_checked ::\n\n# Any target except for `python_library` targets\n./pants filter --target-type='-python_library' ::\n"})}),"\n",(0,o.jsx)(n.h3,{id:"filter---target-type",children:(0,o.jsx)(n.code,{children:"filter --target-type"})}),"\n",(0,o.jsxs)(n.p,{children:["Each value should be the name of a target type, e.g. ",(0,o.jsx)(n.code,{children:"python_library"})," or ",(0,o.jsx)(n.code,{children:"resources"}),". Run ",(0,o.jsx)(n.code,{children:"./pants help targets"})," to see what targets are registered."]}),"\n",(0,o.jsx)(n.h3,{id:"filter---address-regex",children:(0,o.jsx)(n.code,{children:"filter --address-regex"})}),"\n",(0,o.jsxs)(n.p,{children:["Regex strings for the address, such as ",(0,o.jsx)(n.code,{children:"^dir"})," or ",(0,o.jsx)(n.code,{children:":util$"}),"."]}),"\n",(0,o.jsx)(n.h3,{id:"filter---tag-regex",children:(0,o.jsx)(n.code,{children:"filter --tag-regex"})}),"\n",(0,o.jsxs)(n.p,{children:["Regex strings for the ",(0,o.jsx)(n.code,{children:"tags"})," field. Alternatively, you can use the global ",(0,o.jsx)(n.code,{children:"--tags"})," option, which uses exact string matches instead of regex. See ",(0,o.jsx)(n.a,{href:"/2.2/docs/using-pants/advanced-target-selection",children:"Advanced target selection"}),"."]}),"\n",(0,o.jsxs)(n.h2,{id:"dependencies---find-a-targets-dependencies",children:[(0,o.jsx)(n.code,{children:"dependencies"})," - find a target's dependencies"]}),"\n",(0,o.jsxs)(n.p,{children:["Use ",(0,o.jsx)(n.code,{children:"dependencies"})," to list all targets used directly by a target."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"$ ./pants dependencies helloworld/util\n//:setuptools\n//:translate\nhelloworld/protos:protos\n"})}),"\n",(0,o.jsxs)(n.p,{children:["To include transitive dependencies\u2014meaning the dependencies of the direct dependencies\u2014use ",(0,o.jsx)(n.code,{children:"--transitive"}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"$ ./pants dependencies --transitive helloworld/util\n//:protobuf\n//:requirements.txt\n//:setuptools\n//:translate\nhelloworld/protos:protos\n"})}),"\n",(0,o.jsxs)(n.p,{children:["You can also output your 3rdparty requirements (e.g. Python requirement strings) by using ",(0,o.jsx)(n.code,{children:"--type=3rdparty"})," or ",(0,o.jsx)(n.code,{children:"--type=source-and-3rdparty"}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"$ ./pants dependencies --type=3rdparty helloworld/util\nsetuptools>=42.0.0\ntranslate>=3.2.1\n"})}),"\n",(0,o.jsxs)(n.h2,{id:"dependees---find-which-targets-depend-on-a-target",children:[(0,o.jsx)(n.code,{children:"dependees"})," - find which targets depend on a target"]}),"\n",(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.code,{children:"dependees"})," goal finds all targets that directly depend on the target you specify."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"$ ./pants dependees helloworld/util\nhelloworld:config\nhelloworld/greet:greet\nhelloworld/util:tests\n"})}),"\n",(0,o.jsxs)(n.p,{children:["To include transitive dependees\u2014meaning targets that don't directly depend on your target, but which depend on a target that does directly use your target\u2014use ",(0,o.jsx)(n.code,{children:"--transitive"}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"$ ./pants dependees --transitive helloworld/util\nhelloworld:config\nhelloworld:helloworld\nhelloworld:helloworld-awslambda\nhelloworld/greet:greet\nhelloworld/greet:tests\nhelloworld/util:tests\n"})}),"\n",(0,o.jsxs)(n.p,{children:["To include the original target itself, use ",(0,o.jsx)(n.code,{children:"--closed"}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"$ ./pants dependees --closed helloworld/util\nhelloworld:config\nhelloworld/greet:greet\nhelloworld/util:tests\nhelloworld/util:util\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Finally, we recommend ",(0,o.jsx)(n.code,{children:"--output-format=json"})," when using multiple input targets:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'$ ./pants dependees --output-format=json helloworld/util helloworld/protos\n{\n    "helloworld/protos:protos": [\n        "helloworld/util:util",\n        "helloworld:config"\n    ],\n    "helloworld/util:util": [\n        "helloworld/greet:greet",\n        "helloworld/util:tests",\n        "helloworld:config"\n    ]\n}\n'})}),"\n",(0,o.jsxs)(n.admonition,{type:"note",children:[(0,o.jsxs)(n.mdxAdmonitionTitle,{children:["Tip: use ",(0,o.jsx)(n.code,{children:"dependees"})," when starting a big migration"]}),(0,o.jsxs)(n.p,{children:["Running ",(0,o.jsx)(n.code,{children:"./pants dependees --transitive --output-format=json ::"})," will allow you to find the most-depended on code in your project, such as util code. Often, you will want to convert these targets first."]}),(0,o.jsxs)(n.p,{children:["For example, do this when ",(0,o.jsx)(n.a,{href:"/2.2/docs/python/overview/interpreter-compatibility",children:"migrating from Python 2 to Python 3"}),", or adding an incremental type checker like MyPy or TypeScript to your project."]})]}),"\n",(0,o.jsxs)(n.h2,{id:"filedeps---find-which-files-a-target-owns",children:[(0,o.jsx)(n.code,{children:"filedeps"})," - find which files a target owns"]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"filedeps"})," outputs all of the files belonging to a target, based on its ",(0,o.jsx)(n.code,{children:"sources"})," field."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"$ ./pants filedeps helloworld/util\nhelloworld/util/BUILD\nhelloworld/util/config_loader.py\nhelloworld/util/lang.py\n"})}),"\n",(0,o.jsxs)(n.p,{children:["To output absolute paths, use the option ",(0,o.jsx)(n.code,{children:"--absolute"}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"$ ./pants filedeps --absolute helloworld/util\n/Users/pantsbuild/example-python/helloworld/util/BUILD\n/Users/pantsbuild/example-python/helloworld/util/config_loader.py\n/Users/pantsbuild/example-python/helloworld/util/lang.py\n"})}),"\n",(0,o.jsxs)(n.p,{children:["To include the files used by dependencies (including transitive dependencies), use ",(0,o.jsx)(n.code,{children:"--transitive"}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"$ ./pants filedeps --transitive helloworld/util\nBUILD\nhelloworld/protos/BUILD\nhelloworld/protos/config.proto\nhelloworld/util/BUILD\nhelloworld/util/config_loader.py\nhelloworld/util/lang.py\nrequirements.txt\n"})}),"\n",(0,o.jsxs)(n.h2,{id:"count-loc---count-lines-of-code",children:[(0,o.jsx)(n.code,{children:"count-loc"})," - count lines of code"]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"count-loc"})," counts the lines of code of the specified files by running the ",(0,o.jsx)(n.a,{href:"https://github.com/boyter/scc",children:"Succinct Code Counter"})," tool."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-text",metastring:'title="Shell"',children:"$ ./pants count-loc '**/*.py' '**/*.proto'\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nLanguage                 Files     Lines   Blanks  Comments     Code Complexity\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nPython                      13       155       50        22       83          5\nProtocol Buffers             1        11        3         2        6          0\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nTotal                       14       166       53        24       89          5\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n"})}),"\n",(0,o.jsxs)(n.p,{children:["SCC has ",(0,o.jsx)(n.a,{href:"https://github.com/boyter/scc#usage",children:"dozens of options"}),". You can pass through options by either setting ",(0,o.jsx)(n.code,{children:"--scc-args"})," or using ",(0,o.jsx)(n.code,{children:"--"})," at the end of your command, like this:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"./pants count-loc '**' -- --no-cocomo\n"})}),"\n",(0,o.jsxs)(n.admonition,{type:"caution",children:[(0,o.jsxs)(n.mdxAdmonitionTitle,{children:["See unexpected results? Set ",(0,o.jsx)(n.code,{children:"pants_ignore"}),"."]}),(0,o.jsxs)(n.p,{children:["By default, Pants will ignore all globs specified in your ",(0,o.jsx)(n.code,{children:".gitignore"}),", along with ",(0,o.jsx)(n.code,{children:"dist/"})," and any hidden files."]}),(0,o.jsxs)(n.p,{children:["To ignore additional files, add to the global option ",(0,o.jsx)(n.code,{children:"pants_ignore"})," in your ",(0,o.jsx)(n.code,{children:"pants.toml"}),", using the same ",(0,o.jsx)(n.a,{href:"https://git-scm.com/docs/gitignore",children:"syntax"})," as ",(0,o.jsx)(n.code,{children:".gitignore"})," files."]}),(0,o.jsx)(n.p,{children:"For example:"}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-toml",children:'[GLOBAL]\npants_ignore.add = ["/ignore_this_dir/"]\n'})})]})]})}function h(e={}){let{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(a,{...e})}):a(e)}},848193(e,n,t){t.d(n,{R:()=>i,x:()=>r});var s=t(830758);let o={},l=s.createContext(o);function i(e){let n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),s.createElement(l.Provider,{value:n},e.children)}},752726(e){e.exports=JSON.parse('{"id":"docs/using-pants/project-introspection","title":"Project introspection","description":"Finding insights in your project.","source":"@site/versioned_docs/version-2.2/docs/using-pants/project-introspection.mdx","sourceDirName":"docs/using-pants","slug":"/docs/using-pants/project-introspection","permalink":"/2.2/docs/using-pants/project-introspection","draft":false,"unlisted":false,"editUrl":"https://github.com/pantsbuild/pants/edit/main/docs/docs/using-pants/project-introspection.mdx","tags":[],"version":"2.2","sidebarPosition":4,"frontMatter":{"title":"Project introspection","sidebar_position":4},"sidebar":"docsSidebar","previous":{"title":"Proxies","permalink":"/2.2/docs/using-pants/troubleshooting-common-issues/proxies"},"next":{"title":"Resources and archives","permalink":"/2.2/docs/using-pants/resources-and-archives"}}')}}]);
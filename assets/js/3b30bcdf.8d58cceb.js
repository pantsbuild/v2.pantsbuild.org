"use strict";(self.webpackChunkpantsbuild_org=self.webpackChunkpantsbuild_org||[]).push([["415743"],{13878(e,t,s){s.r(t),s.d(t,{assets:()=>a,contentTitle:()=>c,default:()=>u,frontMatter:()=>l,metadata:()=>i,toc:()=>h});var i=s(940349),n=s(886070),r=s(848193),o=s(989898),d=s(375002);let l={title:"pex_binary",description:"A Python target that can be converted into an executable PEX file.\n"},c,a={},h=[{value:"<code>args</code>",id:"args",level:2},{value:"<code>check</code>",id:"check",level:2},{value:"<code>complete_platforms</code>",id:"complete_platforms",level:2},{value:"<code>dependencies</code>",id:"dependencies",level:2},{value:"<code>description</code>",id:"description",level:2},{value:"<code>emit_warnings</code>",id:"emit_warnings",level:2},{value:"<code>entry_point</code>",id:"entry_point",level:2},{value:"<code>env</code>",id:"env",level:2},{value:"<code>environment</code>",id:"environment",level:2},{value:"<code>executable</code>",id:"executable",level:2},{value:"<code>execution_mode</code>",id:"execution_mode",level:2},{value:"<code>extra_build_args</code>",id:"extra_build_args",level:2},{value:"<code>ignore_errors</code>",id:"ignore_errors",level:2},{value:"<code>include_requirements</code>",id:"include_requirements",level:2},{value:"<code>include_sources</code>",id:"include_sources",level:2},{value:"<code>include_tools</code>",id:"include_tools",level:2},{value:"<code>inherit_path</code>",id:"inherit_path",level:2},{value:"<code>interpreter_constraints</code>",id:"interpreter_constraints",level:2},{value:"<code>layout</code>",id:"layout",level:2},{value:"<code>output_path</code>",id:"output_path",level:2},{value:"<code>resolve</code>",id:"resolve",level:2},{value:"<code>restartable</code>",id:"restartable",level:2},{value:"<code>scie</code>",id:"scie",level:2},{value:"<code>scie_args</code>",id:"scie_args",level:2},{value:"<code>scie_bind_resource_path</code>",id:"scie_bind_resource_path",level:2},{value:"<code>scie_busybox</code>",id:"scie_busybox",level:2},{value:"<code>scie_env</code>",id:"scie_env",level:2},{value:"<code>scie_exe</code>",id:"scie_exe",level:2},{value:"<code>scie_hash_alg</code>",id:"scie_hash_alg",level:2},{value:"<code>scie_load_dotenv</code>",id:"scie_load_dotenv",level:2},{value:"<code>scie_name_style</code>",id:"scie_name_style",level:2},{value:"<code>scie_pbs_debug</code>",id:"scie_pbs_debug",level:2},{value:"<code>scie_pbs_free_threaded</code>",id:"scie_pbs_free_threaded",level:2},{value:"<code>scie_pbs_release</code>",id:"scie_pbs_release",level:2},{value:"<code>scie_pbs_stripped</code>",id:"scie_pbs_stripped",level:2},{value:"<code>scie_pex_entrypoint_env_passthrough</code>",id:"scie_pex_entrypoint_env_passthrough",level:2},{value:"<code>scie_platform</code>",id:"scie_platform",level:2},{value:"<code>scie_python_version</code>",id:"scie_python_version",level:2},{value:"<code>script</code>",id:"script",level:2},{value:"<code>sh_boot</code>",id:"sh_boot",level:2},{value:"<code>shebang</code>",id:"shebang",level:2},{value:"<code>strip_pex_env</code>",id:"strip_pex_env",level:2},{value:"<code>tags</code>",id:"tags",level:2},{value:"<code>venv_hermetic_scripts</code>",id:"venv_hermetic_scripts",level:2},{value:"<code>venv_site_packages_copies</code>",id:"venv_site_packages_copies",level:2}];function p(e){let t={a:"a",code:"code",em:"em",h2:"h2",hr:"hr",li:"li",ol:"ol",p:"p",ul:"ul",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.p,{children:"A Python target that can be converted into an executable PEX file."}),"\n",(0,n.jsxs)(t.p,{children:["PEX files are self-contained executable files that contain a complete Python environment capable of running the target. For more information, see ",(0,n.jsx)(t.a,{href:"https://www.pantsbuild.org/2.32/docs/python/overview/pex",children:"https://www.pantsbuild.org/2.32/docs/python/overview/pex"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:["Backend: ",(0,n.jsx)("span",{className:"color--primary",children:(0,n.jsx)(t.code,{children:"pants.backend.python"})})]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsxs)("span",{className:d.A.options,children:[(0,n.jsx)(t.h2,{id:"args",children:(0,n.jsx)(t.code,{children:"args"})}),(0,n.jsxs)(o.A,{type_repr:"Iterable[str] | None",default_repr:"None",children:[(0,n.jsx)(t.p,{children:"Freeze these command-line args into the PEX. Allows you to run generic entry points on specific arguments without creating a shim file."}),(0,n.jsxs)(t.p,{children:["This is different to ",(0,n.jsx)(t.code,{children:"extra_build_args"}),": ",(0,n.jsx)(t.code,{children:"args"})," records arguments used by the packaged PEX when executed, ",(0,n.jsx)(t.code,{children:"extra_build_args"})," passes arguments to the process that does the packaging."]})]}),(0,n.jsx)(t.h2,{id:"check",children:(0,n.jsx)(t.code,{children:"check"})}),(0,n.jsx)(o.A,{type_repr:"'error' | 'none' | 'warn' | None",default_repr:"'warn'",children:(0,n.jsxs)(t.p,{children:["Check that the built PEX is valid. Currently this only applies to ",(0,n.jsx)(t.code,{children:"--layout zipapp"})," where the PEX zip is tested for importability of its ",(0,n.jsx)(t.code,{children:"__main__"})," module by the Python zipimport module. This check will fail for PEX zips that use ZIP64 extensions since the Python zipimport zipimporter only works with 32 bit zips. The check no-ops for all other layouts."]})}),(0,n.jsx)(t.h2,{id:"complete_platforms",children:(0,n.jsx)(t.code,{children:"complete_platforms"})}),(0,n.jsxs)(o.A,{type_repr:"Iterable[str] | None",default_repr:"None",children:[(0,n.jsx)(t.p,{children:"The platforms the built PEX should be compatible with."}),(0,n.jsx)(t.p,{children:"There must be built wheels available for all of the foreign platforms, rather than sdists."}),(0,n.jsx)(t.p,{children:"You can give a list of multiple complete platforms to create a multiplatform PEX, meaning that the PEX will be executable in all of the supported environments."}),(0,n.jsxs)(t.p,{children:["Complete platforms should be addresses of ",(0,n.jsx)(t.code,{children:"file"})," or ",(0,n.jsx)(t.code,{children:"resource"})," targets that point to files that contain complete platform JSON as described by Pex (",(0,n.jsx)(t.a,{href:"https://pex.readthedocs.io/en/latest/buildingpex.html#complete-platform",children:"https://pex.readthedocs.io/en/latest/buildingpex.html#complete-platform"}),")."]}),(0,n.jsxs)(t.p,{children:["See ",(0,n.jsx)(t.a,{href:"https://www.pantsbuild.org/2.32/docs/python/overview/pex#generating-the-complete_platforms-file",children:"https://www.pantsbuild.org/2.32/docs/python/overview/pex#generating-the-complete_platforms-file"})," for details on how to create this file."]})]}),(0,n.jsx)(t.h2,{id:"dependencies",children:(0,n.jsx)(t.code,{children:"dependencies"})}),(0,n.jsxs)(o.A,{type_repr:"Iterable[str] | None",default_repr:"None",children:[(0,n.jsxs)(t.p,{children:["Addresses to other targets that this target depends on, e.g. ",(0,n.jsx)(t.code,{children:"['helloworld/subdir:lib', 'helloworld/main.py:lib', '3rdparty:reqs#django']"}),"."]}),(0,n.jsxs)(t.p,{children:["This augments any dependencies inferred by Pants, such as by analyzing your imports. Use ",(0,n.jsx)(t.code,{children:"pants dependencies"})," or ",(0,n.jsx)(t.code,{children:"pants peek"})," on this target to get the final result."]}),(0,n.jsxs)(t.p,{children:["See ",(0,n.jsx)(t.a,{href:"https://www.pantsbuild.org/2.32/docs/using-pants/key-concepts/targets-and-build-files",children:"https://www.pantsbuild.org/2.32/docs/using-pants/key-concepts/targets-and-build-files"})," for more about how addresses are formed, including for generated targets. You can also run ",(0,n.jsx)(t.code,{children:"pants list ::"})," to find all addresses in your project, or ",(0,n.jsx)(t.code,{children:"pants list dir"})," to find all addresses defined in that directory."]}),(0,n.jsxs)(t.p,{children:["If the target is in the same BUILD file, you can leave off the BUILD file path, e.g. ",(0,n.jsx)(t.code,{children:":tgt"})," instead of ",(0,n.jsx)(t.code,{children:"helloworld/subdir:tgt"}),". For generated first-party addresses, use ",(0,n.jsx)(t.code,{children:"./"})," for the file path, e.g. ",(0,n.jsx)(t.code,{children:"./main.py:tgt"}),"; for all other generated targets, use ",(0,n.jsx)(t.code,{children:":tgt#generated_name"}),"."]}),(0,n.jsxs)(t.p,{children:["You may exclude dependencies by prefixing with ",(0,n.jsx)(t.code,{children:"!"}),", e.g. ",(0,n.jsx)(t.code,{children:"['!helloworld/subdir:lib', '!./sibling.txt']"}),". Ignores are intended for false positives with dependency inference; otherwise, simply leave off the dependency from the BUILD file."]})]}),(0,n.jsx)(t.h2,{id:"description",children:(0,n.jsx)(t.code,{children:"description"})}),(0,n.jsxs)(o.A,{type_repr:"str | None",default_repr:"None",children:[(0,n.jsx)(t.p,{children:"A human-readable description of the target."}),(0,n.jsxs)(t.p,{children:["Use ",(0,n.jsx)(t.code,{children:"pants list --documented ::"})," to see all targets with descriptions."]})]}),(0,n.jsx)(t.h2,{id:"emit_warnings",children:(0,n.jsx)(t.code,{children:"emit_warnings"})}),(0,n.jsxs)(o.A,{type_repr:"bool | None",default_repr:"None",children:[(0,n.jsx)(t.p,{children:"Whether or not to emit PEX warnings at runtime."}),(0,n.jsxs)(t.p,{children:["The default is determined by the option ",(0,n.jsx)(t.code,{children:"emit_warnings"})," in the ",(0,n.jsx)(t.code,{children:"[pex-binary-defaults]"})," scope."]})]}),(0,n.jsx)(t.h2,{id:"entry_point",children:(0,n.jsx)(t.code,{children:"entry_point"})}),(0,n.jsxs)(o.A,{type_repr:"str | None",default_repr:"None",children:[(0,n.jsxs)(t.p,{children:["Set the entry point, i.e. what gets run when executing ",(0,n.jsx)(t.code,{children:"./my_app.pex"}),", to a module."]}),(0,n.jsxs)(t.p,{children:["You can specify a full module like ",(0,n.jsx)(t.code,{children:"'path.to.module'"})," and ",(0,n.jsx)(t.code,{children:"'path.to.module:func'"}),", or use a shorthand to specify a file name, using the same syntax as the ",(0,n.jsx)(t.code,{children:"sources"})," field:"]}),(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"'app.py'"}),", Pants will convert into the module ",(0,n.jsx)(t.code,{children:"path.to.app"}),";"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"'app.py:func'"}),", Pants will convert into ",(0,n.jsx)(t.code,{children:"path.to.app:func"}),"."]}),"\n"]}),(0,n.jsxs)(t.p,{children:["You may only set one of: this field, or the ",(0,n.jsx)(t.code,{children:"script"})," field, or the ",(0,n.jsx)(t.code,{children:"executable"})," field. Leave off all three fields to have no entry point."]})]}),(0,n.jsx)(t.h2,{id:"env",children:(0,n.jsx)(t.code,{children:"env"})}),(0,n.jsx)(o.A,{type_repr:"dict[str, str] | None",default_repr:"None",children:(0,n.jsx)(t.p,{children:"Freeze these environment variables into the PEX. Allows you to run generic entry points on a specific environment without creating a shim file."})}),(0,n.jsx)(t.h2,{id:"environment",children:(0,n.jsx)(t.code,{children:"environment"})}),(0,n.jsxs)(o.A,{type_repr:"str | None",default_repr:"'__local__'",children:[(0,n.jsx)(t.p,{children:"Specify which environment target to consume environment-sensitive options from."}),(0,n.jsxs)(t.p,{children:["Once environments are defined in ",(0,n.jsx)(t.code,{children:"[environments-preview].names"}),", you can specify the environment for this target by its name. Any fields that are defined in that environment will override the values from options set by ",(0,n.jsx)(t.code,{children:"pants.toml"}),", command line values, or environment variables."]}),(0,n.jsxs)(t.p,{children:["You can specify multiple valid environments by using ",(0,n.jsx)(t.code,{children:"parametrize"}),". If ",(0,n.jsx)(t.code,{children:"__local__"})," is specified, Pants will fall back to the ",(0,n.jsx)(t.code,{children:"local_environment"})," defined for the current platform, or no environment if no such environment exists."]})]}),(0,n.jsx)(t.h2,{id:"executable",children:(0,n.jsx)(t.code,{children:"executable"})}),(0,n.jsxs)(o.A,{type_repr:"str | None",default_repr:"None",children:[(0,n.jsxs)(t.p,{children:["Set the entry point, i.e. what gets run when executing ",(0,n.jsx)(t.code,{children:"./my_app.pex"}),", to an execuatble local python script. This executable python script is typically something that cannot be imported so it cannot be used via ",(0,n.jsx)(t.code,{children:"script"})," or ",(0,n.jsx)(t.code,{children:"entry_point"}),"."]}),(0,n.jsxs)(t.p,{children:["You may only set one of: this field, or the ",(0,n.jsx)(t.code,{children:"entry_point"})," field, or the ",(0,n.jsx)(t.code,{children:"script"})," field. Leave off all three fields to have no entry point."]})]}),(0,n.jsx)(t.h2,{id:"execution_mode",children:(0,n.jsx)(t.code,{children:"execution_mode"})}),(0,n.jsxs)(o.A,{type_repr:"'venv' | 'zipapp' | None",default_repr:"'zipapp'",children:[(0,n.jsx)(t.p,{children:"The mode the generated PEX file will run in."}),(0,n.jsxs)(t.p,{children:["The traditional PEX file runs in a modified 'zipapp' mode (See: ",(0,n.jsx)(t.a,{href:"https://www.python.org/dev/peps/pep-0441/",children:"https://www.python.org/dev/peps/pep-0441/"}),") where zipped internal code and dependencies are first unpacked to disk. This mode achieves the fastest cold start times and may, for example be the best choice for cloud lambda functions."]}),(0,n.jsxs)(t.p,{children:["The fastest execution mode in the steady state is 'venv', which generates a virtual environment from the PEX file on first run, but then achieves near native virtual environment start times. This mode also benefits from a traditional virtual environment ",(0,n.jsx)(t.code,{children:"sys.path"}),", giving maximum compatibility with stdlib and third party APIs."]})]}),(0,n.jsx)(t.h2,{id:"extra_build_args",children:(0,n.jsx)(t.code,{children:"extra_build_args"})}),(0,n.jsxs)(o.A,{type_repr:"Iterable[str] | None",default_repr:"()",children:[(0,n.jsxs)(t.p,{children:["Extra arguments to pass to the ",(0,n.jsx)(t.code,{children:"pex"})," invocation used to build this PEX. These are passed after all other arguments. This can be used to pass extra options that Pants doesn't have built-in support for."]}),(0,n.jsxs)(t.p,{children:["This is different to ",(0,n.jsx)(t.code,{children:"args"}),": ",(0,n.jsx)(t.code,{children:"args"})," records arguments used by the packaged PEX when executed, ",(0,n.jsx)(t.code,{children:"extra_build_args"})," passes arguments to the process that does the packaging."]})]}),(0,n.jsx)(t.h2,{id:"ignore_errors",children:(0,n.jsx)(t.code,{children:"ignore_errors"})}),(0,n.jsx)(o.A,{type_repr:"bool",default_repr:"False",children:(0,n.jsx)(t.p,{children:"Should PEX ignore errors when it cannot resolve dependencies?"})}),(0,n.jsx)(t.h2,{id:"include_requirements",children:(0,n.jsx)(t.code,{children:"include_requirements"})}),(0,n.jsx)(o.A,{type_repr:"bool",default_repr:"True",children:(0,n.jsx)(t.p,{children:"Whether to include the third party requirements the binary depends on in the packaged PEX file."})}),(0,n.jsx)(t.h2,{id:"include_sources",children:(0,n.jsx)(t.code,{children:"include_sources"})}),(0,n.jsx)(o.A,{type_repr:"bool",default_repr:"True",children:(0,n.jsx)(t.p,{children:"Whether to include your first party sources the binary uses in the packaged PEX file."})}),(0,n.jsx)(t.h2,{id:"include_tools",children:(0,n.jsx)(t.code,{children:"include_tools"})}),(0,n.jsxs)(o.A,{type_repr:"bool",default_repr:"False",children:[(0,n.jsx)(t.p,{children:"Whether to include Pex tools in the PEX bootstrap code."}),(0,n.jsxs)(t.p,{children:["With tools included, the generated PEX file can be executed with ",(0,n.jsx)(t.code,{children:"PEX_TOOLS=1 <pex file> --help"})," to gain access to all the available tools."]})]}),(0,n.jsx)(t.h2,{id:"inherit_path",children:(0,n.jsx)(t.code,{children:"inherit_path"})}),(0,n.jsxs)(o.A,{type_repr:"'fallback' | 'false' | 'prefer' | None",default_repr:"None",children:[(0,n.jsxs)(t.p,{children:["Whether to inherit the ",(0,n.jsx)(t.code,{children:"sys.path"})," (aka PYTHONPATH) of the environment that the binary runs in."]}),(0,n.jsxs)(t.p,{children:["Use ",(0,n.jsx)(t.code,{children:"false"})," to not inherit ",(0,n.jsx)(t.code,{children:"sys.path"}),"; use ",(0,n.jsx)(t.code,{children:"fallback"})," to inherit ",(0,n.jsx)(t.code,{children:"sys.path"})," after packaged dependencies; and use ",(0,n.jsx)(t.code,{children:"prefer"})," to inherit ",(0,n.jsx)(t.code,{children:"sys.path"})," before packaged dependencies."]})]}),(0,n.jsx)(t.h2,{id:"interpreter_constraints",children:(0,n.jsx)(t.code,{children:"interpreter_constraints"})}),(0,n.jsxs)(o.A,{type_repr:"Iterable[str] | None",default_repr:"None",children:[(0,n.jsx)(t.p,{children:"The Python interpreters this code is compatible with."}),(0,n.jsxs)(t.p,{children:["Each element should be written in pip-style format, e.g. ",(0,n.jsx)(t.code,{children:"CPython==2.7.*"})," or ",(0,n.jsx)(t.code,{children:"CPython>=3.6,<4"}),". You can leave off ",(0,n.jsx)(t.code,{children:"CPython"})," as a shorthand, e.g. ",(0,n.jsx)(t.code,{children:">=2.7"})," will be expanded to ",(0,n.jsx)(t.code,{children:"CPython>=2.7"}),"."]}),(0,n.jsxs)(t.p,{children:["Specify more than one element to OR the constraints, e.g. ",(0,n.jsx)(t.code,{children:"['PyPy==3.7.*', 'CPython==3.7.*']"})," means either PyPy 3.7 ",(0,n.jsx)(t.em,{children:"or"})," CPython 3.7."]}),(0,n.jsxs)(t.p,{children:["If the field is not set, it will default to the option ",(0,n.jsx)(t.code,{children:"[python].interpreter_constraints"}),"."]}),(0,n.jsxs)(t.p,{children:["See ",(0,n.jsx)(t.a,{href:"https://www.pantsbuild.org/2.32/docs/python/overview/interpreter-compatibility",children:"https://www.pantsbuild.org/2.32/docs/python/overview/interpreter-compatibility"})," for how these interpreter constraints are merged with the constraints of dependencies."]})]}),(0,n.jsx)(t.h2,{id:"layout",children:(0,n.jsx)(t.code,{children:"layout"})}),(0,n.jsxs)(o.A,{type_repr:"'loose' | 'packed' | 'zipapp' | None",default_repr:"'zipapp'",children:[(0,n.jsx)(t.p,{children:"The layout used for the PEX binary."}),(0,n.jsx)(t.p,{children:"By default, a PEX is created as a single file zipapp, but either a packed or loose directory tree based layout can be chosen instead."}),(0,n.jsxs)(t.p,{children:["A packed layout PEX is an executable directory structure designed to have cache-friendly characteristics for syncing incremental updates to PEXed applications over a network. At the top level of the packed directory tree there is an executable ",(0,n.jsx)(t.code,{children:"__main__.py"})," script. The directory can also be executed by passing its path to a Python executable; e.g: ",(0,n.jsx)(t.code,{children:"python packed-pex-dir/"}),". The Pex bootstrap code and all dependency code are packed into individual zip files for efficient caching and syncing."]}),(0,n.jsx)(t.p,{children:"A loose layout PEX is similar to a packed PEX, except that neither the Pex bootstrap code nor the dependency code are packed into zip files, but are instead present as collections of loose files in the directory tree providing different caching and syncing tradeoffs."}),(0,n.jsxs)(t.p,{children:["Both zipapp and packed layouts install themselves in the ",(0,n.jsx)(t.code,{children:"$PEX_ROOT"})," as loose apps by default before executing, but these layouts compose with ",(0,n.jsx)(t.code,{children:"execution_mode='zipapp'"})," as well."]})]}),(0,n.jsx)(t.h2,{id:"output_path",children:(0,n.jsx)(t.code,{children:"output_path"})}),(0,n.jsxs)(o.A,{type_repr:"str | None",default_repr:"'${spec_path_normalized}/${target_name_normalized}${file_suffix}'",children:[(0,n.jsx)(t.p,{children:"Where the built asset should be located."}),(0,n.jsx)(t.p,{children:"This field supports the following template replacements:"}),(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.code,{children:"${spec_path_normalized}"}),': The path to the target\'s directory ("spec path") with forward slashes replaced by dots.']}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.code,{children:"${target_name_normalized}"}),": The target's name with paramaterizations escaped by replacing dots with underscores."]}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.code,{children:"${file_suffix}"}),": For target's which produce single file artifacts, this is the file type suffix to use with a leading dot,\nand is empty otherwise when not applicable."]}),"\n"]}),"\n"]}),(0,n.jsxs)(t.p,{children:["If undefined, this will use the path to the BUILD file, followed by the target name. For example, ",(0,n.jsx)(t.code,{children:"src/python/project:app"})," would be ",(0,n.jsx)(t.code,{children:"src.python.project/app.ext"}),". This behavior corresponds to the default template: ",(0,n.jsx)(t.code,{children:"${spec_path_normalized}/${target_name_normalized}${file_suffix}"})]}),(0,n.jsxs)(t.p,{children:["When running ",(0,n.jsx)(t.code,{children:"pants package"}),", this path will be prefixed by ",(0,n.jsx)(t.code,{children:"--distdir"})," (e.g. ",(0,n.jsx)(t.code,{children:"dist/"}),")."]}),(0,n.jsx)(t.p,{children:"Warning: setting this value risks naming collisions with other package targets you may have."})]}),(0,n.jsx)(t.h2,{id:"resolve",children:(0,n.jsx)(t.code,{children:"resolve"})}),(0,n.jsxs)(o.A,{type_repr:"str | None",default_repr:"None",children:[(0,n.jsxs)(t.p,{children:["The resolve from ",(0,n.jsx)(t.code,{children:"[python].resolves"})," to use."]}),(0,n.jsxs)(t.p,{children:["If not defined, will default to ",(0,n.jsx)(t.code,{children:"[python].default_resolve"}),"."]}),(0,n.jsxs)(t.p,{children:["All dependencies must share the same value for their ",(0,n.jsx)(t.code,{children:"resolve"})," field."]})]}),(0,n.jsx)(t.h2,{id:"restartable",children:(0,n.jsx)(t.code,{children:"restartable"})}),(0,n.jsx)(o.A,{type_repr:"bool",default_repr:"False",children:(0,n.jsxs)(t.p,{children:["If true, runs of this target with the ",(0,n.jsx)(t.code,{children:"run"})," goal may be interrupted and restarted when its input files change."]})}),(0,n.jsx)(t.h2,{id:"scie",children:(0,n.jsx)(t.code,{children:"scie"})}),(0,n.jsxs)(o.A,{type_repr:"'eager' | 'lazy' | None",default_repr:"None",children:[(0,n.jsxs)(t.p,{children:["Create one or more native executable scies from your PEX that include a portable CPython interpreter along with your PEX making for a truly hermetic PEX that can run on machines with no Python installed at all. If your PEX has multiple targets then one PEX scie will be made for each platform, selecting the latest compatible portable CPython or PyPy interpreter as appropriate. Note that only Python>=3.8 is supported. If you'd like to explicitly control the target platforms or the exact portable CPython selected, see ",(0,n.jsx)(t.code,{children:"scie_platform"}),", ",(0,n.jsx)(t.code,{children:"scie_pbs_release"})," and ",(0,n.jsx)(t.code,{children:"scie_python_version"}),". Specifying ",(0,n.jsx)(t.code,{children:"lazy"})," will fetch the portable CPython interpreter just in time on first boot of the PEX scie on a given machine if needed. Specifying ",(0,n.jsx)(t.code,{children:"eager"})," will embed the portable CPython interpreter in your PEX scie making for a larger file, but requiring no internet access to boot. See ",(0,n.jsx)(t.a,{href:"https://science.scie.app",children:"https://science.scie.app"})," for further details."]}),(0,n.jsxs)(t.p,{children:["This field must be set for any other ",(0,n.jsx)(t.code,{children:"scie_*"})," fields to take effect."]}),(0,n.jsxs)(t.p,{children:["NOTE: ",(0,n.jsx)(t.code,{children:"pants run"}),' will always run the "regular" PEX, use ',(0,n.jsx)(t.code,{children:"package"})," to create scie PEXs."]})]}),(0,n.jsx)(t.h2,{id:"scie_args",children:(0,n.jsx)(t.code,{children:"scie_args"})}),(0,n.jsx)(o.A,{type_repr:"Iterable[str] | None",default_repr:"None",children:(0,n.jsxs)(t.p,{children:["Additional arguments to pass to the custom ",(0,n.jsx)(t.code,{children:"scie_exe"})," entry\npoint. Scie placeholders can be used in ",(0,n.jsx)(t.code,{children:"scie_args"}),","]})}),(0,n.jsx)(t.h2,{id:"scie_bind_resource_path",children:(0,n.jsx)(t.code,{children:"scie_bind_resource_path"})}),(0,n.jsx)(o.A,{type_repr:"Iterable[str] | None",default_repr:"None",children:(0,n.jsxs)(t.p,{children:["Specifies an environment variable to bind the path of a resource\nin the PEX to in the form ",(0,n.jsx)(t.code,{children:"<env var name>=<resource rel path>"}),". For\nexample ",(0,n.jsx)(t.code,{children:"WINDOWS_X64_CONSOLE_TRAMPOLINE=pex/windows/stubs/uv-        trampoline-x86_64-console.exe"})," would lookup the path of the\n",(0,n.jsx)(t.code,{children:"pex/windows/stubs/uv-trampoline-x86_64-console.exe"})," file on the\n",(0,n.jsx)(t.code,{children:"sys.path"})," and bind its absolute path to the\nWINDOWS_X64_CONSOLE_TRAMPOLINE environment variable. N.B.: resource\npaths must use the Unix path separator of ",(0,n.jsx)(t.code,{children:"/"}),". These will be converted\nto the runtime host path separator as needed."]})}),(0,n.jsx)(t.h2,{id:"scie_busybox",children:(0,n.jsx)(t.code,{children:"scie_busybox"})}),(0,n.jsxs)(o.A,{type_repr:"str | None",default_repr:"None",children:[(0,n.jsxs)(t.p,{children:["Make the PEX scie a BusyBox over the specified entry points. The entry points can either be console scripts or entry point specifiers. To select all console scripts in all distributions contained in the PEX, use ",(0,n.jsx)(t.code,{children:"@"}),". To just pick all the console scripts from a particular project name's distributions in the PEX, use ",(0,n.jsx)(t.code,{children:"@<project name>"}),"; e.g.: ",(0,n.jsx)(t.code,{children:"@ansible-core"}),". To exclude all the console scripts from a project, prefix with a ",(0,n.jsx)(t.code,{children:"!"}),"; e.g.: ",(0,n.jsx)(t.code,{children:"@,!@ansible-core"})," selects all console scripts except those provided by the ",(0,n.jsx)(t.code,{children:"ansible- core"})," project. To select an individual console script, just use its name or prefix the name with ",(0,n.jsx)(t.code,{children:"!"})," to exclude that individual console script. To specify an arbitrary entry point in a module contained within one of the distributions in the PEX, use a string of the form ",(0,n.jsx)(t.code,{children:"<name>=<module>(:<function>)"}),"; e.g.: 'run- baz=foo.bar",":baz","' to execute the ",(0,n.jsx)(t.code,{children:"baz"})," function in the ",(0,n.jsx)(t.code,{children:"foo.bar"})," module as the entry point named ",(0,n.jsx)(t.code,{children:"run-baz"}),"."]}),(0,n.jsxs)(t.p,{children:["A BusyBox scie has no default entrypoint; instead, when run, it inspects argv0; if that matches one of its embedded entry points, it runs that entry point; if not, it lists all available entrypoints for you to pick from. To run a given entry point, you specify it as the first argument and all other arguments after that are forwarded to that entry point. BusyBox PEX scies allow you to install all their contained entry points into a given directory. For more information, run ",(0,n.jsx)(t.code,{children:"SCIE=help <your PEX scie>"})," and review the ",(0,n.jsx)(t.code,{children:"install"})," command help."]}),(0,n.jsxs)(t.p,{children:["NOTE: This is only available for formal Python entry points <",(0,n.jsx)(t.a,{href:"https://packaging.python.org/en/latest/specifications/entry-points/&#x3E",children:"https://packaging.python.org/en/latest/specifications/entry-points/&#x3E"}),"; and not the informal use by the ",(0,n.jsx)(t.code,{children:"pex_binary"})," field ",(0,n.jsx)(t.code,{children:"entry_point"})," to run first party files."]})]}),(0,n.jsx)(t.h2,{id:"scie_env",children:(0,n.jsx)(t.code,{children:"scie_env"})}),(0,n.jsx)(o.A,{type_repr:"Iterable[str] | None",default_repr:"None",children:(0,n.jsxs)(t.p,{children:["Environment variables to set when executing the custom ",(0,n.jsx)(t.code,{children:"scie_exe"})," entry point. Scie placeholders can be used in ",(0,n.jsx)(t.code,{children:"scie_env"}),"."]})}),(0,n.jsx)(t.h2,{id:"scie_exe",children:(0,n.jsx)(t.code,{children:"scie_exe"})}),(0,n.jsx)(o.A,{type_repr:"str | None",default_repr:"None",children:(0,n.jsxs)(t.p,{children:["Specify a custom PEX scie entry point instead of using the PEX's entrypoint. When specifying a custom entry point additional args can be set via ",(0,n.jsx)(t.code,{children:"scie_args"})," and environment variables can be set via ",(0,n.jsx)(t.code,{children:"scie_env"}),". Scie placeholders can be used in ",(0,n.jsx)(t.code,{children:"scie_exe"}),"."]})}),(0,n.jsx)(t.h2,{id:"scie_hash_alg",children:(0,n.jsx)(t.code,{children:"scie_hash_alg"})}),(0,n.jsx)(o.A,{type_repr:"str | None",default_repr:"None",children:(0,n.jsxs)(t.p,{children:["Output a checksum file for each scie generated that is compatible\nwith the shasum family of tools. For each unique algorithm specified,\na sibling file to each scie executable will be generated with the same\nstem as that scie file and hash algorithm name suffix. The file will\ncontain the hex fingerprint of the scie executable using that\nalgorithm to hash it. Supported algorithms include at least md5, sha1,\nsha256, sha384 and sha512. For the complete list of supported hash\nalgorithms, see the science tool --hash documentation here:\n<",(0,n.jsx)(t.a,{href:"https://science.scie.app/cli.html#science-lift-build&#x3E",children:"https://science.scie.app/cli.html#science-lift-build&#x3E"}),";."]})}),(0,n.jsx)(t.h2,{id:"scie_load_dotenv",children:(0,n.jsx)(t.code,{children:"scie_load_dotenv"})}),(0,n.jsx)(o.A,{type_repr:"bool | None",default_repr:"None",children:(0,n.jsxs)(t.p,{children:["Have the scie launcher load ",(0,n.jsx)(t.code,{children:".env"})," files and apply the loaded env\nvars to the PEX scie environment. See the 'load_dotenv' docs here for\nmore on the ",(0,n.jsx)(t.code,{children:".env"})," loading specifics: ",(0,n.jsx)(t.a,{href:"https://github.com/a-",children:"https://github.com/a-"}),"\nscie/jump/blob/main/docs/packaging.md#optional-fields (Pex default:\nFalse)"]})}),(0,n.jsx)(t.h2,{id:"scie_name_style",children:(0,n.jsx)(t.code,{children:"scie_name_style"})}),(0,n.jsx)(o.A,{type_repr:"'dynamic' | 'platform-file-suffix' | 'platform-parent-dir' | None",default_repr:"<ScieNameStyle.DYNAMIC: 'dynamic'>",children:(0,n.jsxs)(t.p,{children:["Control how the output file translates to a scie name. By default (",(0,n.jsx)(t.code,{children:"dynamic"}),"), the platform is used as a file suffix only when needed for disambiguation when targeting a local platform. Specifying ",(0,n.jsx)(t.code,{children:"platform-file-suffix"})," forces the scie target platform name to be added as a suffix of the output filename; Specifying ",(0,n.jsx)(t.code,{children:"platform-parent-dir"})," places the scie in a sub- directory with the name of the platform it targets."]})}),(0,n.jsx)(t.h2,{id:"scie_pbs_debug",children:(0,n.jsx)(t.code,{children:"scie_pbs_debug"})}),(0,n.jsx)(o.A,{type_repr:"bool | None",default_repr:"None",children:(0,n.jsxs)(t.p,{children:["Should the Python Standalone Builds CPython distributions be debug\nbuilds. Note that this option is not compatible with\n",(0,n.jsx)(t.code,{children:"scie_pbs_stripped=True"}),". (default: False)"]})}),(0,n.jsx)(t.h2,{id:"scie_pbs_free_threaded",children:(0,n.jsx)(t.code,{children:"scie_pbs_free_threaded"})}),(0,n.jsx)(o.A,{type_repr:"bool | None",default_repr:"None",children:(0,n.jsxs)(t.p,{children:["Should the Python Standalone Builds CPython distributions be free-threaded. If left unspecified or otherwise turned off, creating a scie from a PEX with free-threaded abi wheels will automatically turn this option on. Note that this option is not compatible with ",(0,n.jsx)(t.code,{children:"scie_pbs_stripped=True"}),". (Pex default: False)"]})}),(0,n.jsx)(t.h2,{id:"scie_pbs_release",children:(0,n.jsx)(t.code,{children:"scie_pbs_release"})}),(0,n.jsx)(o.A,{type_repr:"str | None",default_repr:"None",children:(0,n.jsxs)(t.p,{children:["The Python Standalone Builds release to use when a CPython\ninterpreter distribution is needed for the PEX scie. Currently,\nreleases are dates of the form YYYYMMDD, e.g.: '20240713'. See their\nGitHub releases page at\n<",(0,n.jsx)(t.a,{href:"https://github.com/astral-sh/python-build-standalone/releases&#x3E",children:"https://github.com/astral-sh/python-build-standalone/releases&#x3E"}),"; to\ndiscover available releases. If left unspecified the latest release is\nused."]})}),(0,n.jsx)(t.h2,{id:"scie_pbs_stripped",children:(0,n.jsx)(t.code,{children:"scie_pbs_stripped"})}),(0,n.jsx)(o.A,{type_repr:"bool | None",default_repr:"None",children:(0,n.jsxs)(t.p,{children:["Should the Python Standalone Builds CPython distributions used be\nstripped of debug symbols or not. For Linux and Windows particularly,\nthe stripped distributions are less than half the size of the\ndistributions that ship with debug symbols. Note that this option is\nnot compatible with ",(0,n.jsx)(t.code,{children:"scie_pbs_free_threaded=True"})," or\n",(0,n.jsx)(t.code,{children:"scie_pbs_debug=True"}),". (Pex default: False)"]})}),(0,n.jsx)(t.h2,{id:"scie_pex_entrypoint_env_passthrough",children:(0,n.jsx)(t.code,{children:"scie_pex_entrypoint_env_passthrough"})}),(0,n.jsx)(o.A,{type_repr:"bool | None",default_repr:"None",children:(0,n.jsx)(t.p,{children:"Allow overriding the primary entrypoint at runtime via PEX_INTERPRETER, PEX_SCRIPT and PEX_MODULE. Note that when using --venv with a script entrypoint this adds modest startup overhead on the order of 10ms. Defaults to false for busybox scies and true for single entrypoint scies."})}),(0,n.jsx)(t.h2,{id:"scie_platform",children:(0,n.jsx)(t.code,{children:"scie_platform"})}),(0,n.jsx)(o.A,{type_repr:"Iterable[str] | None",default_repr:"None",children:(0,n.jsxs)(t.p,{children:["The platform to produce the native PEX scie executable for. You\ncan use a value of ",(0,n.jsx)(t.code,{children:"current"})," to select the current platform. If left\nunspecified, the platforms implied by the targets selected to build\nthe PEX with are used. Those targets are influenced by the current\ninterpreter running Pex as well as use of ",(0,n.jsx)(t.code,{children:"complete_platforms"})," and\n",(0,n.jsx)(t.code,{children:"interpreter_constraints"}),". Note that, in general, ",(0,n.jsx)(t.code,{children:"scie_platform"}),"\nshould only be used to select a subset of the platforms implied by the\ntargets selected via other options."]})}),(0,n.jsx)(t.h2,{id:"scie_python_version",children:(0,n.jsx)(t.code,{children:"scie_python_version"})}),(0,n.jsx)(o.A,{type_repr:"str | None",default_repr:"None",children:(0,n.jsxs)(t.p,{children:["The portable CPython version to select. Can be either in\n",(0,n.jsx)(t.code,{children:"<major>.<minor>"})," form; e.g.: '3.11', or else fully specified as\n",(0,n.jsx)(t.code,{children:"<major>.<minor>.<patch>"}),"; e.g.: '3.11.3'. If you don't specify this\noption, Pex will do its best to guess appropriate portable CPython\nversions. N.B.: Python Standalone Builds does not provide all patch\nversions; so you should check their releases at\n<",(0,n.jsx)(t.a,{href:"https://github.com/astral-sh/python-build-standalone/releases&#x3E",children:"https://github.com/astral-sh/python-build-standalone/releases&#x3E"}),"; if you\nwish to pin down to the patch level."]})}),(0,n.jsx)(t.h2,{id:"script",children:(0,n.jsx)(t.code,{children:"script"})}),(0,n.jsxs)(o.A,{type_repr:"str | None",default_repr:"None",children:[(0,n.jsxs)(t.p,{children:["Set the entry point, i.e. what gets run when executing ",(0,n.jsx)(t.code,{children:"./my_app.pex"}),", to a script or console_script as defined by any of the distributions in the PEX."]}),(0,n.jsxs)(t.p,{children:["You may only set one of: this field, or the ",(0,n.jsx)(t.code,{children:"entry_point"})," field, or the ",(0,n.jsx)(t.code,{children:"executable"})," field. Leave off all three fields to have no entry point."]})]}),(0,n.jsx)(t.h2,{id:"sh_boot",children:(0,n.jsx)(t.code,{children:"sh_boot"})}),(0,n.jsxs)(o.A,{type_repr:"bool",default_repr:"False",children:[(0,n.jsxs)(t.p,{children:["Should PEX create a modified ZIPAPP that uses ",(0,n.jsx)(t.code,{children:"/bin/sh"})," to boot?"]}),(0,n.jsxs)(t.p,{children:["If you know the machines that the PEX will be distributed to have POSIX compliant ",(0,n.jsx)(t.code,{children:"/bin/sh"})," (almost all do, see: ",(0,n.jsx)(t.a,{href:"https://pubs.opengroup.org/onlinepubs/9699919799/utilities/sh.html",children:"https://pubs.opengroup.org/onlinepubs/9699919799/utilities/sh.html"}),"); then this is probably the way you want your PEX to boot. Instead of launching via a Python shebang, the PEX will launch via a ",(0,n.jsx)(t.code,{children:"#!/bin/sh"})," shebang that executes a small script embedded in the head of the PEX ZIPAPP that performs initial interpreter selection and re-execution of the underlying PEX in a way that is often more robust than a Python shebang and always faster on 2nd and subsequent runs since the sh script has a constant overhead of O(1ms) whereas the Python overhead to perform the same interpreter selection and re-execution is O(100ms)."]})]}),(0,n.jsx)(t.h2,{id:"shebang",children:(0,n.jsx)(t.code,{children:"shebang"})}),(0,n.jsxs)(o.A,{type_repr:"str | None",default_repr:"None",children:[(0,n.jsx)(t.p,{children:"Set the generated PEX to use this shebang, rather than the default of PEX choosing a shebang based on the interpreter constraints."}),(0,n.jsxs)(t.p,{children:["This influences the behavior of running ",(0,n.jsx)(t.code,{children:"./result.pex"}),". You can ignore the shebang by instead running ",(0,n.jsx)(t.code,{children:"/path/to/python_interpreter ./result.pex"}),"."]})]}),(0,n.jsx)(t.h2,{id:"strip_pex_env",children:(0,n.jsx)(t.code,{children:"strip_pex_env"})}),(0,n.jsxs)(o.A,{type_repr:"bool",default_repr:"True",children:[(0,n.jsxs)(t.p,{children:["Whether or not to strip the PEX runtime environment of ",(0,n.jsx)(t.code,{children:"PEX*"})," environment variables."]}),(0,n.jsxs)(t.p,{children:["Most applications have no need for the ",(0,n.jsx)(t.code,{children:"PEX*"})," environment variables that are used to control PEX startup; so these variables are scrubbed from the environment by Pex before transferring control to the application by default. This prevents any subprocesses that happen to execute other PEX files from inheriting these control knob values since most would be undesired; e.g.: PEX_MODULE or PEX_PATH."]})]}),(0,n.jsx)(t.h2,{id:"tags",children:(0,n.jsx)(t.code,{children:"tags"})}),(0,n.jsxs)(o.A,{type_repr:"Iterable[str] | None",default_repr:"None",children:[(0,n.jsx)(t.p,{children:"Arbitrary strings to describe a target."}),(0,n.jsxs)(t.p,{children:["For example, you may tag some test targets with 'integration_test' so that you could run ",(0,n.jsx)(t.code,{children:"pants --tag='integration_test' test ::"})," to only run on targets with that tag."]})]}),(0,n.jsx)(t.h2,{id:"venv_hermetic_scripts",children:(0,n.jsx)(t.code,{children:"venv_hermetic_scripts"})}),(0,n.jsxs)(o.A,{type_repr:"bool",default_repr:"True",children:[(0,n.jsxs)(t.p,{children:['If execution_mode is "venv", emit a hermetic venv ',(0,n.jsx)(t.code,{children:"pex"})," script and hermetic console scripts."]}),(0,n.jsxs)(t.p,{children:["The venv ",(0,n.jsx)(t.code,{children:"pex"})," script and the venv console scripts are constructed to be hermetic by default; Python is executed with ",(0,n.jsx)(t.code,{children:"-sE"})," to restrict the ",(0,n.jsx)(t.code,{children:"sys.path"})," to the PEX venv contents only. Setting this field to ",(0,n.jsx)(t.code,{children:"False"})," elides the Python ",(0,n.jsx)(t.code,{children:"-sE"})," restrictions and can be used to interoperate with frameworks that use ",(0,n.jsx)(t.code,{children:"PYTHONPATH"})," manipulation to run code."]})]}),(0,n.jsx)(t.h2,{id:"venv_site_packages_copies",children:(0,n.jsx)(t.code,{children:"venv_site_packages_copies"})}),(0,n.jsxs)(o.A,{type_repr:"bool",default_repr:"False",children:[(0,n.jsx)(t.p,{children:"If execution_mode is venv, populate the venv site packages using hard links or copies of resolved PEX dependencies instead of symlinks."}),(0,n.jsx)(t.p,{children:"This can be used to work around problems with tools or libraries that are confused by symlinked source files."})]})]})]})}function u(e={}){let{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(p,{...e})}):p(e)}},375002(e,t,s){s.d(t,{A:()=>i});let i={options:"options_nrbo"}},989898(e,t,s){s.d(t,{A:()=>n});var i=s(886070);function n({children:e,type_repr:t,default_repr:s,backend:n}){return(0,i.jsxs)("div",{className:"margin-bottom--lg",children:[(0,i.jsx)("code",{style:{color:"var(--pants-reference-option-repr)"},children:t}),(0,i.jsx)("br",{}),(0,i.jsxs)("div",{style:{paddingLeft:"2em"},children:[s&&(0,i.jsxs)("span",{children:["default:"," ",(0,i.jsx)("code",{style:{color:"var(--ifm-color-success)"},children:s})]}),!s&&(0,i.jsx)("span",{style:{color:"var(--ifm-color-success)"},children:"required"}),n&&(0,i.jsxs)("div",{children:["backend:"," ",(0,i.jsx)("code",{style:{color:"var(--ifm-color-success)"},children:n})]}),e]})]})}},848193(e,t,s){s.d(t,{R:()=>o,x:()=>d});var i=s(830758);let n={},r=i.createContext(n);function o(e){let t=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),i.createElement(r.Provider,{value:t},e.children)}},940349(e){e.exports=JSON.parse('{"id":"reference/targets/pex_binary","title":"pex_binary","description":"A Python target that can be converted into an executable PEX file.\\n","source":"@site/docs/reference/targets/pex_binary.mdx","sourceDirName":"reference/targets","slug":"/reference/targets/pex_binary","permalink":"/dev/reference/targets/pex_binary","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"pex_binary","description":"A Python target that can be converted into an executable PEX file.\\n"},"sidebar":"referenceSidebar","previous":{"title":"pex_binaries","permalink":"/dev/reference/targets/pex_binaries"},"next":{"title":"pipenv_requirements","permalink":"/dev/reference/targets/pipenv_requirements"}}')}}]);
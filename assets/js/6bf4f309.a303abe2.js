"use strict";(self.webpackChunkpantsbuild_org=self.webpackChunkpantsbuild_org||[]).push([["101790"],{739055(e,r,s){s.r(r),s.d(r,{assets:()=>d,contentTitle:()=>c,default:()=>m,frontMatter:()=>a,metadata:()=>n,toc:()=>h});var n=s(77985),t=s(886070),o=s(848193),i=s(554707),l=s(375002);let a={title:"fmt",description:"Autoformat source code.\n"},c,d={},h=[{value:"Basic options",id:"basic-options",level:2},{value:"<code>only</code>",id:"only",level:3},{value:"Advanced options",id:"advanced-options",level:2},{value:"<code>batch_size</code>",id:"batch_size",level:3},{value:"Deprecated options",id:"deprecated-options",level:2},{value:"<code>per_file_caching</code>",id:"per_file_caching",level:3},{value:"Related subsystems",id:"related-subsystems",level:2}];function p(e){let r={code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.hr,{}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"pants fmt [args]\n"})}),"\n",(0,t.jsx)(r.p,{children:"Autoformat source code."}),"\n",(0,t.jsxs)(r.p,{children:["Backend: ",(0,t.jsx)("span",{className:"color--primary",children:(0,t.jsx)(r.code,{children:"pants.core"})})]}),"\n",(0,t.jsxs)(r.p,{children:["Config section: ",(0,t.jsx)("span",{className:"color--primary",children:(0,t.jsx)(r.code,{children:"[fmt]"})})]}),"\n",(0,t.jsxs)("span",{className:l.A.options,children:[(0,t.jsx)(r.h2,{id:"basic-options",children:"Basic options"}),(0,t.jsx)(r.h3,{id:"only",children:(0,t.jsx)(r.code,{children:"only"})}),(0,t.jsxs)(i.A,{cli_repr:"--fmt-only=\"['<str>', '<str>', ...]\"",env_repr:"PANTS_FMT_ONLY",toml_repr:`[fmt]
only = [
  '<str>',
  '<str>',
  ...,
]`,default_repr:"[]",children:[(0,t.jsx)(r.p,{children:"Only run these formatters and skip all others."}),(0,t.jsxs)(r.p,{children:["The formatter names are outputted at the final summary of running this goal, e.g. ",(0,t.jsx)(r.code,{children:"isort"})," and ",(0,t.jsx)(r.code,{children:"shfmt"}),". You can also run ",(0,t.jsx)(r.code,{children:"fmt --only=fake"})," to get a list of all activated formatters."]}),(0,t.jsxs)(r.p,{children:["You can repeat this option, e.g. ",(0,t.jsx)(r.code,{children:"fmt --only=isort --only=shfmt"})," or ",(0,t.jsx)(r.code,{children:"fmt --only=['isort', 'shfmt']"}),"."]})]}),(0,t.jsx)(r.h2,{id:"advanced-options",children:"Advanced options"}),(0,t.jsx)(r.h3,{id:"batch_size",children:(0,t.jsx)(r.code,{children:"batch_size"})}),(0,t.jsxs)(i.A,{cli_repr:"--fmt-batch-size=<int>",env_repr:"PANTS_FMT_BATCH_SIZE",toml_repr:`[fmt]
batch_size = <int>`,default_repr:"128",children:[(0,t.jsx)(r.p,{children:"The target number of files to be included in each formatter batch."}),(0,t.jsx)(r.p,{children:"Formatter processes are batched for a few reasons:"}),(0,t.jsxs)(r.ol,{children:["\n",(0,t.jsx)(r.li,{children:"to avoid OS argument length limits (in processes which don't support argument files)"}),"\n",(0,t.jsx)(r.li,{children:"to support more stable cache keys than would be possible if all files were operated on in a single batch."}),"\n",(0,t.jsx)(r.li,{children:"to allow for parallelism in formatter processes which don't have internal parallelism, or -- if they do support internal parallelism -- to improve scheduling behavior when multiple processes are competing for cores and so internal parallelism cannot be used perfectly."}),"\n"]}),(0,t.jsx)(r.p,{children:'In order to improve cache hit rates (see 2.), batches are created at stable boundaries, and so this value is only a "target" batch size (rather than an exact value).'})]}),(0,t.jsx)(r.h2,{id:"deprecated-options",children:"Deprecated options"}),(0,t.jsx)(r.h3,{id:"per_file_caching",children:(0,t.jsx)(r.code,{children:"per_file_caching"})}),(0,t.jsxs)(i.A,{cli_repr:"--[no-]fmt-per-file-caching",env_repr:"PANTS_FMT_PER_FILE_CACHING",toml_repr:`[fmt]
per_file_caching = <bool>`,default_repr:"False",removal_version:"2.11.0.dev0",removal_hint:"Formatters are now broken into multiple batches by default using the `--batch-size` argument.<br /><br />To keep (roughly) this option's behavior, set [fmt].batch_size = 1. However, you'll likely get better performance by using a larger batch size because of reduced overhead launching processes.",children:[(0,t.jsx)(r.p,{children:"Rather than formatting all files in a single batch, format each file as a separate process."}),(0,t.jsxs)(r.p,{children:["Why do this? You'll get many more cache hits. Why not do this? Formatters both have substantial startup overhead and are cheap to add one additional file to the run. On a cold cache, it is much faster to use ",(0,t.jsx)(r.code,{children:"--no-per-file-caching"}),"."]}),(0,t.jsxs)(r.p,{children:["We only recommend using ",(0,t.jsx)(r.code,{children:"--per-file-caching"})," if you are using a remote cache or if you have benchmarked that this option will be faster than ",(0,t.jsx)(r.code,{children:"--no-per-file-caching"})," for your use case."]})]}),(0,t.jsx)(r.h2,{id:"related-subsystems",children:"Related subsystems"}),(0,t.jsx)(r.p,{children:"None"})]})]})}function m(e={}){let{wrapper:r}={...(0,o.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(p,{...e})}):p(e)}},375002(e,r,s){s.d(r,{A:()=>n});let n={options:"options_nrbo"}},554707(e,r,s){s.d(r,{A:()=>i});var n=s(886070),t=s(384122),o=s(580830);function i({children:e,cli_repr:r,env_repr:s,toml_repr:i,one_of:l,default_repr:a,target_field_name:c,removal_version:d,removal_hint:h}){return(0,n.jsxs)("div",{className:"margin-bottom--lg",children:[(0,n.jsx)("code",{style:{color:"var(--pants-reference-option-repr)"},children:r}),(0,n.jsx)("br",{}),(0,n.jsx)("code",{style:{color:"var(--pants-reference-option-repr)"},children:s}),(0,n.jsx)("br",{}),(0,n.jsx)(t.A,{language:"toml",title:"pants.toml",children:i}),(0,n.jsxs)("div",{style:{paddingLeft:"2em"},children:[(0,n.jsxs)("span",{children:[l&&(0,n.jsxs)("span",{children:["one of:"," ",(0,n.jsx)("code",{style:{color:"var(--ifm-color-success)"},children:l}),(0,n.jsx)("br",{})]}),"default:"," ",(0,n.jsx)("span",{style:{color:"var(--ifm-color-success)"},children:(a||"").includes("\n")?(0,n.jsx)("pre",{className:"padding--sm",children:a}):(0,n.jsx)("code",{children:a})})]}),(0,n.jsx)("br",{}),d&&(0,n.jsxs)("span",{style:{color:"var(--ifm-color-danger-darkest)"},children:["Deprecated, will be removed in version: ",d,".",(0,n.jsx)("br",{}),h,(0,n.jsx)("br",{})]}),e,c&&(0,n.jsxs)("span",{children:["Can be overriden by field",(0,n.jsx)("code",{children:c})," on"," ",(0,n.jsx)(o.A,{to:"../targets/local_environment",children:(0,n.jsx)("code",{children:"local_environment"})}),","," ",(0,n.jsx)(o.A,{to:"../targets/docker_environment",children:(0,n.jsx)("code",{children:"docker_environment"})}),", or"," ",(0,n.jsx)(o.A,{to:"../targets/remote_environment",children:(0,n.jsx)("code",{children:"remote_environment"})}),"targets."]})]})]})}},77985(e){e.exports=JSON.parse('{"id":"reference/goals/fmt","title":"fmt","description":"Autoformat source code.\\n","source":"@site/versioned_docs/version-2.10/reference/goals/fmt.mdx","sourceDirName":"reference/goals","slug":"/reference/goals/fmt","permalink":"/2.10/reference/goals/fmt","draft":false,"unlisted":false,"tags":[],"version":"2.10","frontMatter":{"title":"fmt","description":"Autoformat source code.\\n"},"sidebar":"referenceSidebar","previous":{"title":"filter","permalink":"/2.10/reference/goals/filter"},"next":{"title":"generate-lockfiles","permalink":"/2.10/reference/goals/generate-lockfiles"}}')}}]);
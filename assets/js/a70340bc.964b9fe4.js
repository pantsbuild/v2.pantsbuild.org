"use strict";(self.webpackChunkpantsbuild_org=self.webpackChunkpantsbuild_org||[]).push([["942210"],{892660(e,n,a){a.r(n),a.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>p,frontMatter:()=>t,metadata:()=>s,toc:()=>l});var s=a(746408),r=a(886070),i=a(848193);let t={title:"package.json",sidebar_position:3},c,o={},l=[{value:"Package manager",id:"package-manager",level:3},{value:"Testing",id:"testing",level:3},{value:"Packaging",id:"packaging",level:3},{value:"Running",id:"running",level:3}];function d(e){let n={a:"a",admonition:"admonition",code:"code",h3:"h3",hr:"hr",mdxAdmonitionTitle:"mdxAdmonitionTitle",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"package.json parsing and scripts integration"}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.p,{children:["As mentioned in the ",(0,r.jsx)(n.a,{href:"/prerelease/docs/javascript/overview/",children:"overview introduction"}),", Pants's approach to enable support for Javascript is to\nbe a thin caching layer on top of your current tooling."]}),"\n",(0,r.jsxs)(n.p,{children:["Refer to the ",(0,r.jsx)(n.a,{href:"https://github.com/pantsbuild/example-javascript",children:"example repository"})," for example usage."]}),"\n",(0,r.jsx)(n.h3,{id:"package-manager",children:"Package manager"}),"\n",(0,r.jsxs)(n.p,{children:["Pants uses ",(0,r.jsx)(n.code,{children:"corepack"})," to manage package manager versions and installation. Like ",(0,r.jsx)(n.code,{children:"corepack"}),', Pants respects\nthe experimental "packageManager" feature in ',(0,r.jsx)(n.code,{children:"package.json"})," files."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",metastring:'title="package.json"',children:'{\n    "name": "@my-company/pkg",\n    "packageManager": "yarn@1.22.22"\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["this setting will ensure that all scripts invoked for this package.json, and any\n",(0,r.jsx)(n.a,{href:"/prerelease/docs/javascript/overview/workspaces",children:"workspaces managed by this package.json"})," will use this particular version of ",(0,r.jsx)(n.code,{children:"yarn"}),".\nIt can be more convenient to define a project level\n",(0,r.jsx)(n.a,{href:"/prerelease/docs/javascript/overview/enabling-javascript-support#setting-up-a-package-manager",children:"package manager"}),"."]}),"\n",(0,r.jsxs)(n.admonition,{type:"tip",children:[(0,r.jsxs)(n.mdxAdmonitionTitle,{children:["Choosing between ",(0,r.jsx)(n.code,{children:"pants.toml"})," or ",(0,r.jsx)(n.code,{children:"package.json"})," for package manager version configuration"]}),(0,r.jsxs)(n.p,{children:["In general, if your team runs all tooling via Pants, using ",(0,r.jsx)(n.code,{children:"pants.toml"}),' reduces boilerplate in cases where you maintain\nmultiple packages. If your team mixes usage of Pants and "bare" package manager invocations, package.json#packageManager\nis the safer option.']})]}),"\n",(0,r.jsx)(n.h3,{id:"testing",children:"Testing"}),"\n",(0,r.jsxs)(n.p,{children:["By default Pants assumes a ",(0,r.jsx)(n.code,{children:"package_json"})," target mapping a ",(0,r.jsx)(n.code,{children:"package.json"})," includes a test script, e.g."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",metastring:'title="package.json"',children:'{\n    "name": "@my-company/pkg",\n    "scripts": {\n        "test": "jest"\n    },\n    "devDependencies": {\n        "jest": "^29.5.0"\n    }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["and will use this script to execute your tests when running ",(0,r.jsx)(n.code,{children:"pants test ::"}),".\nSee ",(0,r.jsx)(n.a,{href:"/prerelease/docs/using-pants/key-concepts/goals#goal-arguments",children:"Goal arguments"})," for the normal techniques for telling Pants what to\nrun on."]}),"\n",(0,r.jsxs)(n.p,{children:["To enable configurability, the build symbol ",(0,r.jsx)(n.a,{href:"../../../reference/build-file-symbols/node_test_script",children:(0,r.jsx)(n.code,{children:"node_test_script"})}),'\ncontains options for changing the entry point from "test", and to enable coverage reporting.']}),"\n",(0,r.jsx)(n.h3,{id:"packaging",children:"Packaging"}),"\n",(0,r.jsxs)(n.p,{children:["Similarly, build scripts can be introduced to Pants via the\n",(0,r.jsx)(n.a,{href:"../../../reference/build-file-symbols/node_build_script",children:(0,r.jsx)(n.code,{children:"node_build_script"})})," build symbol. This is intended to be used\nas a way to introduce artifacts generated via bundlers and/or compilers installed and ran via your package manager.\nThe result can the be consumed by other targets as either ",(0,r.jsx)(n.code,{children:"resource"}),"-targets that can be depended on,\nor as a package for the ",(0,r.jsx)(n.a,{href:"/prerelease/docs/docker/",children:"docker backend"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"running",children:"Running"}),"\n",(0,r.jsxs)(n.p,{children:["Runnable scripts can be specified and invoked through Pants via the ",(0,r.jsx)(n.code,{children:"run"})," goal. This is meant to support scripts\nthat are not directly tied to testing or packaging workflows."]}),"\n",(0,r.jsxs)(n.p,{children:["Given a ",(0,r.jsx)(n.code,{children:"package.json"})," that defines a runnable script, e.g."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",metastring:'title="package.json"',children:'{\n    "name": "@my-company/pkg",\n    "scripts": {\n        "start": "node server.js"\n    }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["we can define the build symbol ",(0,r.jsx)(n.a,{href:"../../../reference/build-file-symbols/node_run_script",children:(0,r.jsx)(n.code,{children:"node_run_script"})}),", e.g."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",metastring:'title="BUILD"',children:'package_json(\n    name="pkg",\n    scripts=[\n        node_run_script(entry_point="start"),\n    ],\n)\n'})}),"\n",(0,r.jsxs)(n.p,{children:["which allows us to run the script via the ",(0,r.jsx)(n.code,{children:"pants"})," cli, e.g."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",metastring:'title="Shell"',children:"pants run :pkg#start\n"})})]})}function p(e={}){let{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},848193(e,n,a){a.d(n,{R:()=>t,x:()=>c});var s=a(830758);let r={},i=s.createContext(r);function t(e){let n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),s.createElement(i.Provider,{value:n},e.children)}},746408(e){e.exports=JSON.parse('{"id":"docs/javascript/overview/package","title":"package.json","description":"package.json parsing and scripts integration","source":"@site/versioned_docs/version-2.31/docs/javascript/overview/package.mdx","sourceDirName":"docs/javascript/overview","slug":"/docs/javascript/overview/package","permalink":"/prerelease/docs/javascript/overview/package","draft":false,"unlisted":false,"editUrl":"https://github.com/pantsbuild/pants/edit/main/docs/docs/javascript/overview/package.mdx","tags":[],"version":"2.31","sidebarPosition":3,"frontMatter":{"title":"package.json","sidebar_position":3},"sidebar":"docsSidebar","previous":{"title":"Lockfiles","permalink":"/prerelease/docs/javascript/overview/lockfiles"},"next":{"title":"Enabling TypeScript support","permalink":"/prerelease/docs/javascript/overview/enabling-typescript-support"}}')}}]);
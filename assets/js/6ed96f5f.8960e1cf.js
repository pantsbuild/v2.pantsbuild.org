"use strict";(self.webpackChunkpantsbuild_org=self.webpackChunkpantsbuild_org||[]).push([["536917"],{139415(e,t,n){n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>c,frontMatter:()=>o,metadata:()=>s,toc:()=>h});var s=n(197009),i=n(886070),r=n(848193);let o={authors:["chrisjrn"],tags:["python","jvm","announcement"]},a="Pants 2.13: Easier at the command line, easier parallel execution in CI, Kotlin support, and better Python and JVM support!",l={authorsImageUrls:[void 0]},h=[{value:"Making it easier to work with file sets at the command line",id:"making-it-easier-to-work-with-file-sets-at-the-command-line",level:2},{value:"Easy parallel execution in CI with test sharding",id:"easy-parallel-execution-in-ci-with-test-sharding",level:2},{value:"Experimental Kotlin on JVM Support",id:"experimental-kotlin-on-jvm-support",level:2},{value:"Improved fine-tuning in JVM builds with per-tool options",id:"improved-fine-tuning-in-jvm-builds-with-per-tool-options",level:2},{value:"Improved IDE support for JVM languages",id:"improved-ide-support-for-jvm-languages",level:2},{value:"More efficient remote cache access",id:"more-efficient-remote-cache-access",level:2},{value:"Lower barriers to adoption for Python open source projects",id:"lower-barriers-to-adoption-for-python-open-source-projects",level:2},{value:"Other notable changes",id:"other-notable-changes",level:2},{value:"Thanks!",id:"thanks",level:2}];function d(e){let t={a:"a",code:"code",h2:"h2",hr:"hr",li:"li",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components},{CaptionedImg:s}=t;return s||function(e,t){throw Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("CaptionedImg",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s,{src:n(985281).A,children:(0,i.jsxs)(t.p,{children:["Photo by ",(0,i.jsx)(t.a,{href:"https://unsplash.com/@hngstrm?utm_source=ghost&utm_medium=referral&utm_campaign=api-credit",children:"Henry &\nCo."}),"\n/\n",(0,i.jsx)(t.a,{href:"https://unsplash.com/?utm_source=ghost&utm_medium=referral&utm_campaign=api-credit",children:"Unsplash"})]})}),"\n",(0,i.jsx)(t.p,{children:"We're pleased to announce Pants 2.13.0. Highlights include better command line arguments for file sets, improved JVM support, easier access to parallel execution in CI, and lower barriers to adoption for Python projects that currently use existing distribution and build tools."}),"\n","\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.p,{children:"We're pleased to announce Pants 2.13.0, the latest release of Pants, the scalable and ergonomic build system. Highlights of this release include experimental support for Kotlin on the JVM, better command line arguments for file sets, improved JVM support, easier access to parallel execution in CI, and lower barriers to adoption for Python projects that currently use existing distribution and build tools."}),"\n",(0,i.jsxs)(t.p,{children:["You can update by setting ",(0,i.jsx)(t.code,{children:'pants_version = "2.13.0"'})," in your ",(0,i.jsx)(t.code,{children:"pants.toml"})," file. See ",(0,i.jsx)(t.a,{href:"https://www.pantsbuild.org/docs/upgrade-tips",children:"upgrade tips"})," for more information."]}),"\n",(0,i.jsx)(t.h2,{id:"making-it-easier-to-work-with-file-sets-at-the-command-line",children:"Making it easier to work with file sets at the command line"}),"\n",(0,i.jsx)(t.p,{children:"We've improved our command line arguments to make it easier to run Pants against multiple files, and making the behavior of different goals more consistent, so they're easier to learn and remember."}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsxs)(t.a,{href:"https://www.pantsbuild.org/v2.13/docs/reference-filter#target_type",children:["You can now ",(0,i.jsx)(t.code,{children:"filter"})," targets in a goal"]}),", which lets you select targets of a specific type from a broader set of targets. For example, it's now easy to run just the Python tests when running the ",(0,i.jsx)(t.code,{children:"test"})," goal over your entire codebase:"]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Before"}),": ",(0,i.jsx)(t.code,{children:"./pants filter --target-type=python_test :: | xargs ./pants test"})]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"After"}),": ",(0,i.jsx)(t.code,{children:"./pants --filter-target-type=python_test test ::"})," [",(0,i.jsx)(t.a,{href:"https://github.com/pantsbuild/pants/pull/15599",children:"#15599"}),"]"]}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["You can now easily run Pants against all targets in a directory by ",(0,i.jsx)(t.a,{href:"https://www.pantsbuild.org/v2.13/docs/goals#goal-arguments",children:"specifying a directory name at the command line"}),". Previously, specifying a directory name was a shorthand for a specific target in a directory."]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.a,{href:"https://www.pantsbuild.org/v2.13/docs/goals#goal-arguments",children:"You can now selectively ignore targets, files, and directories"})," when running a goal against a set of files. To ignore targets, add an extra argument, prefixed with a ",(0,i.jsx)(t.code,{children:"-"}),", for example, to run all of your Python tests, except the ",(0,i.jsx)(t.code,{children:"integration_tests"})," directory, you could run ",(0,i.jsx)(t.code,{children:"./pants test src/py:: -src/py/integration_tests"}),". [",(0,i.jsx)(t.a,{href:"https://github.com/pantsbuild/pants/pull/15619",children:"#15619"}),"]"]}),"\n",(0,i.jsxs)(t.p,{children:["Finally, you can now supply files to any Pants goal in the same way! Previously, some goals handled arguments in their own way, making it difficult to switch between goals, or use multiple goals for the same invocation. Now, the ",(0,i.jsx)(t.code,{children:"::"})," glob, or the ",(0,i.jsx)(t.code,{children:"--changed-since"})," command line option works for any goal that needs a list of targets. For example, try ",(0,i.jsx)(t.code,{children:"./pants count-loc ::"})," to get the lines of code in your project (previously, you'd need to use ",(0,i.jsx)(t.code,{children:"**"}),"), or ",(0,i.jsx)(t.code,{children:"./pants --changed-since=HEAD update-build-files"})," to only format changed ",(0,i.jsx)(t.code,{children:"BUILD"})," files [",(0,i.jsx)(t.a,{href:"https://github.com/pantsbuild/pants/pull/15577",children:"#15577"}),"], [",(0,i.jsx)(t.a,{href:"https://github.com/pantsbuild/pants/pull/14434",children:"#14434"}),"]"]}),"\n",(0,i.jsx)(t.h2,{id:"easy-parallel-execution-in-ci-with-test-sharding",children:"Easy parallel execution in CI with test sharding"}),"\n",(0,i.jsxs)(t.p,{children:["One goal of Pants is to make it easier to speed up your build and CI suites. Up until now, Pants' support for speeding up builds with parallelism has been limited to ",(0,i.jsx)(t.a,{href:"https://www.pantsbuild.org/v2.13/docs/remote-execution",children:"remote execution"})," services. Remote execution is highly flexible, at a cost of higher complexity."]}),"\n",(0,i.jsxs)(t.p,{children:["For an easier first step into speeding up your test suite in CI, Pants 2.13 adds support for ",(0,i.jsx)(t.a,{href:"https://www.pantsbuild.org/v2.13/docs/reference-test#shard",children:"sharded test suites"}),", which splits test execution across a configurable number of machines. Parallelism with sharding can give faster results than running on a single machine, while being easier to get started than a remote execution suite."]}),"\n",(0,i.jsxs)(t.p,{children:["To enable, use the ",(0,i.jsx)(t.code,{children:"PANTS_TEST_SHARD"})," environment variable or ",(0,i.jsx)(t.code,{children:"--test-shard"})," command line option. Setting a value of ",(0,i.jsx)(t.code,{children:"k/N"})," will deterministically split your test suite into ",(0,i.jsx)(t.code,{children:"N"})," shards (by number of files only) and run the ",(0,i.jsx)(t.code,{children:"k"}),"th subset of that shard. [",(0,i.jsx)(t.a,{href:"https://github.com/pantsbuild/pants/pull/15417",children:"#15417"}),"]"]}),"\n",(0,i.jsx)(t.h2,{id:"experimental-kotlin-on-jvm-support",children:"Experimental Kotlin on JVM Support"}),"\n",(0,i.jsx)(t.p,{children:"Fresh after adding support for Java and Scala, we've added initial support for Kotlin on the JVM, which brings all of the features from other JVM languages including multiple lockfile support for third-party dependencies, and JUnit for running your tests, along with integration with popular Kotlin tools including KtLint."}),"\n",(0,i.jsx)(t.p,{children:"Kotlin support is still work-in-progress, but we'd love for you to try it out and let us know how we can improve it."}),"\n",(0,i.jsx)(t.h2,{id:"improved-fine-tuning-in-jvm-builds-with-per-tool-options",children:"Improved fine-tuning in JVM builds with per-tool options"}),"\n",(0,i.jsxs)(t.p,{children:["Following on from our initial experimental JVM support first released last year, Pants 2.13 now allows you to provide per-tool configuration for the underlying steps in your build. This is particularly handy for adjusting memory allocations for ",(0,i.jsx)(t.a,{href:"https://www.scala-lang.org/",children:"more heavyweight compilers"})," without increasing the memory for tools that don't need it."]}),"\n",(0,i.jsx)(t.p,{children:"The end result is that you should be able to run more JVM build steps in parallel on the same machine."}),"\n",(0,i.jsxs)(t.p,{children:["To enable, you can set the ",(0,i.jsx)(t.code,{children:"jvm_options"})," setting in the relevant tool's configuration block in your ",(0,i.jsx)(t.code,{children:"pants.toml"})," file. See, for example, our ",(0,i.jsx)(t.a,{href:"https://www.pantsbuild.org/v2.13/docs/reference-junit#jvm_options",children:"JUnit support documentation"}),". [",(0,i.jsx)(t.a,{href:"https://github.com/pantsbuild/pants/pull/15505",children:"#15505"}),"]"]}),"\n",(0,i.jsx)(t.h2,{id:"improved-ide-support-for-jvm-languages",children:"Improved IDE support for JVM languages"}),"\n",(0,i.jsxs)(t.p,{children:["Our Build Server Protocol-based IDE support has gained a few more features since the initial release in Pants 2.12. We now support automatic JDK configuration for Scala projects, and it's now possible for IntelliJ to run tests against class files that have been built by Pants [",(0,i.jsx)(t.a,{href:"https://github.com/pantsbuild/pants/pull/15408",children:"#15408"}),"], [",(0,i.jsx)(t.a,{href:"https://github.com/pantsbuild/pants/pull/15347",children:"#15347"}),"]."]}),"\n",(0,i.jsx)(t.h2,{id:"more-efficient-remote-cache-access",children:"More efficient remote cache access"}),"\n",(0,i.jsxs)(t.p,{children:["We've added new behaviors to our ",(0,i.jsx)(t.a,{href:"https://www.pantsbuild.org/docs/remote-caching",children:"remote cache support"})," which can improve the efficiency and performance by optionally skipping downloads of cache entries where possible."]}),"\n",(0,i.jsxs)(t.p,{children:["With the new ",(0,i.jsx)(t.a,{href:"https://www.pantsbuild.org/v2.13/docs/reference-global#section-cache-content-behavior",children:(0,i.jsx)(t.code,{children:'[GLOBAL].cache_content_behavior = "validate"'})})," flag, Pants will register a cache hit after validating that the contents exist, rather than first requiring a successful download. Depending on the shape of their code, users have seen anywhere from 25% to 75% fewer bytes downloaded in CI runs with ",(0,i.jsx)(t.code,{children:'"validate"'})," set. Please try it out and let us know what you think!"]}),"\n",(0,i.jsxs)(t.p,{children:["Because this can change the behavior of builds when a remote cache is flaky or unavailable, ",(0,i.jsx)(t.code,{children:'"validate"'})," mode remains optional behavior, with the old-style ",(0,i.jsx)(t.code,{children:'"fetch"'})," behavior remaining the default.\xa0 [",(0,i.jsx)(t.a,{href:"https://github.com/pantsbuild/pants/pull/16409",children:"#16409"}),"]"]}),"\n",(0,i.jsx)(t.h2,{id:"lower-barriers-to-adoption-for-python-open-source-projects",children:"Lower barriers to adoption for Python open source projects"}),"\n",(0,i.jsxs)(t.p,{children:["We're also working towards making it easier to adopt pants in Python projects that use the setuptools or distutils workflows. This release adds support for ",(0,i.jsx)(t.code,{children:"setuptools_scm"})," and ",(0,i.jsx)(t.code,{children:"mypyc"}),"."]}),"\n",(0,i.jsxs)(t.p,{children:["Pants 2.13 ",(0,i.jsxs)(t.a,{href:"https://www.pantsbuild.org/v2.13/docs/reference-vcs_version",children:["adds support for the ",(0,i.jsx)(t.code,{children:"setuptools_scm"})," tools"]}),", which allow Python projects to ",(0,i.jsx)(t.a,{href:"https://www.pantsbuild.org/v2.13/docs/generating-version-tags#the-vcs_version-target",children:"use git tags and commit hashes to set the project version in built packages"}),". Files generated by ",(0,i.jsx)(t.code,{children:"setuptools_scm"})," are fully supported by existing Pants features`, including dependency inference [",(0,i.jsx)(t.a,{href:"https://github.com/pantsbuild/pants/pull/15374",children:"#15374"}),"], [",(0,i.jsx)(t.a,{href:"https://github.com/pantsbuild/pants/pull/15385",children:"#15385"}),"]."]}),"\n",(0,i.jsxs)(t.p,{children:["We've also started building out initial support for Python build-time requirements, starting with producing dists that use ",(0,i.jsx)(t.code,{children:"mypyc"})," in their existing ",(0,i.jsx)(t.code,{children:"setup.py"})," file [",(0,i.jsx)(t.a,{href:"https://github.com/pantsbuild/pants/pull/15380",children:"#15380"}),"]."]}),"\n",(0,i.jsx)(t.h2,{id:"other-notable-changes",children:"Other notable changes"}),"\n",(0,i.jsxs)(t.p,{children:["As always, this release brings a ",(0,i.jsx)(t.a,{href:"https://github.com/pantsbuild/pants/blob/2.13.x/src/python/pants/notes/2.13.x.md",children:"whole pile of smaller features, improvements, and bugfixes"}),", including:"]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"./pants test"})," and ",(0,i.jsx)(t.code,{children:"./pants run"})," support for visual debuggers in Python [",(0,i.jsx)(t.a,{href:"https://github.com/pantsbuild/pants/pull/15799",children:"#15799"}),"]"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"./pants run"})," support for arbitrary Python targets [",(0,i.jsx)(t.a,{href:"https://github.com/pantsbuild/pants/pull/16022",children:"#16022"}),"]"]}),"\n",(0,i.jsxs)(t.li,{children:["Numerous ",(0,i.jsx)(t.code,{children:"tailor"})," improvements including support for ",(0,i.jsx)(t.code,{children:"poetry_requirements"})," and ",(0,i.jsx)(t.code,{children:"pipenv_requirements"})," [",(0,i.jsx)(t.a,{href:"https://github.com/pantsbuild/pants/pull/15352",children:"#15352"}),"],"]}),"\n",(0,i.jsxs)(t.li,{children:["Adding file downloading support to asset targets [",(0,i.jsx)(t.a,{href:"https://github.com/pantsbuild/pants/pull/15457",children:"#15457"}),"]"]}),"\n",(0,i.jsxs)(t.li,{children:["Support for Kotlin JUnit tests [",(0,i.jsx)(t.a,{href:"https://github.com/pantsbuild/pants/pull/15382",children:"#15382"}),"]"]}),"\n",(0,i.jsxs)(t.li,{children:["Added the option ",(0,i.jsx)(t.code,{children:"lint --skip-formatters"})," to avoid running formatters like Black and Scalafmt in check-only mode. [",(0,i.jsx)(t.a,{href:"https://github.com/pantsbuild/pants/pull/15427",children:"#15427"}),"]"]}),"\n",(0,i.jsxs)(t.li,{children:["Improved error messages for invalid target addresses. [",(0,i.jsx)(t.a,{href:"https://github.com/pantsbuild/pants/pull/15751",children:"#15751"}),"]"]}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["See the full ",(0,i.jsx)(t.a,{href:"https://github.com/pantsbuild/pants/blob/release_2.13.0/src/python/pants/notes/2.13.x.md",children:"changelog"})," for more changes, along with our ",(0,i.jsx)(t.a,{href:"https://www.pantsbuild.org/docs/plugin-upgrade-guide",children:"plugin upgrade guide"}),"."]}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.p,{children:"Try out one of our example repositories:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://github.com/pantsbuild/example-python",children:"example-python"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://github.com/pantsbuild/example-golang",children:"example-golang"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://github.com/pantsbuild/example-jvm",children:"example-jvm"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://github.com/pantsbuild/example-kotlin",children:"example-kotlin"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://github.com/pantsbuild/example-codegen",children:"example-codegen"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://github.com/pantsbuild/example-docker",children:"example-docker"})}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["And let us know what you think in ",(0,i.jsx)(t.a,{href:"https://www.pantsbuild.org/docs/getting-help",children:"Slack!"})]}),"\n",(0,i.jsx)(t.h2,{id:"thanks",children:"Thanks!"}),"\n",(0,i.jsx)(t.p,{children:"Pants wouldn't be possible without everyone who contributed to 2.13, including everyone who shared feedback on changes and who tested release candidates! Thank you all!"})]})}function c(e={}){let{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},985281(e,t,n){n.d(t,{A:()=>s});let s=n.p+"assets/images/splash-e5175696ae906996699a4f39095eafc8.jpg"},848193(e,t,n){n.d(t,{R:()=>o,x:()=>a});var s=n(830758);let i={},r=s.createContext(i);function o(e){let t=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(r.Provider,{value:t},e.children)}},197009(e){e.exports=JSON.parse('{"permalink":"/blog/2022/09/01/introducing-pants-2-13","editUrl":"https://github.com/pantsbuild/pantsbuild.org/edit/main/blog/2022-09-01-introducing-pants-2-13/index.mdx","source":"@site/blog/2022-09-01-introducing-pants-2-13/index.mdx","title":"Pants 2.13: Easier at the command line, easier parallel execution in CI, Kotlin support, and better Python and JVM support!","description":"Photo by [Henry &","date":"2022-09-01T00:00:00.000Z","tags":[{"inline":true,"label":"python","permalink":"/blog/tags/python"},{"inline":true,"label":"jvm","permalink":"/blog/tags/jvm"},{"inline":true,"label":"announcement","permalink":"/blog/tags/announcement"}],"readingTime":7.38,"hasTruncateMarker":true,"authors":[{"name":"Christopher Neugebauer","title":"Pants Maintainer","url":"https://github.com/chrisjrn","imageURL":"https://github.com/chrisjrn.png","key":"chrisjrn","page":null}],"frontMatter":{"authors":["chrisjrn"],"tags":["python","jvm","announcement"]},"unlisted":false,"prevItem":{"title":"Meet our newest Maintainer: A. Alonso Dominguez","permalink":"/blog/2022/09/02/meet-our-newest-maintainer-a-alonso-dominguez"},"nextItem":{"title":"Astranis Case Study: Wrangling Python In a Monorepo","permalink":"/blog/2022/08/12/astranis-case-study-wrangling-python-in-a-monorepo"}}')}}]);
"use strict";(self.webpackChunkpantsbuild_org=self.webpackChunkpantsbuild_org||[]).push([["282540"],{727640(e,n,t){t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>d});var s=t(287900),i=t(886070),o=t(848193);let r={title:"Initial configuration",sidebar_position:2},a,c={},d=[];function l(e){let n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",hr:"hr",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",ol:"ol",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"Creating the configuration necessary to run Pants."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.p,{children:"To get started in a new repository, follow these steps, and then visit one of the language-specific overview pages."}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.h1,{id:"create-pantstoml",children:["Create ",(0,i.jsx)(n.code,{children:"pants.toml"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Pants configuration lives in a file called ",(0,i.jsx)(n.code,{children:"pants.toml"})," in the root of the repo. This file uses the ",(0,i.jsx)(n.a,{href:"https://github.com/toml-lang/toml",children:"TOML"})," format."]}),"\n",(0,i.jsxs)(n.p,{children:["If you haven't yet, create a ",(0,i.jsx)(n.code,{children:"pants.toml"})," file:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-toml",metastring:'title="pants.toml"',children:'[GLOBAL]\npants_version = "$PANTS_VERSION"\n'})}),"\n",(0,i.jsxs)(n.p,{children:["where ",(0,i.jsx)(n.code,{children:"$PANTS_VERSION"})," is the version of Pants that you want to pin your repo to. When you'd like to upgrade Pants, edit ",(0,i.jsx)(n.code,{children:"pants_version"})," and the ",(0,i.jsx)(n.code,{children:"pants"})," script will self-update on the next run."]}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.h1,{id:"configure-source-roots",children:"Configure source roots"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Many languages organize code in a package hierarchy, so that the relative location of a source file on the filesystem corresponds to a logical package name. The directories that correspond to the roots of the language's package hierarchy are referred to as ",(0,i.jsx)(n.a,{href:"/2.17/docs/using-pants/key-concepts/source-roots",children:"source roots"}),". These are the filesystem locations from which import paths are computed."]}),"\n",(0,i.jsxs)(n.p,{children:["For example, if your Python code lives under ",(0,i.jsx)(n.code,{children:"src/python"}),", then ",(0,i.jsx)(n.code,{children:"import myorg.myproject.app"})," will import the code in ",(0,i.jsx)(n.code,{children:"src/python/myorg/myproject/app.py"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["In simple cases the root of the repository itself might be your only source root. But in many other cases the code is organized so that the source root is nested under some directory such as ",(0,i.jsx)(n.code,{children:"src/"})," or ",(0,i.jsx)(n.code,{children:"src/<language name>"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["To work correctly, Pants needs to know about the source roots in your repo. By default, given a source file path, Pants will treat the longest path prefix that ends in ",(0,i.jsx)(n.code,{children:"src"}),", ",(0,i.jsx)(n.code,{children:"src/python"}),", or ",(0,i.jsx)(n.code,{children:"src/py"})," as its source root, falling back to the repo root itself if no such prefix is found."]}),"\n",(0,i.jsxs)(n.p,{children:["If your project has a different structure, see ",(0,i.jsx)(n.a,{href:"/2.17/docs/using-pants/key-concepts/source-roots",children:"Source roots"})," for how to configure them, and for examples of different project structures you can use Pants with."]}),"\n",(0,i.jsx)(n.admonition,{title:"Golang projects can skip this step",type:"note",children:(0,i.jsxs)(n.p,{children:["Golang projects already use ",(0,i.jsx)(n.code,{children:"go.mod"})," to indicate source roots."]})}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.h1,{id:"enable-backends",children:"Enable backends"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Most Pants functionality is provided via pluggable ",(0,i.jsx)(n.a,{href:"/2.17/docs/using-pants/key-concepts/backends",children:(0,i.jsx)(n.em,{children:"backends"})}),", which are activated by adding to the ",(0,i.jsx)(n.code,{children:"[GLOBAL].backend_packages"})," option like this:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-toml",metastring:'title="pants.toml"',children:'[GLOBAL]\n...\nbackend_packages = [\n  "pants.backend.experimental.go",\n  "pants.backend.python",\n  "pants.backend.python.lint.black",\n]\n'})}),"\n",(0,i.jsxs)(n.p,{children:["See ",(0,i.jsx)(n.a,{href:"/2.17/docs/using-pants/key-concepts/backends",children:"here"})," for a list of available backends."]}),"\n",(0,i.jsxs)(n.ol,{start:"4",children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.h1,{id:"update-gitignore",children:["Update ",(0,i.jsx)(n.code,{children:".gitignore"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["If you use Git, we recommend adding these lines to your top-level ",(0,i.jsx)(n.code,{children:".gitignore"})," file:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",metastring:'title=".gitignore"',children:"# Pants workspace files\n/.pants.*\n/dist/\n/.pids\n"})}),"\n",(0,i.jsxs)(n.admonition,{type:"note",children:[(0,i.jsxs)(n.mdxAdmonitionTitle,{children:["FYI: Pants will ignore all files in your ",(0,i.jsx)(n.code,{children:".gitignore"})," by default"]}),(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"pants_ignore"})," option tells Pants which files to avoid looking at, but it additionally ignores all ",(0,i.jsx)(n.code,{children:".gitignore"}),"d files by default. Occasionally, you will want to ignore something with Git, but still want Pants to work on the file. See ",(0,i.jsx)(n.a,{href:"/2.17/docs/using-pants/troubleshooting-common-issues",children:"Troubleshooting / common issues"})," for how to do this."]})]}),"\n",(0,i.jsxs)(n.ol,{start:"5",children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.h1,{id:"generate-build-files",children:"Generate BUILD files"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Once you have enabled the backends for the language(s) you'd like to use, run ",(0,i.jsx)(n.a,{href:"/2.17/docs/getting-started/initial-configuration#5-generate-build-files",children:(0,i.jsx)(n.code,{children:"pants tailor ::"})})," to generate an initial set of ",(0,i.jsx)(n.a,{href:"/2.17/docs/using-pants/key-concepts/targets-and-build-files",children:"BUILD"})," files."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"/2.17/docs/using-pants/key-concepts/targets-and-build-files",children:"BUILD"})," files provide metadata about your code (the timeout of a test, any dependencies which cannot be inferred, etc). BUILD files are typically located in the same directory as the code they describe. Unlike many other systems, Pants BUILD files are usually very succinct, as most metadata is either inferred from static analysis, assumed from sensible defaults, or generated for you."]}),"\n",(0,i.jsxs)(n.p,{children:["In general, you should create (and update) BUILD files by running ",(0,i.jsx)(n.code,{children:"pants tailor ::"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"\u276F pants tailor ::\nCreated scripts/BUILD:\n  - Add shell_sources target scripts\nCreated src/py/project/BUILD:\n  - Add python_sources target project\n  - Add python_tests target tests\nCreated src/go/BUILD:\n  - Add go_mod target mod\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Often, this will be all you need for Pants to work, thanks to sensible defaults and inference, like ",(0,i.jsx)(n.a,{href:"/2.17/docs/using-pants/key-concepts/targets-and-build-files",children:"inferring your dependencies"}),". Sometimes, though, you may need to or want to change certain fields, like setting a longer timeout on a test."]}),"\n",(0,i.jsxs)(n.p,{children:["You may also need to add some targets that Pants cannot generate, like ",(0,i.jsxs)(n.a,{href:"/2.17/docs/using-pants/assets-and-archives",children:[(0,i.jsx)(n.code,{children:"resources"})," and ",(0,i.jsx)(n.code,{children:"files"})]})," targets."]}),"\n",(0,i.jsxs)(n.p,{children:["To ignore false positives, set ",(0,i.jsx)(n.code,{children:"[tailor].ignore_paths"})," and ",(0,i.jsx)(n.code,{children:"[tailor].ignore_adding_targets"}),". See ",(0,i.jsx)(n.a,{href:"/2.17/reference/goals/tailor",children:"tailor"})," for more detail."]}),"\n",(0,i.jsxs)(n.admonition,{type:"note",children:[(0,i.jsxs)(n.mdxAdmonitionTitle,{children:["Run ",(0,i.jsx)(n.code,{children:"pants tailor --check ::"})," in CI"]}),(0,i.jsxs)(n.p,{children:["We recommend running ",(0,i.jsx)(n.code,{children:"pants tailor --check ::"})," in your ",(0,i.jsx)(n.a,{href:"/2.17/docs/using-pants/using-pants-in-ci",children:"continuous integration"})," so that you don't forget to add any targets and BUILD files (which might mean that tests aren't run or code isn't validated)."]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"\u276F pants tailor --check ::\nWould create scripts/BUILD:\n  - Add shell_sources target scripts\n\nTo fix `tailor` failures, run `pants tailor`.\n"})})]}),"\n",(0,i.jsxs)(n.ol,{start:"6",children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.h1,{id:"visit-a-language-specific-overview",children:"Visit a language specific overview"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"You're almost ready to go! Next up is visiting one of the language-specific overviews listed below."})]})}function h(e={}){let{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},848193(e,n,t){t.d(n,{R:()=>r,x:()=>a});var s=t(830758);let i={},o=s.createContext(i);function r(e){let n=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(o.Provider,{value:n},e.children)}},287900(e){e.exports=JSON.parse('{"id":"docs/getting-started/initial-configuration","title":"Initial configuration","description":"Creating the configuration necessary to run Pants.","source":"@site/versioned_docs/version-2.17/docs/getting-started/initial-configuration.mdx","sourceDirName":"docs/getting-started","slug":"/docs/getting-started/initial-configuration","permalink":"/2.17/docs/getting-started/initial-configuration","draft":false,"unlisted":false,"editUrl":"https://github.com/pantsbuild/pants/edit/main/docs/docs/getting-started/initial-configuration.mdx","tags":[],"version":"2.17","sidebarPosition":2,"frontMatter":{"title":"Initial configuration","sidebar_position":2},"sidebar":"docsSidebar","previous":{"title":"Installing Pants","permalink":"/2.17/docs/getting-started/installing-pants"},"next":{"title":"Example projects and repositories","permalink":"/2.17/docs/getting-started/example-projects-and-repositories"}}')}}]);
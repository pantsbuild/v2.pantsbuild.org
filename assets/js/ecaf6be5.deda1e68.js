"use strict";(self.webpackChunkpantsbuild_org=self.webpackChunkpantsbuild_org||[]).push([["95513"],{654007(e,t,n){n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>d,default:()=>p,frontMatter:()=>a,metadata:()=>i,toc:()=>l});var i=n(823414),r=n(886070),s=n(848193);let a={title:"Extending existing targets",sidebar_position:3},d,o={},l=[{value:"When to add new fields?",id:"when-to-add-new-fields",level:2},{value:"How to add new fields",id:"how-to-add-new-fields",level:2}];function g(e){let t={a:"a",code:"code",h2:"h2",hr:"hr",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.p,{children:"Adding new fields to target types."}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h2,{id:"when-to-add-new-fields",children:"When to add new fields?"}),"\n",(0,r.jsx)(t.p,{children:"Adding new fields is useful when you are already using a target type, but need to store additional metadata for your plugin."}),"\n",(0,r.jsxs)(t.p,{children:["For example, if you're writing a codegen plugin to convert a ",(0,r.jsx)(t.code,{children:"protobuf_library"})," into Java source files, you may want to add a ",(0,r.jsx)(t.code,{children:"jdk_version"})," field to ",(0,r.jsx)(t.code,{children:"protobuf_library"}),"."]}),"\n",(0,r.jsxs)(t.p,{children:["If you are instead adding support for a new language, ",(0,r.jsx)(t.a,{href:"/2.5/docs/writing-plugins/the-target-api/creating-new-targets",children:"create a new target type"}),"."]}),"\n",(0,r.jsxs)(t.p,{children:["If you want to reduce boilerplate in BUILD files, such as changing default values, use ",(0,r.jsx)(t.a,{href:"/2.5/docs/writing-plugins/macros",children:"macros"}),"."]}),"\n",(0,r.jsx)(t.h2,{id:"how-to-add-new-fields",children:"How to add new fields"}),"\n",(0,r.jsxs)(t.p,{children:["First, ",(0,r.jsx)(t.a,{href:"/2.5/docs/writing-plugins/the-target-api/creating-new-fields",children:"define the field"}),". Then, register it by using ",(0,r.jsx)(t.code,{children:"OriginalTarget.register_plugin_field(CustomField)"}),", like this:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-python",metastring:'title="plugins/register.py"',children:'from pants.backend.codegen.protobuf.target_types import ProtobufLibrary\nfrom pants.engine.target import BoolField\n\n\nclass ProtobufJdkVersion(IntField):\n    alias = "jdk_version"\n    default = 11\n    help = "Which JDK protobuf should target."\n\n\ndef rules():\n    return [ProtobufLibrary.register_plugin_field(ProtobufJdkVersion)]\n'})}),"\n",(0,r.jsxs)(t.p,{children:["To confirm this worked, run ",(0,r.jsx)(t.code,{children:"./pants help protobuf_library"}),", and you should see your new field."]})]})}function p(e={}){let{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(g,{...e})}):g(e)}},848193(e,t,n){n.d(t,{R:()=>a,x:()=>d});var i=n(830758);let r={},s=i.createContext(r);function a(e){let t=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(s.Provider,{value:t},e.children)}},823414(e){e.exports=JSON.parse('{"id":"docs/writing-plugins/the-target-api/extending-existing-targets","title":"Extending existing targets","description":"Adding new fields to target types.","source":"@site/versioned_docs/version-2.5/docs/writing-plugins/the-target-api/extending-existing-targets.mdx","sourceDirName":"docs/writing-plugins/the-target-api","slug":"/docs/writing-plugins/the-target-api/extending-existing-targets","permalink":"/2.5/docs/writing-plugins/the-target-api/extending-existing-targets","draft":false,"unlisted":false,"editUrl":"https://github.com/pantsbuild/pants/edit/main/docs/docs/writing-plugins/the-target-api/extending-existing-targets.mdx","tags":[],"version":"2.5","sidebarPosition":3,"frontMatter":{"title":"Extending existing targets","sidebar_position":3},"sidebar":"docsSidebar","previous":{"title":"Creating new targets","permalink":"/2.5/docs/writing-plugins/the-target-api/creating-new-targets"},"next":{"title":"The Rules API","permalink":"/2.5/docs/writing-plugins/the-rules-api/"}}')}}]);
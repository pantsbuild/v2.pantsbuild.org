"use strict";(self.webpackChunkpantsbuild_org=self.webpackChunkpantsbuild_org||[]).push([["978313"],{217641(e,n,t){t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>l});var i=t(958075),s=t(886070),r=t(848193);let o={title:"How does Pants work?",sidebar_position:1},a,c={},l=[{value:"The Pants Engine",id:"the-pants-engine",level:2},{value:"What are the benefits?",id:"what-are-the-benefits",level:2},{value:"Concurrency",id:"concurrency",level:3},{value:"Caching",id:"caching",level:3},{value:"Remote Execution",id:"remote-execution",level:3},{value:"Fine-grained invalidation",id:"fine-grained-invalidation",level:3},{value:"Hermetic execution",id:"hermetic-execution",level:3},{value:"Dependency inference",id:"dependency-inference",level:3},{value:"A powerful plugin system",id:"a-powerful-plugin-system",level:3}];function d(e){let n={a:"a",code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components},{CaptionedImg:i}=n;return i||function(e,n){throw Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("CaptionedImg",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"the-pants-engine",children:"The Pants Engine"}),"\n",(0,s.jsx)(n.p,{children:'Pants is built around the "v2" engine, which is completely new technology, built from the ground up, based on lessons learned from working on the previous, "v1", technology.'}),"\n",(0,s.jsxs)(n.p,{children:["The Pants engine is written in ",(0,s.jsx)(n.a,{href:"https://www.rust-lang.org/",children:"Rust"}),", for performance. The build rules that it uses are written in typed Python 3, for familiarity and simplicity."]}),"\n",(0,s.jsx)(n.p,{children:"The engine is designed so that fine-grained invalidation, concurrency, hermeticity, caching, and remote execution happen naturally, without rule authors needing to think about it."}),"\n",(0,s.jsx)(n.h2,{id:"what-are-the-benefits",children:"What are the benefits?"}),"\n",(0,s.jsx)(n.h3,{id:"concurrency",children:"Concurrency"}),"\n",(0,s.jsxs)(n.p,{children:["The engine can take full advantage of all the cores on your machine because relevant portions are implemented in Rust atop the ",(0,s.jsx)(n.a,{href:"https://tokio.rs/",children:"Tokio"})," framework."]}),"\n",(0,s.jsx)(i,{src:t(624818).A,children:(0,s.jsx)(n.p,{children:"Pants running multiple linters in parallel."})}),"\n",(0,s.jsx)(n.p,{children:"This means, for example, that you can run all of your linters at the same time, and\nfully utilize your cores to run tests in parallel."}),"\n",(0,s.jsx)(n.h3,{id:"caching",children:"Caching"}),"\n",(0,s.jsx)(n.p,{children:"The engine caches processes precisely based on their inputs, and sandboxes execution to minimize side-effects and to make builds consistent and repeatable."}),"\n",(0,s.jsx)(i,{src:t(647712).A,children:(0,s.jsx)(n.p,{children:"We run both tests, then add a syntax error to one test and rerun; the\nunmodified test uses the cache and is isolated from the syntax error."})}),"\n",(0,s.jsx)(n.h3,{id:"remote-execution",children:"Remote Execution"}),"\n",(0,s.jsx)(n.p,{children:"The engine can delegate work to a remote build cluster so that you are no longer limited by the number of cores on your machine. If you have enough remote workers, you can run your entire test suite in total parallelism."}),"\n",(0,s.jsx)(n.p,{children:"Remote caching means that your coworkers and your CI can reuse the results of commands you already ran."}),"\n",(0,s.jsx)(n.h3,{id:"fine-grained-invalidation",children:"Fine-grained invalidation"}),"\n",(0,s.jsx)(n.p,{children:"Work is broken down into many small units and kept warm in a daemon so that as little work as possible needs to be re-done when files change."}),"\n",(0,s.jsx)(n.h3,{id:"hermetic-execution",children:"Hermetic execution"}),"\n",(0,s.jsx)(n.p,{children:"Pants sandboxes all processes that it executes, ensuring that cache keys are always accurate, and builds are always correct."}),"\n",(0,s.jsx)(n.h3,{id:"dependency-inference",children:"Dependency inference"}),"\n",(0,s.jsx)(n.p,{children:"Pants analyzes your code's import statements to determine files' dependencies automatically. Dependency information is required for precise change detection and cache invalidation, but inference means that you don't need to declare dependencies manually (and hermetic execution guarantees that they are always accurate)!"}),"\n",(0,s.jsx)(n.p,{children:"Older build tools like Bazel:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",metastring:'title="BUILD"',children:'python_library(\n  name="lib"\n  deps=[\n    "//src/python/project/core",\n    "//src/python/project/models:customer",\n    "//src/python/project/models:organization",\n    "//src/python/project/models:policy",\n    "//src/python/project/models:user",\n    "//src/python/project/views:dashboard",\n    "//src/python/project/util:csrf_util",\n    "//src/python/project/util:strutil",\n  ],\n)\n\npython_tests(\n  name="tests",\n  deps=[\n    ...\n  ],\n)\n'})}),"\n",(0,s.jsx)(n.p,{children:"Pants 2:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",metastring:'title="BUILD"',children:'python_sources(name="lib")\npython_tests(name="tests")\n'})}),"\n",(0,s.jsx)(n.h3,{id:"a-powerful-plugin-system",children:"A powerful plugin system"}),"\n",(0,s.jsxs)(n.p,{children:["With the ",(0,s.jsx)(n.a,{href:"/2.10/docs/writing-plugins/overview",children:"Pants plugin API"}),", your custom rules will run with the same concurrency, caching, and remoting semantics as the core rules."]}),"\n",(0,s.jsx)(n.p,{children:"Some example plugins that users have written:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Cython support"}),"\n",(0,s.jsxs)(n.li,{children:["Building a Docker image, including packages built via ",(0,s.jsx)(n.code,{children:"./pants package"})]}),"\n",(0,s.jsxs)(n.li,{children:["Custom ",(0,s.jsx)(n.code,{children:"setup.py"})," logic to compute the ",(0,s.jsx)(n.code,{children:"version"})," dynamically"]}),"\n",(0,s.jsx)(n.li,{children:"Jupyter support"}),"\n"]})]})}function h(e={}){let{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},647712(e,n,t){t.d(n,{A:()=>i});let i=t.p+"assets/images/pants-caching-faee1dea72985ef995c03941e42a990f.gif"},624818(e,n,t){t.d(n,{A:()=>i});let i=t.p+"assets/images/pants-concurrency-1a1005b556b95e98e196eefff02f818d.gif"},848193(e,n,t){t.d(n,{R:()=>o,x:()=>a});var i=t(830758);let s={},r=i.createContext(s);function o(e){let n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(r.Provider,{value:n},e.children)}},958075(e){e.exports=JSON.parse('{"id":"docs/introduction/how-does-pants-work","title":"How does Pants work?","description":"---","source":"@site/versioned_docs/version-2.10/docs/introduction/how-does-pants-work.mdx","sourceDirName":"docs/introduction","slug":"/docs/introduction/how-does-pants-work","permalink":"/2.10/docs/introduction/how-does-pants-work","draft":false,"unlisted":false,"editUrl":"https://github.com/pantsbuild/pants/edit/main/docs/docs/introduction/how-does-pants-work.mdx","tags":[],"version":"2.10","sidebarPosition":1,"frontMatter":{"title":"How does Pants work?","sidebar_position":1},"sidebar":"docsSidebar","previous":{"title":"Welcome to Pants!","permalink":"/2.10/docs/introduction/welcome-to-pants"},"next":{"title":"Getting started","permalink":"/2.10/docs/getting-started/"}}')}}]);
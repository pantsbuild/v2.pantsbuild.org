"use strict";(self.webpackChunkpantsbuild_org=self.webpackChunkpantsbuild_org||[]).push([["75982"],{903098(e,t,s){s.r(t),s.d(t,{assets:()=>a,contentTitle:()=>l,default:()=>p,frontMatter:()=>o,metadata:()=>n,toc:()=>d});var n=s(645507),i=s(886070),r=s(848193);let o={title:"Common subsystem tasks",sidebar_position:999},l,a={},d=[{value:"Skipping individual targets",id:"skipping-individual-targets",level:2}];function c(e){let t={code:"code",h2:"h2",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.p,{children:"Common tasks for Subsystems"}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"skipping-individual-targets",children:"Skipping individual targets"}),"\n",(0,i.jsxs)(t.p,{children:["Many subsystems allow skipping specific targets. For example, you might have Python files that you want to not typecheck with mypy. In Pants, this is achieved with a ",(0,i.jsx)(t.code,{children:"skip_*"})," field on the target. This is simple to implement."]}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsx)(t.li,{children:"Create a field for skipping your tool"}),"\n"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-python",children:'from pants.engine.target import BoolField\n\nclass SkipFortranLintField(BoolField):\n	alias = "skip_fortran_lint"\n	default = False\n	help = "If true, don\'t run fortran-lint on this target\'s code."\n'})}),"\n",(0,i.jsxs)(t.ol,{start:"2",children:["\n",(0,i.jsx)(t.li,{children:"Register this field on the appropriate targets."}),"\n"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-python",children:"def rules():\n	return [\n		FortranSourceTarget.register_plugin_field(SkipFortranLintField),\n	]\n"})}),"\n",(0,i.jsxs)(t.ol,{start:"3",children:["\n",(0,i.jsxs)(t.li,{children:["Add this field as part of your subsystems ",(0,i.jsx)(t.code,{children:"opt_out"})," method:"]}),"\n"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-python",children:"from dataclasses import dataclass\n\nfrom pants.engine.target import FieldSet, Target\n\n\n@dataclass\nclass FortranLintFieldSet(FieldSet):\n    required_fields = (FortranSourceField,)\n\n    source: FortranSourceField\n\n    @classmethod\n    def opt_out(cls, tgt: Target) -> bool:\n        return tgt.get(SkipFortranLintField).value\n"})})]})}function p(e={}){let{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},848193(e,t,s){s.d(t,{R:()=>o,x:()=>l});var n=s(830758);let i={},r=n.createContext(i);function o(e){let t=n.useContext(r);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),n.createElement(r.Provider,{value:t},e.children)}},645507(e){e.exports=JSON.parse('{"id":"docs/writing-plugins/common-subsystem-tasks","title":"Common subsystem tasks","description":"Common tasks for Subsystems","source":"@site/versioned_docs/version-2.20/docs/writing-plugins/common-subsystem-tasks.mdx","sourceDirName":"docs/writing-plugins","slug":"/docs/writing-plugins/common-subsystem-tasks","permalink":"/2.20/docs/writing-plugins/common-subsystem-tasks","draft":false,"unlisted":false,"editUrl":"https://github.com/pantsbuild/pants/edit/main/docs/docs/writing-plugins/common-subsystem-tasks.mdx","tags":[],"version":"2.20","sidebarPosition":999,"frontMatter":{"title":"Common subsystem tasks","sidebar_position":999},"sidebar":"docsSidebar","previous":{"title":"Plugin helpers","permalink":"/2.20/docs/writing-plugins/common-plugin-tasks/plugin-helpers"},"next":{"title":"Deprecation policy","permalink":"/2.20/docs/releases/deprecation-policy"}}')}}]);
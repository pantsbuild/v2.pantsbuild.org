"use strict";(self.webpackChunkpantsbuild_org=self.webpackChunkpantsbuild_org||[]).push([["898078"],{420439(e,n,s){s.r(n),s.d(n,{assets:()=>r,contentTitle:()=>t,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>c});var i=s(752712),l=s(886070),o=s(848193);let a={title:"Options",sidebar_position:2},t,r={},c=[{value:"Option scopes",id:"option-scopes",level:2},{value:"Setting options",id:"setting-options",level:2},{value:"Command-line flags",id:"command-line-flags",level:3},{value:"Environment variables",id:"environment-variables",level:3},{value:"Config file entries",id:"config-file-entries",level:3},{value:"Option types",id:"option-types",level:2},{value:"String and integer values",id:"string-and-integer-values",level:3},{value:"Command-line flags:",id:"command-line-flags-1",level:4},{value:"Environment variables:",id:"environment-variables-1",level:4},{value:"Config file entries:",id:"config-file-entries-1",level:4},{value:"Boolean values",id:"boolean-values",level:3},{value:"Command-line flags:",id:"command-line-flags-2",level:4},{value:"Environment variables:",id:"environment-variables-2",level:4},{value:"Config file entries:",id:"config-file-entries-2",level:4},{value:"List values",id:"list-values",level:3},{value:"Command-line flags:",id:"command-line-flags-3",level:4},{value:"Environment variables:",id:"environment-variables-3",level:4},{value:"Config file entries:",id:"config-file-entries-3",level:4},{value:"Dict values",id:"dict-values",level:3},{value:"Command-line flags:",id:"command-line-flags-4",level:4},{value:"Environment variables:",id:"environment-variables-4",level:4},{value:"Config file entries:",id:"config-file-entries-4",level:4}];function d(e){let n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.p,{children:"A deep dive into how options may be configured."}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"option-scopes",children:"Option scopes"}),"\n",(0,l.jsxs)(n.p,{children:["Options are partitioned into named ",(0,l.jsx)(n.em,{children:"scopes"}),"."]}),"\n",(0,l.jsxs)(n.p,{children:["Some systemwide options belong in the ",(0,l.jsx)(n.em,{children:"global scope"}),". For example, the ",(0,l.jsx)(n.code,{children:"--level"})," option, which controls the logging level, is in the global scope."]}),"\n",(0,l.jsxs)(n.p,{children:["Other options belong to a ",(0,l.jsx)(n.em,{children:"subsystem scope"}),". A ",(0,l.jsx)(n.em,{children:"subsystem"})," is simply a collection of related options, in a scope. For example, the ",(0,l.jsx)(n.code,{children:"source"})," subsystem contains options related to ",(0,l.jsx)(n.a,{href:"./source-roots",children:"source roots"}),"."]}),"\n",(0,l.jsx)(n.h2,{id:"setting-options",children:"Setting options"}),"\n",(0,l.jsx)(n.p,{children:"Every option can be set in the following ways, in order of precedence:"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"Via a command line flag."}),"\n",(0,l.jsx)(n.li,{children:"In an environment variable."}),"\n",(0,l.jsx)(n.li,{children:"In the config file."}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"If an option isn't set in one of these ways, it will take on a default value."}),"\n",(0,l.jsxs)(n.p,{children:["You can inspect both the current value and the default value by using ",(0,l.jsx)(n.code,{children:"./pants help $scope"})," or ",(0,l.jsx)(n.code,{children:"./pants help-advanced $scope"}),"."]}),"\n",(0,l.jsx)(n.h3,{id:"command-line-flags",children:"Command-line flags"}),"\n",(0,l.jsx)(n.p,{children:"Global options are set using an unqualified flag:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"./pants --level=debug ...\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Subsystem options are set by providing the flag, with the name prefixed with the lower-case scope name and a dash. So for the option ",(0,l.jsx)(n.code,{children:"--root-patterns"})," in the scope ",(0,l.jsx)(n.code,{children:"source"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"./pants --source-root-patterns=\"['^ext']\"\n"})}),"\n",(0,l.jsx)(n.h3,{id:"environment-variables",children:"Environment variables"}),"\n",(0,l.jsxs)(n.p,{children:["Global options are set using the environment variable ",(0,l.jsx)(n.code,{children:"PANTS_{OPTION_NAME}"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"PANTS_LEVEL=debug ./pants ...\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Subsystem options are set using the environment variable\n",(0,l.jsx)(n.code,{children:"PANTS_{SCOPE}_{OPTION_NAME}"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"PANTS_SOURCE_ROOT_PATTERNS=\"['^ext']\" ./pants ...\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Note that the scope and option name are upper-cased, and any dashes in the option flag name are converted to underscores: ",(0,l.jsx)(n.code,{children:"--multiword-name"})," becomes ",(0,l.jsx)(n.code,{children:"MULTIWORD_NAME"}),"."]}),"\n",(0,l.jsx)(n.h3,{id:"config-file-entries",children:"Config file entries"}),"\n",(0,l.jsxs)(n.p,{children:["Global options are set in the ",(0,l.jsx)(n.code,{children:"GLOBAL"})," section of the config file:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-toml",children:'[GLOBAL]\nlevel = "debug"\n'})}),"\n",(0,l.jsx)(n.p,{children:"Subsystem options are set in the section named for their scope:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-toml",children:'[source]\nroot_patterns = ["/src/python"]\n'})}),"\n",(0,l.jsxs)(n.p,{children:["Note that any dashes in the option flag name are converted to underscores: ",(0,l.jsx)(n.code,{children:"--multiword-name"})," becomes ",(0,l.jsx)(n.code,{children:"multiword_name"}),"."]}),"\n",(0,l.jsxs)(n.p,{children:["Additionally, a few different variables may be interpolated into strings in config files via a ",(0,l.jsx)(n.code,{children:"%(var)s"})," syntax. For example, this expands to the absolute path of a file in the root of your repository:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-toml",children:'[GLOBAL]\npythonpath = ["%(buildroot)s/examples"]\n'})}),"\n",(0,l.jsx)(n.h2,{id:"option-types",children:"Option types"}),"\n",(0,l.jsx)(n.p,{children:"Every option has a type, and any values you set must be of that type."}),"\n",(0,l.jsx)(n.p,{children:"The option types are:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"string"}),"\n",(0,l.jsx)(n.li,{children:"integer"}),"\n",(0,l.jsx)(n.li,{children:"bool"}),"\n",(0,l.jsx)(n.li,{children:"list"}),"\n",(0,l.jsx)(n.li,{children:"dict"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"A list-valued option may also declare a specific type for its members (e.g., a list of strings, or a list of integers)."}),"\n",(0,l.jsx)(n.h3,{id:"string-and-integer-values",children:"String and integer values"}),"\n",(0,l.jsx)(n.p,{children:"Standalone string and integer values are written without quotes. Any quotes will be considered part of the value, after shell escaping."}),"\n",(0,l.jsx)(n.h4,{id:"command-line-flags-1",children:"Command-line flags:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"./pants --scope-intopt=42\n./pants --scope-stropt=qux\n"})}),"\n",(0,l.jsx)(n.h4,{id:"environment-variables-1",children:"Environment variables:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"PANTS_SCOPE_INTOPT=42\nPANTS_SCOPE_STROPT=qux\n"})}),"\n",(0,l.jsx)(n.h4,{id:"config-file-entries-1",children:"Config file entries:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-toml",children:'[scope]\nintopt = 42\nstropt = "qux"\n'})}),"\n",(0,l.jsx)(n.h3,{id:"boolean-values",children:"Boolean values"}),"\n",(0,l.jsxs)(n.p,{children:["Boolean values can be specified using the special strings ",(0,l.jsx)(n.code,{children:"true"})," and ",(0,l.jsx)(n.code,{children:"false"}),". When specifying them via command-line flags you can also use the ",(0,l.jsx)(n.code,{children:"--boolflag/--no-boolflag"})," syntax."]}),"\n",(0,l.jsx)(n.h4,{id:"command-line-flags-2",children:"Command-line flags:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"./pants --scope-boolopt=true\n./pants --scope-boolopt\n./pants --no-scope-boolopt\n"})}),"\n",(0,l.jsx)(n.h4,{id:"environment-variables-2",children:"Environment variables:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"PANTS_SCOPE_BOOLOPT=true\n"})}),"\n",(0,l.jsx)(n.h4,{id:"config-file-entries-2",children:"Config file entries:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-toml",children:"[scope]\nboolopt = true\n"})}),"\n",(0,l.jsx)(n.h3,{id:"list-values",children:"List values"}),"\n",(0,l.jsx)(n.p,{children:"List values are parsed as Python list literals, so you must quote string values, and you may need to apply shell-level quoting and/or escaping, as required."}),"\n",(0,l.jsx)(n.h4,{id:"command-line-flags-3",children:"Command-line flags:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"./pants --scope-listopt=\"['foo','bar']\"\n"})}),"\n",(0,l.jsx)(n.h4,{id:"environment-variables-3",children:"Environment variables:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"PANTS_SCOPE_LISTOPT=\"['foo','bar']\"\n"})}),"\n",(0,l.jsx)(n.h4,{id:"config-file-entries-3",children:"Config file entries:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-toml",children:"[scope]\nlistopt = [\n  'foo',\n  'bar'\n]\n"})}),"\n",(0,l.jsx)(n.p,{children:"List values have some extra semantics:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["A value can be preceded by ",(0,l.jsx)(n.code,{children:"+"}),", which will ",(0,l.jsx)(n.em,{children:"append"})," the elements to the value obtained from lower-precedence sources."]}),"\n",(0,l.jsxs)(n.li,{children:["A value can be preceded by ",(0,l.jsx)(n.code,{children:"-"}),", which will ",(0,l.jsx)(n.em,{children:"remove"})," the elements from the value obtained from lower-precedence sources."]}),"\n",(0,l.jsxs)(n.li,{children:["Multiple ",(0,l.jsx)(n.code,{children:"+"})," and ",(0,l.jsx)(n.code,{children:"-"})," values can be provided, separated by commas."]}),"\n",(0,l.jsxs)(n.li,{children:["Otherwise, the value ",(0,l.jsx)(n.em,{children:"replaces"})," the one obtained from lower-precedence sources."]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["For example, if the value of ",(0,l.jsx)(n.code,{children:"--listopt"})," in ",(0,l.jsx)(n.code,{children:"scope"})," is set to ",(0,l.jsx)(n.code,{children:"[1, 2]"})," in a config file, then"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'./pants --scope-listopt="+[3,4]"\n'})}),"\n",(0,l.jsxs)(n.p,{children:["will set the value to ",(0,l.jsx)(n.code,{children:"[1, 2, 3, 4]"}),"."]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'./pants --scope-listopt="-[1],+[3,4]"\n'})}),"\n",(0,l.jsxs)(n.p,{children:["will set the value to ",(0,l.jsx)(n.code,{children:"[2, 3, 4]"}),", and"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'./pants --scope-listopt="[3,4]"\n'})}),"\n",(0,l.jsxs)(n.p,{children:["will set the value to ",(0,l.jsx)(n.code,{children:"[3, 4]"}),"."]}),"\n",(0,l.jsxs)(n.admonition,{title:"Add/remove syntax in .toml files",type:"note",children:[(0,l.jsx)(n.p,{children:"The +/- syntax works in .toml files, but the entire value must be quoted:"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-toml",children:'[scope]\nlistopt = "+[1,2],-[3,4]"\n'})}),(0,l.jsx)(n.p,{children:"This means that TOML treats the value as a string, instead of a TOML list."}),(0,l.jsx)(n.p,{children:"Alternatively, you can use this syntactic sugar, which allows the values to be regular TOML lists:"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-toml",children:"[scope]\nlistopt.add = [1, 2]\nlistopt.remove = [3, 4]\n"})}),(0,l.jsx)(n.p,{children:"But note that this only works in Pants's .toml config files, not in environment variables or command-line flags."})]}),"\n",(0,l.jsx)(n.h3,{id:"dict-values",children:"Dict values"}),"\n",(0,l.jsx)(n.p,{children:"Dict values are parsed as Python dict literals, so you must quote string keys and values, and you may need to apply shell-level quoting and/or escaping, as required."}),"\n",(0,l.jsx)(n.h4,{id:"command-line-flags-4",children:"Command-line flags:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"./pants --scope-dictopt=\"{'foo':1,'bar':2}\"\n"})}),"\n",(0,l.jsx)(n.h4,{id:"environment-variables-4",children:"Environment variables:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"PANTS_SCOPE_DICTOPT=\"{'foo':1,'bar':2}\"\n"})}),"\n",(0,l.jsx)(n.h4,{id:"config-file-entries-4",children:"Config file entries:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-toml",children:'[scope]\ndictopt = """{\n  \'foo\': 1,\n  \'bar\': 2\n}"""\n# Note that dict values in .toml files must be quoted.\n'})}),"\n",(0,l.jsx)(n.p,{children:"Dict values have some extra semantics:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["A value can be preceded by ",(0,l.jsx)(n.code,{children:"+"}),", which will ",(0,l.jsx)(n.em,{children:"update"})," the value obtained from lower-precedence sources with the entries."]}),"\n",(0,l.jsxs)(n.li,{children:["Otherwise, the value ",(0,l.jsx)(n.em,{children:"replaces"})," the one obtained from lower-precendence sources."]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["For example, if the value of ",(0,l.jsx)(n.code,{children:"--dictopt"})," in ",(0,l.jsx)(n.code,{children:"scope"})," is set to ",(0,l.jsx)(n.code,{children:"{'foo', 1, 'bar': 2}"})," in a config file, then"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"./pants --scope-dictopt=\"+{'foo':42,'baz':3}\"\n"})}),"\n",(0,l.jsxs)(n.p,{children:["will set the value to ",(0,l.jsx)(n.code,{children:"{'foo': 42, 'bar': 2, 'baz': 3}"}),", and"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"./pants --scope-dictopt=\"{'foo':42,'baz':3}\"\n"})}),"\n",(0,l.jsxs)(n.p,{children:["will set the value to ",(0,l.jsx)(n.code,{children:"{'foo': 42, 'baz': 3}"}),"."]})]})}function h(e={}){let{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},848193(e,n,s){s.d(n,{R:()=>a,x:()=>t});var i=s(830758);let l={},o=i.createContext(l);function a(e){let n=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:a(e.components),i.createElement(o.Provider,{value:n},e.children)}},752712(e){e.exports=JSON.parse('{"id":"docs/using-pants/key-concepts/options","title":"Options","description":"A deep dive into how options may be configured.","source":"@site/versioned_docs/version-2.7/docs/using-pants/key-concepts/options.mdx","sourceDirName":"docs/using-pants/key-concepts","slug":"/docs/using-pants/key-concepts/options","permalink":"/2.7/docs/using-pants/key-concepts/options","draft":false,"unlisted":false,"editUrl":"https://github.com/pantsbuild/pants/edit/main/docs/docs/using-pants/key-concepts/options.mdx","tags":[],"version":"2.7","sidebarPosition":2,"frontMatter":{"title":"Options","sidebar_position":2},"sidebar":"docsSidebar","previous":{"title":"Targets and BUILD files","permalink":"/2.7/docs/using-pants/key-concepts/targets-and-build-files"},"next":{"title":"Backends","permalink":"/2.7/docs/using-pants/key-concepts/backends"}}')}}]);
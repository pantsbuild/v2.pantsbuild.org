"use strict";(self.webpackChunkpantsbuild_org=self.webpackChunkpantsbuild_org||[]).push([["726015"],{502964(e,n,r){r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>h});var s=r(460160),t=r(886070),c=r(848193),i=r(989898),d=r(375002);let o={title:"run_shell_command",description:"Run a script in the workspace, with all dependencies packaged/copied into a chroot.\n"},l,a={},h=[{value:"<code>command</code>",id:"command",level:2},{value:"<code>description</code>",id:"description",level:2},{value:"<code>execution_dependencies</code>",id:"execution_dependencies",level:2},{value:"<code>runnable_dependencies</code>",id:"runnable_dependencies",level:2},{value:"<code>tags</code>",id:"tags",level:2},{value:"<code>workdir</code>",id:"workdir",level:2}];function p(e){let n={code:"code",h2:"h2",hr:"hr",li:"li",p:"p",pre:"pre",ul:"ul",...(0,c.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.p,{children:"Run a script in the workspace, with all dependencies packaged/copied into a chroot."}),"\n",(0,t.jsx)(n.p,{children:"Example BUILD file:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'run_shell_command(\n    command="./scripts/my-script.sh --data-files-dir={chroot}",\n    execution_dependencies=["src/project/files:data"],\n)\n'})}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"command"})," may use either ",(0,t.jsx)(n.code,{children:"{chroot}"})," on the command line, or the ",(0,t.jsx)(n.code,{children:"$CHROOT"})," environment variable to get the root directory for where any dependencies are located."]}),"\n",(0,t.jsxs)(n.p,{children:["In contrast to the ",(0,t.jsx)(n.code,{children:"shell_command"}),", in addition to ",(0,t.jsx)(n.code,{children:"workdir"})," you only have the ",(0,t.jsx)(n.code,{children:"command"})," and ",(0,t.jsx)(n.code,{children:"execution_dependencies"})," fields as the ",(0,t.jsx)(n.code,{children:"tools"})," you are going to use are already on the PATH which is inherited from the Pants environment. Also, the ",(0,t.jsx)(n.code,{children:"outputs"})," does not apply, as any output files produced will end up directly in your project tree."]}),"\n",(0,t.jsxs)(n.p,{children:["Backend: ",(0,t.jsx)("span",{className:"color--primary",children:(0,t.jsx)(n.code,{children:"pants.backend.shell"})})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)("span",{className:d.A.options,children:[(0,t.jsx)(n.h2,{id:"command",children:(0,t.jsx)(n.code,{children:"command"})}),(0,t.jsxs)(i.A,{type_repr:"str",children:[(0,t.jsx)(n.p,{children:"Shell command to execute."}),(0,t.jsxs)(n.p,{children:["The command is executed as ",(0,t.jsx)(n.code,{children:"'bash -c <command>'"})," by default. If you want to invoke a binary use ",(0,t.jsx)(n.code,{children:"exec -a $0 <binary> <args>"})," as the command so that the binary gets the correct ",(0,t.jsx)(n.code,{children:"argv[0]"})," set."]})]}),(0,t.jsx)(n.h2,{id:"description",children:(0,t.jsx)(n.code,{children:"description"})}),(0,t.jsxs)(i.A,{type_repr:"str | None",default_repr:"None",children:[(0,t.jsx)(n.p,{children:"A human-readable description of the target."}),(0,t.jsxs)(n.p,{children:["Use ",(0,t.jsx)(n.code,{children:"pants list --documented ::"})," to see all targets with descriptions."]})]}),(0,t.jsx)(n.h2,{id:"execution_dependencies",children:(0,t.jsx)(n.code,{children:"execution_dependencies"})}),(0,t.jsxs)(i.A,{type_repr:"Iterable[str] | None",default_repr:"None",children:[(0,t.jsx)(n.p,{children:"The execution dependencies for this command."}),(0,t.jsx)(n.p,{children:"Dependencies specified here are those required to make the command complete successfully (e.g. file inputs, packages compiled from other targets, etc), but NOT required to make the outputs of the command useful."}),(0,t.jsxs)(n.p,{children:["See also ",(0,t.jsx)(n.code,{children:"runnable_dependencies"}),"."]})]}),(0,t.jsx)(n.h2,{id:"runnable_dependencies",children:(0,t.jsx)(n.code,{children:"runnable_dependencies"})}),(0,t.jsxs)(i.A,{type_repr:"Iterable[str] | None",default_repr:"None",children:[(0,t.jsx)(n.p,{children:"The runnable dependencies for this command."}),(0,t.jsxs)(n.p,{children:["Dependencies specified here are those required to exist on the ",(0,t.jsx)(n.code,{children:"PATH"})," to make the command complete successfully (interpreters specified in a ",(0,t.jsx)(n.code,{children:"#!"})," command, etc). Note that these dependencies will be made available on the ",(0,t.jsx)(n.code,{children:"PATH"})," with the name of the target."]}),(0,t.jsxs)(n.p,{children:["See also ",(0,t.jsx)(n.code,{children:"execution_dependencies"}),"."]})]}),(0,t.jsx)(n.h2,{id:"tags",children:(0,t.jsx)(n.code,{children:"tags"})}),(0,t.jsxs)(i.A,{type_repr:"Iterable[str] | None",default_repr:"None",children:[(0,t.jsx)(n.p,{children:"Arbitrary strings to describe a target."}),(0,t.jsxs)(n.p,{children:["For example, you may tag some test targets with 'integration_test' so that you could run ",(0,t.jsx)(n.code,{children:"pants --tag='integration_test' test ::"})," to only run on targets with that tag."]})]}),(0,t.jsx)(n.h2,{id:"workdir",children:(0,t.jsx)(n.code,{children:"workdir"})}),(0,t.jsxs)(i.A,{type_repr:"str | None",default_repr:"'.'",children:[(0,t.jsx)(n.p,{children:"Sets the working directory for the process."}),(0,t.jsx)(n.p,{children:"Values are relative to the build root, except in the following cases:"}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"."})," specifies the location of the ",(0,t.jsx)(n.code,{children:"BUILD"})," file."]}),"\n",(0,t.jsxs)(n.li,{children:["Values beginning with ",(0,t.jsx)(n.code,{children:"./"})," are relative to the location of the ",(0,t.jsx)(n.code,{children:"BUILD"})," file."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"/"})," or the empty string specifies the build root."]}),"\n",(0,t.jsxs)(n.li,{children:["Values beginning with ",(0,t.jsx)(n.code,{children:"/"})," are also relative to the build root."]}),"\n"]})]})]})]})}function u(e={}){let{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(p,{...e})}):p(e)}},375002(e,n,r){r.d(n,{A:()=>s});let s={options:"options_nrbo"}},989898(e,n,r){r.d(n,{A:()=>t});var s=r(886070);function t({children:e,type_repr:n,default_repr:r,backend:t}){return(0,s.jsxs)("div",{className:"margin-bottom--lg",children:[(0,s.jsx)("code",{style:{color:"var(--pants-reference-option-repr)"},children:n}),(0,s.jsx)("br",{}),(0,s.jsxs)("div",{style:{paddingLeft:"2em"},children:[r&&(0,s.jsxs)("span",{children:["default:"," ",(0,s.jsx)("code",{style:{color:"var(--ifm-color-success)"},children:r})]}),!r&&(0,s.jsx)("span",{style:{color:"var(--ifm-color-success)"},children:"required"}),t&&(0,s.jsxs)("div",{children:["backend:"," ",(0,s.jsx)("code",{style:{color:"var(--ifm-color-success)"},children:t})]}),e]})]})}},848193(e,n,r){r.d(n,{R:()=>i,x:()=>d});var s=r(830758);let t={},c=s.createContext(t);function i(e){let n=s.useContext(c);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),s.createElement(c.Provider,{value:n},e.children)}},460160(e){e.exports=JSON.parse('{"id":"reference/targets/run_shell_command","title":"run_shell_command","description":"Run a script in the workspace, with all dependencies packaged/copied into a chroot.\\n","source":"@site/versioned_docs/version-2.27/reference/targets/run_shell_command.mdx","sourceDirName":"reference/targets","slug":"/reference/targets/run_shell_command","permalink":"/2.27/reference/targets/run_shell_command","draft":false,"unlisted":false,"tags":[],"version":"2.27","frontMatter":{"title":"run_shell_command","description":"Run a script in the workspace, with all dependencies packaged/copied into a chroot.\\n"},"sidebar":"referenceSidebar","previous":{"title":"resources","permalink":"/2.27/reference/targets/resources"},"next":{"title":"rust_package","permalink":"/2.27/reference/targets/rust_package"}}')}}]);
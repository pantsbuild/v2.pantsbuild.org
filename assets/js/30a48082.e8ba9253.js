"use strict";(self.webpackChunkpantsbuild_org=self.webpackChunkpantsbuild_org||[]).push([["481656"],{434069(e,t,s){s.r(t),s.d(t,{assets:()=>a,contentTitle:()=>d,default:()=>u,frontMatter:()=>c,metadata:()=>r,toc:()=>p});var r=s(830107),o=s(886070),i=s(848193),n=s(554707),l=s(375002);let c={title:"pytest",description:"The pytest Python test framework (https://docs.pytest.org/).\n"},d,a={},p=[{value:"Basic options",id:"basic-options",level:2},{value:"<code>args</code>",id:"args",level:3},{value:"<code>export</code>",id:"export",level:3},{value:"<code>xdist_enabled</code>",id:"xdist_enabled",level:3},{value:"Advanced options",id:"advanced-options",level:2},{value:"<code>config</code>",id:"config",level:3},{value:"<code>config_discovery</code>",id:"config_discovery",level:3},{value:"<code>console_script</code>",id:"console_script",level:3},{value:"<code>entry_point</code>",id:"entry_point",level:3},{value:"<code>execution_slot_var</code>",id:"execution_slot_var",level:3},{value:"<code>extra_requirements</code>",id:"extra_requirements",level:3},{value:"<code>junit_family</code>",id:"junit_family",level:3},{value:"<code>lockfile</code>",id:"lockfile",level:3},{value:"<code>version</code>",id:"version",level:3},{value:"Deprecated options",id:"deprecated-options",level:2},{value:"<code>timeout_default</code>",id:"timeout_default",level:3},{value:"<code>timeout_maximum</code>",id:"timeout_maximum",level:3},{value:"<code>timeouts</code>",id:"timeouts",level:3},{value:"Related subsystems",id:"related-subsystems",level:2}];function h(e){let t={a:"a",code:"code",h2:"h2",h3:"h3",hr:"hr",p:"p",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.hr,{}),"\n",(0,o.jsxs)(t.p,{children:["The pytest Python test framework (",(0,o.jsx)(t.a,{href:"https://docs.pytest.org/",children:"https://docs.pytest.org/"}),")."]}),"\n",(0,o.jsxs)(t.p,{children:["Backend: ",(0,o.jsx)("span",{className:"color--primary",children:(0,o.jsx)(t.code,{children:"pants.backend.python"})})]}),"\n",(0,o.jsxs)(t.p,{children:["Config section: ",(0,o.jsx)("span",{className:"color--primary",children:(0,o.jsx)(t.code,{children:"[pytest]"})})]}),"\n",(0,o.jsxs)("span",{className:l.A.options,children:[(0,o.jsx)(t.h2,{id:"basic-options",children:"Basic options"}),(0,o.jsx)(t.h3,{id:"args",children:(0,o.jsx)(t.code,{children:"args"})}),(0,o.jsx)(n.A,{cli_repr:'--pytest-args="[<shell_str>, <shell_str>, ...]", ... -- [<shell_str> [<shell_str> [...]]]',env_repr:"PANTS_PYTEST_ARGS",toml_repr:`[pytest]
args = [
  <shell_str>,
  <shell_str>,
  ...,
]`,default_repr:"[]",children:(0,o.jsxs)(t.p,{children:["Arguments to pass directly to Pytest, e.g. ",(0,o.jsx)(t.code,{children:"--pytest-args='-k test_foo --quiet'"}),"."]})}),(0,o.jsx)(t.h3,{id:"export",children:(0,o.jsx)(t.code,{children:"export"})}),(0,o.jsxs)(n.A,{cli_repr:"--[no-]pytest-export",env_repr:"PANTS_PYTEST_EXPORT",toml_repr:`[pytest]
export = <bool>`,default_repr:"True",children:[(0,o.jsxs)(t.p,{children:["If true, export a virtual environment with Pytest when running ",(0,o.jsx)(t.code,{children:"/home/josh/work/scie-pants/dist/pants export"}),"."]}),(0,o.jsx)(t.p,{children:"This can be useful, for example, with IDE integrations to point your editor to the tool's binary."})]}),(0,o.jsx)(t.h3,{id:"xdist_enabled",children:(0,o.jsx)(t.code,{children:"xdist_enabled"})}),(0,o.jsxs)(n.A,{cli_repr:"--[no-]pytest-xdist-enabled",env_repr:"PANTS_PYTEST_XDIST_ENABLED",toml_repr:`[pytest]
xdist_enabled = <bool>`,default_repr:"False",children:[(0,o.jsxs)(t.p,{children:["If true, Pants will use ",(0,o.jsx)(t.code,{children:"pytest-xdist"})," (",(0,o.jsx)(t.a,{href:"https://pytest-xdist.readthedocs.io/en/latest/",children:"https://pytest-xdist.readthedocs.io/en/latest/"}),") to parallelize tests within each ",(0,o.jsx)(t.code,{children:"python_test"})," target."]}),(0,o.jsxs)(t.p,{children:["NOTE: Enabling ",(0,o.jsx)(t.code,{children:"pytest-xdist"})," can cause high-level scoped fixtures (for example ",(0,o.jsx)(t.code,{children:"session"}),") to execute more than once. See the ",(0,o.jsx)(t.code,{children:"pytest-xdist"})," docs for more info: ",(0,o.jsx)(t.a,{href:"https://pypi.org/project/pytest-xdist/#making-session-scoped-fixtures-execute-only-once",children:"https://pypi.org/project/pytest-xdist/#making-session-scoped-fixtures-execute-only-once"})]})]}),(0,o.jsx)(t.h2,{id:"advanced-options",children:"Advanced options"}),(0,o.jsx)(t.h3,{id:"config",children:(0,o.jsx)(t.code,{children:"config"})}),(0,o.jsx)(n.A,{cli_repr:"--pytest-config=<file_option>",env_repr:"PANTS_PYTEST_CONFIG",toml_repr:`[pytest]
config = <file_option>`,default_repr:"None",children:(0,o.jsxs)(t.p,{children:["Path to a config file understood by Pytest (",(0,o.jsx)(t.a,{href:"https://docs.pytest.org/en/latest/reference/customize.html#configuration-file-formats",children:"https://docs.pytest.org/en/latest/reference/customize.html#configuration-file-formats"}),"). Setting this option will disable ",(0,o.jsx)(t.code,{children:"[pytest].config_discovery"}),". Use this option if the config is located in a non-standard location."]})}),(0,o.jsx)(t.h3,{id:"config_discovery",children:(0,o.jsx)(t.code,{children:"config_discovery"})}),(0,o.jsxs)(n.A,{cli_repr:"--[no-]pytest-config-discovery",env_repr:"PANTS_PYTEST_CONFIG_DISCOVERY",toml_repr:`[pytest]
config_discovery = <bool>`,default_repr:"True",children:[(0,o.jsxs)(t.p,{children:["If true, Pants will include all relevant Pytest config files (e.g. ",(0,o.jsx)(t.code,{children:"pytest.ini"}),") during runs. See ",(0,o.jsx)(t.a,{href:"https://docs.pytest.org/en/stable/customize.html#finding-the-rootdir",children:"https://docs.pytest.org/en/stable/customize.html#finding-the-rootdir"})," for where config files should be located for Pytest to discover them."]}),(0,o.jsxs)(t.p,{children:["Use ",(0,o.jsx)(t.code,{children:"[pytest].config"})," instead if your config is in a non-standard location."]})]}),(0,o.jsx)(t.h3,{id:"console_script",children:(0,o.jsx)(t.code,{children:"console_script"})}),(0,o.jsx)(n.A,{cli_repr:"--pytest-console-script=<str>",env_repr:"PANTS_PYTEST_CONSOLE_SCRIPT",toml_repr:`[pytest]
console_script = <str>`,default_repr:"pytest",children:(0,o.jsx)(t.p,{children:"The console script for the tool. Using this option is generally preferable to (and mutually exclusive with) specifying an --entry-point since console script names have a higher expectation of staying stable across releases of the tool. Usually, you will not want to change this from the default."})}),(0,o.jsx)(t.h3,{id:"entry_point",children:(0,o.jsx)(t.code,{children:"entry_point"})}),(0,o.jsx)(n.A,{cli_repr:"--pytest-entry-point=<str>",env_repr:"PANTS_PYTEST_ENTRY_POINT",toml_repr:`[pytest]
entry_point = <str>`,default_repr:"None",children:(0,o.jsx)(t.p,{children:"The entry point for the tool. Generally you only want to use this option if the tool does not offer a --console-script (which this option is mutually exclusive with). Usually, you will not want to change this from the default."})}),(0,o.jsx)(t.h3,{id:"execution_slot_var",children:(0,o.jsx)(t.code,{children:"execution_slot_var"})}),(0,o.jsx)(n.A,{cli_repr:"--pytest-execution-slot-var=<str>",env_repr:"PANTS_PYTEST_EXECUTION_SLOT_VAR",toml_repr:`[pytest]
execution_slot_var = <str>`,default_repr:"None",children:(0,o.jsx)(t.p,{children:"If a non-empty string, the process execution slot id (an integer) will be exposed to tests under this environment variable name."})}),(0,o.jsx)(t.h3,{id:"extra_requirements",children:(0,o.jsx)(t.code,{children:"extra_requirements"})}),(0,o.jsx)(n.A,{cli_repr:"--pytest-extra-requirements=\"['<str>', '<str>', ...]\"",env_repr:"PANTS_PYTEST_EXTRA_REQUIREMENTS",toml_repr:`[pytest]
extra_requirements = [
  '<str>',
  '<str>',
  ...,
]`,default_repr:`[
  "pytest-cov>=2.12,!=2.12.1,<3.1",
  "pytest-xdist>=2.5,<3"
]`,children:(0,o.jsx)(t.p,{children:"Any additional requirement strings to use with the tool. This is useful if the tool allows you to install plugins or if you need to constrain a dependency to a certain version."})}),(0,o.jsx)(t.h3,{id:"junit_family",children:(0,o.jsx)(t.code,{children:"junit_family"})}),(0,o.jsx)(n.A,{cli_repr:"--pytest-junit-family=<str>",env_repr:"PANTS_PYTEST_JUNIT_FAMILY",toml_repr:`[pytest]
junit_family = <str>`,default_repr:"xunit2",children:(0,o.jsxs)(t.p,{children:["The format of generated junit XML files. See ",(0,o.jsx)(t.a,{href:"https://docs.pytest.org/en/latest/reference.html#confval-junit_family",children:"https://docs.pytest.org/en/latest/reference.html#confval-junit_family"}),"."]})}),(0,o.jsx)(t.h3,{id:"lockfile",children:(0,o.jsx)(t.code,{children:"lockfile"})}),(0,o.jsxs)(n.A,{cli_repr:"--pytest-lockfile=<str>",env_repr:"PANTS_PYTEST_LOCKFILE",toml_repr:`[pytest]
lockfile = <str>`,default_repr:"<default>",children:[(0,o.jsx)(t.p,{children:"Path to a lockfile used for installing the tool."}),(0,o.jsxs)(t.p,{children:["Set to the string ",(0,o.jsx)(t.code,{children:"<default>"})," to use a lockfile provided by Pants, so long as you have not changed the ",(0,o.jsx)(t.code,{children:"--version"})," and ",(0,o.jsx)(t.code,{children:"--extra-requirements"})," options, and the tool's interpreter constraints are compatible with the default. Pants will error or warn if the lockfile is not compatible (controlled by ",(0,o.jsx)(t.code,{children:"[python].invalid_lockfile_behavior"}),"). See ",(0,o.jsx)(t.a,{href:"https://github.com/pantsbuild/pants/blob/release_2.14.2/src/python/pants/backend/python/subsystems/pytest.lock",children:"https://github.com/pantsbuild/pants/blob/release_2.14.2/src/python/pants/backend/python/subsystems/pytest.lock"})," for the default lockfile contents."]}),(0,o.jsxs)(t.p,{children:["Set to the string ",(0,o.jsx)(t.code,{children:"<none>"})," to opt out of using a lockfile. We do not recommend this, though, as lockfiles are essential for reproducible builds and supply-chain security."]}),(0,o.jsxs)(t.p,{children:["To use a custom lockfile, set this option to a file path relative to the build root, then run ",(0,o.jsx)(t.code,{children:"/home/josh/work/scie-pants/dist/pants generate-lockfiles --resolve=pytest"}),"."]}),(0,o.jsxs)(t.p,{children:["Alternatively, you can set this option to the path to a custom lockfile using pip's requirements.txt-style, ideally with ",(0,o.jsx)(t.code,{children:"--hash"}),". Set ",(0,o.jsx)(t.code,{children:"[python].invalid_lockfile_behavior = 'ignore'"})," so that Pants does not complain about missing lockfile headers."]})]}),(0,o.jsx)(t.h3,{id:"version",children:(0,o.jsx)(t.code,{children:"version"})}),(0,o.jsx)(n.A,{cli_repr:"--pytest-version=<str>",env_repr:"PANTS_PYTEST_VERSION",toml_repr:`[pytest]
version = <str>`,default_repr:"pytest==7.0.1",children:(0,o.jsx)(t.p,{children:"Requirement string for the tool."})}),(0,o.jsx)(t.h2,{id:"deprecated-options",children:"Deprecated options"}),(0,o.jsx)(t.h3,{id:"timeout_default",children:(0,o.jsx)(t.code,{children:"timeout_default"})}),(0,o.jsx)(n.A,{cli_repr:"--pytest-timeout-default=<int>",env_repr:"PANTS_PYTEST_TIMEOUT_DEFAULT",toml_repr:`[pytest]
timeout_default = <int>`,default_repr:"None",removal_version:"2.15.0.dev1",removal_hint:"Use `timeout_default` option in the `test` scope instead.",children:(0,o.jsxs)(t.p,{children:["The default timeout (in seconds) for a test target if the ",(0,o.jsx)(t.code,{children:"timeout"})," field is not set on the target."]})}),(0,o.jsx)(t.h3,{id:"timeout_maximum",children:(0,o.jsx)(t.code,{children:"timeout_maximum"})}),(0,o.jsx)(n.A,{cli_repr:"--pytest-timeout-maximum=<int>",env_repr:"PANTS_PYTEST_TIMEOUT_MAXIMUM",toml_repr:`[pytest]
timeout_maximum = <int>`,default_repr:"None",removal_version:"2.15.0.dev1",removal_hint:"Use `timeout_maximum` option in the `test` scope instead.",children:(0,o.jsxs)(t.p,{children:["The maximum timeout (in seconds) that may be used on a ",(0,o.jsx)(t.code,{children:"python_tests"})," target."]})}),(0,o.jsx)(t.h3,{id:"timeouts",children:(0,o.jsx)(t.code,{children:"timeouts"})}),(0,o.jsx)(n.A,{cli_repr:"--[no-]pytest-timeouts",env_repr:"PANTS_PYTEST_TIMEOUTS",toml_repr:`[pytest]
timeouts = <bool>`,default_repr:"True",removal_version:"2.15.0.dev1",removal_hint:"Use `timeouts` option in the `test` scope instead.",children:(0,o.jsx)(t.p,{children:"Enable test target timeouts. If timeouts are enabled then test targets with a timeout= parameter set on their target will time out after the given number of seconds if not completed. If no timeout is set, then either the default timeout is used or no timeout is configured."})}),(0,o.jsx)(t.h2,{id:"related-subsystems",children:"Related subsystems"}),(0,o.jsx)(t.p,{children:"None"})]})]})}function u(e={}){let{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(h,{...e})}):h(e)}},375002(e,t,s){s.d(t,{A:()=>r});let r={options:"options_nrbo"}},554707(e,t,s){s.d(t,{A:()=>n});var r=s(886070),o=s(384122),i=s(580830);function n({children:e,cli_repr:t,env_repr:s,toml_repr:n,one_of:l,default_repr:c,target_field_name:d,removal_version:a,removal_hint:p}){return(0,r.jsxs)("div",{className:"margin-bottom--lg",children:[(0,r.jsx)("code",{style:{color:"var(--pants-reference-option-repr)"},children:t}),(0,r.jsx)("br",{}),(0,r.jsx)("code",{style:{color:"var(--pants-reference-option-repr)"},children:s}),(0,r.jsx)("br",{}),(0,r.jsx)(o.A,{language:"toml",title:"pants.toml",children:n}),(0,r.jsxs)("div",{style:{paddingLeft:"2em"},children:[(0,r.jsxs)("span",{children:[l&&(0,r.jsxs)("span",{children:["one of:"," ",(0,r.jsx)("code",{style:{color:"var(--ifm-color-success)"},children:l}),(0,r.jsx)("br",{})]}),"default:"," ",(0,r.jsx)("span",{style:{color:"var(--ifm-color-success)"},children:(c||"").includes("\n")?(0,r.jsx)("pre",{className:"padding--sm",children:c}):(0,r.jsx)("code",{children:c})})]}),(0,r.jsx)("br",{}),a&&(0,r.jsxs)("span",{style:{color:"var(--ifm-color-danger-darkest)"},children:["Deprecated, will be removed in version: ",a,".",(0,r.jsx)("br",{}),p,(0,r.jsx)("br",{})]}),e,d&&(0,r.jsxs)("span",{children:["Can be overriden by field",(0,r.jsx)("code",{children:d})," on"," ",(0,r.jsx)(i.A,{to:"../targets/local_environment",children:(0,r.jsx)("code",{children:"local_environment"})}),","," ",(0,r.jsx)(i.A,{to:"../targets/docker_environment",children:(0,r.jsx)("code",{children:"docker_environment"})}),", or"," ",(0,r.jsx)(i.A,{to:"../targets/remote_environment",children:(0,r.jsx)("code",{children:"remote_environment"})}),"targets."]})]})]})}},830107(e){e.exports=JSON.parse('{"id":"reference/subsystems/pytest","title":"pytest","description":"The pytest Python test framework (https://docs.pytest.org/).\\n","source":"@site/versioned_docs/version-2.14/reference/subsystems/pytest.mdx","sourceDirName":"reference/subsystems","slug":"/reference/subsystems/pytest","permalink":"/2.14/reference/subsystems/pytest","draft":false,"unlisted":false,"tags":[],"version":"2.14","frontMatter":{"title":"pytest","description":"The pytest Python test framework (https://docs.pytest.org/).\\n"},"sidebar":"referenceSidebar","previous":{"title":"pyoxidizer","permalink":"/2.14/reference/subsystems/pyoxidizer"},"next":{"title":"python-bootstrap","permalink":"/2.14/reference/subsystems/python-bootstrap"}}')}}]);
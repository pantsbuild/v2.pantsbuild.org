"use strict";(self.webpackChunkpantsbuild_org=self.webpackChunkpantsbuild_org||[]).push([["661625"],{765764(e,t,n){n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>l,default:()=>c,frontMatter:()=>o,metadata:()=>r,toc:()=>d});var r=n(231066),s=n(886070),i=n(848193);let o={authors:["eric"],tags:["announcement","python"]},l="Introducing Pants 2.6: Poetry support, third-party type stubs, and linter reports",a={authorsImageUrls:[void 0]},d=[{value:"Poetry support",id:"poetry-support",level:2},{value:"Third-party type stubs and MyPy 0.900+",id:"third-party-type-stubs-and-mypy-0900",level:2},{value:"Linter reports",id:"linter-reports",level:2},{value:"Other changes",id:"other-changes",level:2},{value:"<strong>Upcoming in Pants 2.7</strong>",id:"upcoming-in-pants-27",level:3}];function p(e){let t={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components},{CaptionedImg:r}=t;return r||function(e,t){throw Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("CaptionedImg",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r,{src:n(635814).A,children:(0,s.jsxs)(t.p,{children:["Photo by ",(0,s.jsx)(t.a,{href:"https://unsplash.com/@elisa_cb?utm_source=ghost&utm_medium=referral&utm_campaign=api-credit",children:"Elisa Calvet\nB."}),"\n/\n",(0,s.jsx)(t.a,{href:"https://unsplash.com/?utm_source=ghost&utm_medium=referral&utm_campaign=api-credit",children:"Unsplash"})]})}),"\n","\n",(0,s.jsx)(t.p,{children:"We're pleased to announce Pants 2.6.0, the latest release of Pants, the scalable and ergonomic build system."}),"\n",(0,s.jsxs)(t.p,{children:["To update, set ",(0,s.jsx)(t.code,{children:'pants_version = "2.6.0"'})," in your ",(0,s.jsx)(t.code,{children:"pants.toml"}),". See ",(0,s.jsx)(t.a,{href:"https://www.pantsbuild.org/docs/upgrade-tips",children:"upgrade tips"}),"."]}),"\n",(0,s.jsx)(t.h2,{id:"poetry-support",children:"Poetry support"}),"\n",(0,s.jsxs)(t.p,{children:["Pants now understands Poetry's ",(0,s.jsx)(t.code,{children:"pyproject.toml"})," configuration for third-party dependency management, addressing one of our most requested features in the last year!"]}),"\n",(0,s.jsxs)(t.p,{children:["Poetry support makes it even easier ",(0,s.jsx)(t.a,{href:"https://www.pantsbuild.org/docs/existing-repositories",children:"to incrementally adopt Pants"}),", and you can keep using Poetry for third-party dependency management after Pants adoption. Thanks to Pants's dependency inference, you can build multiple distinct wheels/binaries using only a single pyproject.toml."]}),"\n",(0,s.jsxs)(t.p,{children:["See our recent blog post ",(0,s.jsx)(t.a,{href:"/blog/2021/07/29/poetry-support-for-pants-2-6",children:'"Poetry support for Pants 2.6"'})," for a more detailed introduction, along with the personal story behind ",(0,s.jsx)(t.a,{href:"https://toolchain.com/",children:"Toolchain"}),"'s intern Liam Wilson adding this highly requested feature."]}),"\n",(0,s.jsx)(t.h2,{id:"third-party-type-stubs-and-mypy-0900",children:"Third-party type stubs and MyPy 0.900+"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.a,{href:"https://mypy-lang.blogspot.com/2021/06/mypy-0900-released.html",children:"MyPy 0.900+ no longer includes typeshed"}),", meaning that you must now install type stubs for many popular libraries. For example, you must install ",(0,s.jsx)(t.code,{children:"types-requests"})," when using the ",(0,s.jsx)(t.code,{children:"requests"})," library for MyPy to work properly."]}),"\n",(0,s.jsxs)(t.p,{children:["Pants now understands how to ",(0,s.jsx)(t.a,{href:"/blog/2020/10/29/dependency-inference",children:"infer dependencies"})," for third-party type stubs. For example, if you have ",(0,s.jsx)(t.code,{children:"import requests"})," in your code, Pants will infer a dependency on both the implementation and the type stub."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-shell-session",children:"$ ./pants dependencies project/app.py\n3rdparty/python:requests\n3rdparty/python:types-requests\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Pants still only infers dependencies when it is safe to, meaning that it checks for ambiguity. If you have 2+ implementations\u2014like ",(0,s.jsx)(t.code,{children:"requests==2.25.1"})," and ",(0,s.jsx)(t.code,{children:"requests==2.22.0"}),"\u2014or 2+ type stub versions, Pants will not infer a dependency and will log a helpful suggestion for how to disambiguate."]}),"\n",(0,s.jsxs)(t.p,{children:["The default for ",(0,s.jsx)(t.code,{children:"[mypy].version"})," is now ",(0,s.jsx)(t.code,{children:"0.910"}),". When upgrading to Pants 2.6, you may want to pin ",(0,s.jsx)(t.code,{children:"[mypy].version"})," in ",(0,s.jsx)(t.code,{children:"pants.toml"})," to ",(0,s.jsx)(t.code,{children:"0.812"})," if you are not yet ready to upgrade; otherwise, you will need to add type stub requirements like ",(0,s.jsx)(t.code,{children:"types-requests"})," to your project (MyPy gives helpful error messages)."]}),"\n",(0,s.jsxs)(t.p,{children:["Finally, MyPy ",(0,s.jsx)(t.code,{children:"0.900+"})," now supports ",(0,s.jsx)(t.code,{children:"pyproject.toml"})," config files. Pants 2.6 will auto-discover this config file."]}),"\n",(0,s.jsx)(t.h2,{id:"linter-reports",children:"Linter reports"}),"\n",(0,s.jsxs)(t.p,{children:["Previously, you could set ",(0,s.jsx)(t.code,{children:"[lint].reports_dir"})," for Pants to instruct Flake8 and Bandit to write reports under that directory. This had ",(0,s.jsx)(t.a,{href:"https://github.com/pantsbuild/pants/pull/12122",children:"several issues"}),", including that some tools like Bandit allow you to write multiple formats (e.g. text vs. JSON), and Pants assumed a single format."]}),"\n",(0,s.jsxs)(t.p,{children:["Instead, now you directly tell Flake8 and Bandit to generate a report by setting their config files or setting ",(0,s.jsx)(t.code,{children:"[flake8].args"})," and ",(0,s.jsx)(t.code,{children:"[bandit].args"})," to write to the ",(0,s.jsx)(t.code,{children:"reports/"})," folder, e.g. setting ",(0,s.jsx)(t.code,{children:'[flake8].args = ["--output-filer=reports/foo.txt"]'}),". Pants will capture all reports and write them to ",(0,s.jsx)(t.code,{children:"dist/lint/<linter_name>"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["You can also now use ",(0,s.jsx)(t.a,{href:"https://mypy.readthedocs.io/en/stable/config_file.html#report-generation",children:"MyPy's report generation"}),", e.g. by setting ",(0,s.jsx)(t.code,{children:'linecount_report = "reports"'})," in ",(0,s.jsx)(t.code,{children:"mypy.ini"}),". Pants will capture all files under the ",(0,s.jsx)(t.code,{children:"reports/"})," folder and write them to ",(0,s.jsx)(t.code,{children:"dist/typecheck/mypy"}),"."]}),"\n",(0,s.jsx)(t.h2,{id:"other-changes",children:"Other changes"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Updated default versions for Black, Pylint, and Bandit."}),"\n",(0,s.jsxs)(t.li,{children:["New ",(0,s.jsx)(t.a,{href:"https://github.com/pantsbuild/pants/pull/12091",children:"plugin hook"})," for setting up Python tests, e.g. starting up databases before test runs."]}),"\n",(0,s.jsxs)(t.li,{children:["When there's an exception, we now suggest several other things you can try, like running with ",(0,s.jsx)(t.code,{children:"-ldebug"}),"."]}),"\n",(0,s.jsxs)(t.li,{children:["New ",(0,s.jsx)(t.code,{children:"--no-watch-filesystem"})," option, which allows you to run x86 Docker images from Apple Silicon machines."]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["See the full ",(0,s.jsx)(t.a,{href:"https://github.com/pantsbuild/pants/blob/release_2.6.0/src/python/pants/notes/2.6.x.md",children:"changelog"})," for more changes."]}),"\n",(0,s.jsx)(t.h3,{id:"upcoming-in-pants-27",children:(0,s.jsx)(t.strong,{children:"Upcoming in Pants 2.7"})}),"\n",(0,s.jsx)(t.p,{children:"We have been re-envisioning Pants's support for Python third-party dependencies to be more ergonomic, flexible, and safe. The changes include:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Autogenerating lockfiles."}),"\n",(0,s.jsx)(t.li,{children:"Adding dedicated lockfiles for each tool you run, e.g. Black and Flake8."}),"\n",(0,s.jsx)(t.li,{children:"Supporting multiple lockfiles for your repository."}),"\n",(0,s.jsxs)(t.li,{children:["Possibly using ",(0,s.jsx)(t.a,{href:"https://www.python.org/dev/peps/pep-0665/",children:"PEP 665"}),"'s new standardized lockfile format."]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"The full project may not be complete by Pants 2.7, given the recent developments around PEP 665. We are excited by the push for standardization in the Python ecosystem and eager to play our part in improving the build experience for Python developers. However, at a minimum, Pants 2.7 will have experimental lockfile support using the requirements.txt-style."}),"\n",(0,s.jsx)(t.p,{children:"Other upcoming improvements in Pants 2.7:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Support for the Yapf autoformatter."}),"\n",(0,s.jsx)(t.li,{children:"Support for the Hadolint Docker autoformatter."}),"\n",(0,s.jsxs)(t.li,{children:["A ",(0,s.jsx)(t.code,{children:"./pants peek"})," goal to inspect your targets' metadata."]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"--"}),"\n",(0,s.jsxs)(t.p,{children:["Try out our ",(0,s.jsx)(t.a,{href:"https://github.com/pantsbuild/example-python",children:"example repository"}),", and let us know what you think in ",(0,s.jsx)(t.a,{href:"https://www.pantsbuild.org/docs/getting-help",children:"Slack!"})]})]})}function c(e={}){let{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}},635814(e,t,n){n.d(t,{A:()=>r});let r=n.p+"assets/images/splash-5a9d379dc8559608f484f28cdcc0109d.jpg"},848193(e,t,n){n.d(t,{R:()=>o,x:()=>l});var r=n(830758);let s={},i=r.createContext(s);function o(e){let t=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),r.createElement(i.Provider,{value:t},e.children)}},231066(e){e.exports=JSON.parse('{"permalink":"/blog/2021/08/02/introducing-pants-2-6","editUrl":"https://github.com/pantsbuild/pantsbuild.org/edit/main/blog/2021-08-02-introducing-pants-2-6/index.mdx","source":"@site/blog/2021-08-02-introducing-pants-2-6/index.mdx","title":"Introducing Pants 2.6: Poetry support, third-party type stubs, and linter reports","description":"Photo by [Elisa Calvet","date":"2021-08-02T00:00:00.000Z","tags":[{"inline":true,"label":"announcement","permalink":"/blog/tags/announcement"},{"inline":true,"label":"python","permalink":"/blog/tags/python"}],"readingTime":3.95,"hasTruncateMarker":true,"authors":[{"name":"Eric Arellano","title":"Pants Maintainer","url":"https://github.com/Eric-Arellano","imageURL":"https://github.com/Eric-Arellano.png","key":"eric","page":null}],"frontMatter":{"authors":["eric"],"tags":["announcement","python"]},"unlisted":false,"prevItem":{"title":"Meet our newest Maintainer: Andreas Stenius","permalink":"/blog/2021/09/14/meet-our-newest-maintainer-andreas-stenius"},"nextItem":{"title":"Poetry support for Pants 2.6","permalink":"/blog/2021/07/29/poetry-support-for-pants-2-6"}}')}}]);